var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),a=(e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,c=(t,e)=>{for(var n in e||(e={}))s.call(e,n)&&a(t,n,e[n]);if(r)for(var n of r(e))o.call(e,n)&&a(t,n,e[n]);return t},u=(t,r)=>e(t,n(r)),l=(t,e)=>{var n={};for(var i in t)s.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&r)for(var i of r(t))e.indexOf(i)<0&&o.call(t,i)&&(n[i]=t[i]);return n},p=(t,e,n)=>new Promise(((r,s)=>{var o=t=>{try{a(n.next(t))}catch(e){s(e)}},i=t=>{try{a(n.throw(t))}catch(e){s(e)}},a=t=>t.done?r(t.value):Promise.resolve(t.value).then(o,i);a((n=n.apply(t,e)).next())})),d=function(t,e){this[0]=t,this[1]=e},f=(t,e,n)=>{var r=(t,e,s,o)=>{try{var i=n[t](e),a=(e=i.value)instanceof d,c=i.done;Promise.resolve(a?e[0]:e).then((n=>a?r("return"===t?t:"next",e[1]?{done:n.done,value:n.value}:n,s,o):s({value:n,done:c}))).catch((t=>r("throw",t,s,o)))}catch(u){o(u)}},s=t=>o[t]=e=>new Promise(((n,s)=>r(t,e,n,s))),o={};return n=n.apply(t,e),o[i("asyncIterator")]=()=>o,s("next"),s("throw"),s("return"),o},h=(t,e,n)=>(e=t[i("asyncIterator")])?e.call(t):(t=t[i("iterator")](),e={},(n=(n,r)=>(r=t[n])&&(e[n]=e=>new Promise(((n,s,o)=>(e=r.call(t,e),o=e.done,Promise.resolve(e.value).then((t=>n({value:t,done:o})),s))))))("next"),n("return"),e);const m="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||{};class g{constructor(t){if(this._entries=[],t)if("string"!=typeof t)Array.isArray(t)?t.forEach((([t,e])=>this.append(t,e))):Object.keys(t).forEach((e=>{const n=t[e];null!=n&&this.append(e,String(n))}));else{const e=t.startsWith("?")?t.slice(1):t;e.length>0&&e.split("&").forEach((t=>{if(!t)return;const[e,n=""]=t.split("=");this.append(decodeURIComponent(e),decodeURIComponent(n))}))}}append(t,e){this._entries.push([t,e])}toString(){return this._entries.map((([t,e])=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&")}}m.URLSearchParams||(m.URLSearchParams=g);const _="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,y=globalThis,v="10.27.0";function b(){return S(y),y}function S(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||v,e[v]=e[v]||{}}function k(t,e,n=y){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[v]=r[v]||{};return s[t]||(s[t]=e())}const x=["debug","info","warn","error","log","assert","trace"],T={};function w(t){if(!("console"in y))return t();const e=y.console,n={},r=Object.keys(T);r.forEach((t=>{const r=T[t];n[t]=e[t],e[t]=r}));try{return t()}finally{r.forEach((t=>{e[t]=n[t]}))}}function E(){return O().enabled}function I(t,...e){_&&E()&&w((()=>{y.console[t](`Sentry Logger [${t}]:`,...e)}))}function O(){return _?k("loggerSettings",(()=>({enabled:!1}))):{enabled:!1}}const C={enable:function(){O().enabled=!0},disable:function(){O().enabled=!1},isEnabled:E,log:function(...t){I("log",...t)},warn:function(...t){I("warn",...t)},error:function(...t){I("error",...t)}},A="<anonymous>";function $(t){try{return t&&"function"==typeof t&&t.name||A}catch(e){return A}}function j(t){return"__v_isVNode"in t&&t.__v_isVNode?"[VueVNode]":"[VueViewModel]"}const M={},P={};function R(t,e){M[t]=M[t]||[],M[t].push(e)}function N(t,e){if(!P[t]){P[t]=!0;try{e()}catch(n){_&&C.error(`Error while instrumenting ${t}`,n)}}}function D(t,e){const n=t&&M[t];if(n)for(const s of n)try{s(e)}catch(r){_&&C.error(`Error while triggering instrumentation handler.\nType: ${t}\nName: ${$(s)}\nError:`,r)}}let L=null;function F(){L=y.onerror,y.onerror=function(t,e,n,r,s){return D("error",{column:r,error:s,line:n,msg:t,url:e}),!!L&&L.apply(this,arguments)},y.onerror.__SENTRY_INSTRUMENTED__=!0}let U=null;function q(){U=y.onunhandledrejection,y.onunhandledrejection=function(t){return D("unhandledrejection",t),!U||U.apply(this,arguments)},y.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const B=Object.prototype.toString;function J(t){switch(B.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return X(t,Error)}}function H(t,e){return B.call(t)===`[object ${e}]`}function W(t){return H(t,"DOMError")}function z(t){return H(t,"String")}function G(t){return"object"==typeof t&&null!==t&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function K(t){return null===t||G(t)||"object"!=typeof t&&"function"!=typeof t}function V(t){return H(t,"Object")}function Y(t){return"undefined"!=typeof Event&&X(t,Event)}function Z(t){return Boolean((null==t?void 0:t.then)&&"function"==typeof t.then)}function X(t,e){try{return t instanceof e}catch(n){return!1}}function Q(t){return!("object"!=typeof t||null===t||!(t.__isVue||t._isVue||t.__v_isVNode))}const et=y;function nt(t,e){const n=t,r=[];if(!(null==n?void 0:n.tagName))return"";if(et.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=(null==e?void 0:e.length)?e.filter((t=>n.getAttribute(t))).map((t=>[t,n.getAttribute(t)])):null;if(null==s?void 0:s.length)s.forEach((t=>{r.push(`[${t[0]}="${t[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const t=n.className;if(t&&z(t)){const e=t.split(/\s+/);for(const t of e)r.push(`.${t}`)}}const o=["aria-label","type","name","title","alt"];for(const i of o){const t=n.getAttribute(i);t&&r.push(`[${i}="${t}"]`)}return r.join("")}function rt(t,e,n){if(!(e in t))return;const r=t[e];if("function"!=typeof r)return;const s=n(r);"function"==typeof s&&ot(s,r);try{t[e]=s}catch(o){_&&C.log(`Failed to replace method "${e}" in object`,t)}}function st(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch(r){_&&C.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function ot(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,st(t,"__sentry_original__",e)}catch(n){}}function it(t){return t.__sentry_original__}function at(t){if(J(t))return c({message:t.message,name:t.name,stack:t.stack},ut(t));if(Y(t)){const e=c({type:t.type,target:ct(t.target),currentTarget:ct(t.currentTarget)},ut(t));return"undefined"!=typeof CustomEvent&&X(t,CustomEvent)&&(e.detail=t.detail),e}return t}function ct(t){try{return e=t,"undefined"!=typeof Element&&X(e,Element)?function(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let o=0,i=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,p=!Array.isArray(e)&&e.maxStringLength||80;for(;n&&o++<r&&(u=nt(n,l),!("html"===u||o>1&&i+s.length*c+u.length>=p));)s.push(u),i+=u.length,n=n.parentNode;return s.reverse().join(a)}catch(n){return"<unknown>"}}(t):Object.prototype.toString.call(t)}catch(n){return"<unknown>"}var e}function ut(t){if("object"==typeof t&&null!==t){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return{}}function lt(t){const e=Object.keys(at(t));return e.sort(),e[0]?e.join(", "):"[object has no keys]"}function pt(t){return dt(t,/* @__PURE__ */new Map)}function dt(t,e){if(null===t||"object"!=typeof t)return t;const n=e.get(t);if(void 0!==n)return n;if(Array.isArray(t)){const n=[];return e.set(t,n),t.forEach((t=>{n.push(dt(t,e))})),n}if(function(t){const e=t.constructor;return e===Object||void 0===e}(t)){const n={};e.set(t,n);return Object.keys(t).forEach((r=>{const s=t[r];void 0!==s&&(n[r]=dt(s,e))})),n}return t}function ft(t,e=0){return"string"!=typeof t||0===e||t.length<=e?t:`${t.slice(0,e)}...`}function ht(t,e){if(!Array.isArray(t))return"";const n=[];for(let s=0;s<t.length;s++){const e=t[s];try{Q(e)?n.push(j(e)):n.push(String(e))}catch(r){n.push("[value cannot be serialized]")}}return n.join(e)}function mt(t,e,n=!1){return!!z(t)&&(H(e,"RegExp")?e.test(t):!!z(e)&&(n?t===e:t.includes(e)))}function gt(t,e=[],n=!1){return e.some((e=>mt(t,e,n)))}let _t;function yt(t=function(){const t=y;return t.crypto||t.msCrypto}()){try{if(null==t?void 0:t.randomUUID)return t.randomUUID().replace(/-/g,"")}catch(e){}return _t||(_t="10000000100040008000100000000000"),_t.replace(/[018]/g,(t=>(t^(16*Math.random()&15)>>t/4).toString(16)))}function vt(t){var e,n;return null==(n=null==(e=t.exception)?void 0:e.values)?void 0:n[0]}function bt(t){const{message:e,event_id:n}=t;if(e)return e;const r=vt(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function St(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],o=s[0]=s[0]||{};o.value||(o.value=e||""),o.type||(o.type="Error")}function kt(t,e){const n=vt(t);if(!n)return;const r=n.mechanism;if(n.mechanism=c(c(c({},{type:"generic",handled:!0}),r),e),e&&"data"in e){const t=c(c({},null==r?void 0:r.data),e.data);n.mechanism.data=t}}function xt(t){if(function(t){try{return t.__sentry_captured__}catch(e){}}(t))return!0;try{st(t,"__sentry_captured__",!0)}catch(e){}return!1}function Tt(){return Date.now()/1e3}let wt;function Et(){return(null!=wt?wt:wt=function(){const{performance:t}=y;if(!(null==t?void 0:t.now)||!t.timeOrigin)return Tt;const e=t.timeOrigin;return()=>(e+t.now())/1e3}())()}function It(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Et(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=32===e.sid.length?e.sid:yt()),void 0!==e.init&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),"number"==typeof e.started&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if("number"==typeof e.duration)t.duration=e.duration;else{const e=t.timestamp-t.started;t.duration=e>=0?e:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),"number"==typeof e.errors&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Ot(t,e,n=2){if(!e||"object"!=typeof e||n<=0)return e;if(t&&0===Object.keys(e).length)return t;const r=c({},t);for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Ot(r[s],e[s],n-1));return r}function Ct(){return yt()}function At(){return yt().substring(16)}const $t="_sentrySpan";function jt(t,e){e?st(t,$t,e):delete t[$t]}function Mt(t){return t[$t]}class Pt{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Ct(),sampleRand:Math.random()}}clone(){const t=new Pt;return t._breadcrumbs=[...this._breadcrumbs],t._tags=c({},this._tags),t._attributes=c({},this._attributes),t._extra=c({},this._extra),t._contexts=c({},this._contexts),this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata=c({},this._sdkProcessingMetadata),t._propagationContext=c({},this._propagationContext),t._client=this._client,t._lastEventId=this._lastEventId,jt(t,Mt(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&It(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags=c(c({},this._tags),t),this._notifyScopeListeners(),this}setTag(t,e){return this.setTags({[t]:e})}setAttributes(t){return this._attributes=c(c({},this._attributes),t),this._notifyScopeListeners(),this}setAttribute(t,e){return this.setAttributes({[t]:e})}removeAttribute(t){return t in this._attributes&&(delete this._attributes[t],this._notifyScopeListeners()),this}setExtras(t){return this._extra=c(c({},this._extra),t),this._notifyScopeListeners(),this}setExtra(t,e){return this._extra=u(c({},this._extra),{[t]:e}),this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return null===e?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const e="function"==typeof t?t(this):t,n=e instanceof Pt?e.getScopeData():V(e)?t:void 0,{tags:r,attributes:s,extra:o,user:i,contexts:a,level:u,fingerprint:l=[],propagationContext:p}=n||{};return this._tags=c(c({},this._tags),r),this._attributes=c(c({},this._attributes),s),this._extra=c(c({},this._extra),o),this._contexts=c(c({},this._contexts),a),i&&Object.keys(i).length&&(this._user=i),u&&(this._level=u),l.length&&(this._fingerprint=l),p&&(this._propagationContext=p),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,jt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Ct(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,e){var n;const r="number"==typeof e?e:100;if(r<=0)return this;const s=u(c({timestamp:Tt()},t),{message:t.message?ft(t.message,2048):t.message});return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),null==(n=this._client)||n.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Mt(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=Ot(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,e){const n=(null==e?void 0:e.event_id)||yt();if(!this._client)return _&&C.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(t,u(c({originalException:t,syntheticException:r},e),{event_id:n}),this),n}captureMessage(t,e,n){var r;const s=(null==n?void 0:n.event_id)||yt();if(!this._client)return _&&C.warn("No client configured on scope - will not capture message!"),s;const o=null!=(r=null==n?void 0:n.syntheticException)?r:new Error(t);return this._client.captureMessage(t,e,u(c({originalException:t,syntheticException:o},n),{event_id:s}),this),s}captureEvent(t,e){const n=(null==e?void 0:e.event_id)||yt();return this._client?(this._client.captureEvent(t,u(c({},e),{event_id:n}),this),n):(_&&C.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((t=>{t(this)})),this._notifyingListeners=!1)}}class Rt{constructor(t,e){let n,r;n=t||new Pt,r=e||new Pt,this._stack=[{scope:n}],this._isolationScope=r}withScope(t){const e=this._pushScope();let n;try{n=t(e)}catch(r){throw this._popScope(),r}return Z(n)?n.then((t=>(this._popScope(),t)),(t=>{throw this._popScope(),t})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Nt(){const t=S(b());return t.stack=t.stack||new Rt(k("defaultCurrentScope",(()=>new Pt)),k("defaultIsolationScope",(()=>new Pt)))}function Dt(t){return Nt().withScope(t)}function Lt(t,e){const n=Nt();return n.withScope((()=>(n.getStackTop().scope=t,e(t))))}function Ft(t){return Nt().withScope((()=>t(Nt().getIsolationScope())))}function Ut(t){const e=S(t);return e.acs?e.acs:{withIsolationScope:Ft,withScope:Dt,withSetScope:Lt,withSetIsolationScope:(t,e)=>Ft(e),getCurrentScope:()=>Nt().getScope(),getIsolationScope:()=>Nt().getIsolationScope()}}function qt(){return Ut(b()).getCurrentScope()}function Bt(){return Ut(b()).getIsolationScope()}function Jt(){return k("globalScope",(()=>new Pt))}function Ht(...t){const e=Ut(b());if(2===t.length){const[n,r]=t;return n?e.withSetScope(n,r):e.withScope(r)}return e.withScope(t[0])}function Wt(){return qt().getClient()}function zt(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,o={trace_id:n,span_id:s||At()};return r&&(o.parent_span_id=r),o}const Gt="sentry.source",Kt="sentry.sample_rate",Vt="sentry.op",Yt="sentry.origin",Zt="sentry.measurement_unit",Xt="sentry.measurement_value",Qt="sentry.custom_span_name",te="sentry.profile_id",ee="sentry.exclusive_time";function ne(t){if(t<400&&t>=100)return{code:1};if(t>=400&&t<500)switch(t){case 401:return{code:2,message:"unauthenticated"};case 403:return{code:2,message:"permission_denied"};case 404:return{code:2,message:"not_found"};case 409:return{code:2,message:"already_exists"};case 413:return{code:2,message:"failed_precondition"};case 429:return{code:2,message:"resource_exhausted"};case 499:return{code:2,message:"cancelled"};default:return{code:2,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:2,message:"unimplemented"};case 503:return{code:2,message:"unavailable"};case 504:return{code:2,message:"deadline_exceeded"};default:return{code:2,message:"internal_error"}}return{code:2,message:"internal_error"}}function re(t,e){t.setAttribute("http.response.status_code",e);const n=ne(e);"unknown_error"!==n.message&&t.setStatus(n)}const se="_sentryScope",oe="_sentryIsolationScope";function ie(t){if(t){if("object"==typeof t&&"deref"in t&&"function"==typeof t.deref)try{return t.deref()}catch(e){return}return t}}function ae(t,e,n){t&&(st(t,oe,function(t){try{const e=y.WeakRef;if("function"==typeof e)return new e(t)}catch(e){}return t}(n)),st(t,se,e))}function ce(t){const e=t;return{scope:e[se],isolationScope:ie(e[oe])}}const ue=/^sentry-/;function le(t){const e=function(t){if(!t||!z(t)&&!Array.isArray(t))return;if(Array.isArray(t))return t.reduce(((t,e)=>{const n=pe(e);return Object.entries(n).forEach((([e,n])=>{t[e]=n})),t}),{});return pe(t)}(t);if(!e)return;const n=Object.entries(e).reduce(((t,[e,n])=>{if(e.match(ue)){t[e.slice(7)]=n}return t}),{});return Object.keys(n).length>0?n:void 0}function pe(t){return t.split(",").map((t=>{const e=t.indexOf("=");if(-1===e)return[];return[t.slice(0,e),t.slice(e+1)].map((t=>{try{return decodeURIComponent(t.trim())}catch(e){return}}))})).reduce(((t,[e,n])=>(e&&n&&(t[e]=n),t)),{})}const de=/^o(\d+)\./,fe=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function he(t,e=!1){const{host:n,path:r,pass:s,port:o,projectId:i,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${o?`:${o}`:""}/${r?`${r}/`:r}${i}`}function me(t){const e=fe.exec(t);if(!e)return void w((()=>{console.error(`Invalid Sentry Dsn: ${t}`)}));const[n,r,s="",o="",i="",a=""]=e.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const t=u.match(/^\d+/);t&&(u=t[0])}return ge({host:o,pass:s,path:c,projectId:u,port:i,protocol:n,publicKey:r})}function ge(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function _e(t){const e=t.getOptions(),{host:n}=t.getDsn()||{};let r;return e.orgId?r=String(e.orgId):n&&(r=function(t){const e=t.match(de);return null==e?void 0:e[1]}(n)),r}function ye(t){const e="string"==typeof t?me(t):ge(t);if(e&&function(t){if(!_)return!0;const{port:e,projectId:n,protocol:r}=t;return!(["protocol","publicKey","host","projectId"].find((e=>!t[e]&&(C.error(`Invalid Sentry Dsn: ${e} missing`),!0)))||(n.match(/^\d+$/)?function(t){return"http"===t||"https"===t}(r)?e&&isNaN(parseInt(e,10))&&(C.error(`Invalid Sentry Dsn: Invalid port ${e}`),1):(C.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(C.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(e))return e}function ve(t){if("boolean"==typeof t)return Number(t);const e="string"==typeof t?parseFloat(t):t;return"number"!=typeof e||isNaN(e)||e<0||e>1?void 0:e}let be=!1;function Se(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:o,status:i,origin:a,links:c}=Ee(t);return{parent_span_id:o,span_id:e,trace_id:n,data:r,op:s,status:i,origin:a,links:c}}function ke(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:Ee(t).parent_span_id,o=ce(t).scope;return{parent_span_id:s,span_id:r?(null==o?void 0:o.getPropagationContext().propagationSpanId)||At():e,trace_id:n}}function xe(t){return t&&t.length>0?t.map((t=>{var e=t,{context:n}=e,r=n,{spanId:s,traceId:o,traceFlags:i}=r,a=l(r,["spanId","traceId","traceFlags"]),{attributes:u}=e;return c({span_id:s,trace_id:o,sampled:1===i,attributes:u},a)})):void 0}function Te(t){return"number"==typeof t?we(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?we(t.getTime()):Et()}function we(t){return t>9999999999?t/1e3:t}function Ee(t){var e;if(function(t){return"function"==typeof t.getSpanJSON}(t))return t.getSpanJSON();const{spanId:n,traceId:r}=t.spanContext();if(function(t){const e=t;return!!(e.attributes&&e.startTime&&e.name&&e.endTime&&e.status)}(t)){const{attributes:s,startTime:o,name:i,endTime:a,status:c,links:u}=t;return{span_id:n,trace_id:r,data:s,description:i,parent_span_id:"parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?null==(e=t.parentSpanContext)?void 0:e.spanId:void 0,start_timestamp:Te(o),timestamp:Te(a)||void 0,status:Oe(c),op:s[Vt],origin:s[Yt],links:xe(u)}}return{span_id:n,trace_id:r,start_timestamp:0,data:{}}}function Ie(t){const{traceFlags:e}=t.spanContext();return 1===e}function Oe(t){if(t&&0!==t.code)return 1===t.code?"ok":t.message||"internal_error"}const Ce="_sentryChildSpans",Ae="_sentryRootSpan";function $e(t,e){const n=t[Ae]||t;st(e,Ae,n),t[Ce]?t[Ce].add(e):st(t,Ce,/* @__PURE__ */new Set([e]))}function je(t){const e=/* @__PURE__ */new Set;return function t(n){if(!e.has(n)&&Ie(n)){e.add(n);const r=n[Ce]?Array.from(n[Ce]):[];for(const e of r)t(e)}}(t),Array.from(e)}function Me(t){return t[Ae]||t}function Pe(){const t=Ut(b());return t.getActiveSpan?t.getActiveSpan():Mt(qt())}function Re(){be||(w((()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")})),be=!0)}let Ne=!1;function De(){function t(){const t=Pe(),e=t&&Me(t);if(e){const t="internal_error";_&&C.log(`[Tracing] Root span: ${t} -> Global error occurred`),e.setStatus({code:2,message:t})}}Ne||(t.tag="sentry_tracingErrorCallback",Ne=!0,function(t){const e="error";R(e,t),N(e,F)}(t),function(t){const e="unhandledrejection";R(e,t),N(e,q)}(t))}function Le(t){var e;if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const n=t||(null==(e=Wt())?void 0:e.getOptions());return!(!n||null==n.tracesSampleRate&&!n.tracesSampler)}function Fe(t){C.log(`Ignoring span ${t.op} - ${t.description} because it matches \`ignoreSpans\`.`)}function Ue(t,e){if(!(null==e?void 0:e.length)||!t.description)return!1;for(const r of e){if("string"==typeof(n=r)||n instanceof RegExp){if(mt(t.description,r))return _&&Fe(t),!0;continue}if(!r.name&&!r.op)continue;const e=!r.name||mt(t.description,r.name),s=!r.op||t.op&&mt(t.op,r.op);if(e&&s)return _&&Fe(t),!0}var n;return!1}function qe(t,e){const n=e.parent_span_id,r=e.span_id;if(n)for(const s of t)s.parent_span_id===r&&(s.parent_span_id=n)}const Be="production",Je="_frozenDsc";function He(t,e){st(t,Je,e)}function We(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},s={environment:n.environment||Be,release:n.release,public_key:r,trace_id:t,org_id:_e(e)};return e.emit("createDsc",s),s}function ze(t,e){const n=e.getPropagationContext();return n.dsc||We(n.traceId,t)}function Ge(t){var e,n,r,s;const o=Wt();if(!o)return{};const i=Me(t),a=Ee(i),c=a.data,u=i.spanContext().traceState,l=null!=(n=null!=(e=null==u?void 0:u.get("sentry.sample_rate"))?e:c[Kt])?n:c["sentry.previous_trace_sample_rate"];function p(t){return"number"!=typeof l&&"string"!=typeof l||(t.sample_rate=`${l}`),t}const d=i[Je];if(d)return p(d);const f=null==u?void 0:u.get("sentry.dsc"),h=f&&le(f);if(h)return p(h);const m=We(t.spanContext().traceId,o),g=c[Gt],_=a.description;return"url"!==g&&_&&(m.transaction=_),Le()&&(m.sampled=String(Ie(i)),m.sample_rand=null!=(s=null==u?void 0:u.get("sentry.sample_rand"))?s:null==(r=ce(i).scope)?void 0:r.getPropagationContext().sampleRand.toString()),p(m),o.emit("createDsc",m,i),m}class Ke{constructor(t={}){this._traceId=t.traceId||Ct(),this._spanId=t.spanId||At()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:0}}end(t){}setAttribute(t,e){return this}setAttributes(t){return this}setStatus(t){return this}updateName(t){return this}isRecording(){return!1}addEvent(t,e,n){return this}addLink(t){return this}addLinks(t){return this}recordException(t,e){}}function Ve(t,e=100,n=1/0){try{return Ze("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Ye(t,e=3,n=102400){const r=Ve(t,e);return s=r,function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(s))>n?Ye(t,e-1,n):r;var s}function Ze(t,e,n=1/0,r=1/0,s=function(){const t=/* @__PURE__ */new WeakSet;function e(e){return!!t.has(e)||(t.add(e),!1)}function n(e){t.delete(e)}return[e,n]}()){const[o,i]=s;if(null==e||["boolean","string"].includes(typeof e)||"number"==typeof e&&Number.isFinite(e))return e;const a=function(t,e){try{if("domain"===t&&e&&"object"==typeof e&&e._events)return"[Domain]";if("domainEmitter"===t)return"[DomainEmitter]";if("undefined"!=typeof global&&e===global)return"[Global]";if("undefined"!=typeof window&&e===window)return"[Window]";if("undefined"!=typeof document&&e===document)return"[Document]";if(Q(e))return j(e);if(V(n=e)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof e&&!Number.isFinite(e))return`[${e}]`;if("function"==typeof e)return`[Function: ${$(e)}]`;if("symbol"==typeof e)return`[${String(e)}]`;if("bigint"==typeof e)return`[BigInt: ${String(e)}]`;const r=function(t){const e=Object.getPrototypeOf(t);return(null==e?void 0:e.constructor)?e.constructor.name:"null prototype"}(e);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(r){return`**non-serializable** (${r})`}var n}(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c="number"==typeof e.__sentry_override_normalization_depth__?e.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(o(e))return"[Circular ~]";const u=e;if(u&&"function"==typeof u.toJSON)try{return Ze("",u.toJSON(),c-1,r,s)}catch(f){}const l=Array.isArray(e)?[]:{};let p=0;const d=at(e);for(const h in d){if(!Object.prototype.hasOwnProperty.call(d,h))continue;if(p>=r){l[h]="[MaxProperties ~]";break}const t=d[h];l[h]=Ze(h,t,c-1,r,s),p++}return i(e),l}function Xe(t,e=[]){return[t,e]}function Qe(t,e){const[n,r]=t;return[n,[...r,e]]}function tn(t,e){const n=t[1];for(const r of n){if(e(r,r[0].type))return!0}return!1}function en(t){const e=S(y);return e.encodePolyfill?e.encodePolyfill(t):(new TextEncoder).encode(t)}function nn(t){const[e,n]=t;let r=JSON.stringify(e);function s(t){"string"==typeof r?r="string"==typeof t?r+t:[en(r),t]:r.push("string"==typeof t?en(t):t)}for(const i of n){const[t,e]=i;if(s(`\n${JSON.stringify(t)}\n`),"string"==typeof e||e instanceof Uint8Array)s(e);else{let t;try{t=JSON.stringify(e)}catch(o){t=JSON.stringify(Ve(e))}s(t)}}return"string"==typeof r?r:function(t){const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}(r)}function rn(t){return[{type:"span"},t]}function sn(t){const e="string"==typeof t.data?en(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const on={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function an(t){return on[t]}function cn(t){if(!(null==t?void 0:t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function un(t,e,n,r){const s=cn(n),o=t.type&&"replay_event"!==t.type?t.type:"event";!function(t,e){var n,r,s,o;if(!e)return t;const i=t.sdk||{};t.sdk=u(c({},i),{name:i.name||e.name,version:i.version||e.version,integrations:[...(null==(n=t.sdk)?void 0:n.integrations)||[],...e.integrations||[]],packages:[...(null==(r=t.sdk)?void 0:r.packages)||[],...e.packages||[]],settings:(null==(s=t.sdk)?void 0:s.settings)||e.settings?c(c({},null==(o=t.sdk)?void 0:o.settings),e.settings):void 0})}(t,null==n?void 0:n.sdk);const i=function(t,e,n,r){var s;const o=null==(s=t.sdkProcessingMetadata)?void 0:s.dynamicSamplingContext;return c(c(c({event_id:t.event_id,sent_at:/* @__PURE__ */(new Date).toISOString()},e&&{sdk:e}),!!n&&r&&{dsn:he(r)}),o&&{trace:o})}(t,s,r,e);delete t.sdkProcessingMetadata;return Xe(i,[[{type:o},t]])}function ln(t,e,n,r=Pe()){const s=r&&Me(r);s&&(_&&C.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[Xt]:e,[Zt]:n}))}function pn(t){if(!t||0===t.length)return;const e={};return t.forEach((t=>{const n=t.attributes||{},r=n[Zt],s=n[Xt];"string"==typeof r&&"number"==typeof s&&(e[t.name]={value:s,unit:r})})),e}class dn{constructor(t={}){this._traceId=t.traceId||Ct(),this._spanId=t.spanId||At(),this._startTime=t.startTimestamp||Et(),this._links=t.links,this._attributes={},this.setAttributes(c({[Yt]:"manual",[Vt]:t.op},t.attributes)),this._name=t.name,t.parentSpanId&&(this._parentSpanId=t.parentSpanId),"sampled"in t&&(this._sampled=t.sampled),t.endTimestamp&&(this._endTime=t.endTimestamp),this._events=[],this._isStandaloneSpan=t.isStandalone,this._endTime&&this._onSpanEnded()}addLink(t){return this._links?this._links.push(t):this._links=[t],this}addLinks(t){return this._links?this._links.push(...t):this._links=t,this}recordException(t,e){}spanContext(){const{_spanId:t,_traceId:e,_sampled:n}=this;return{spanId:t,traceId:e,traceFlags:n?1:0}}setAttribute(t,e){return void 0===e?delete this._attributes[t]:this._attributes[t]=e,this}setAttributes(t){return Object.keys(t).forEach((e=>this.setAttribute(e,t[e]))),this}updateStartTime(t){this._startTime=Te(t)}setStatus(t){return this._status=t,this}updateName(t){return this._name=t,this.setAttribute(Gt,"custom"),this}end(t){this._endTime||(this._endTime=Te(t),function(t){if(!_)return;const{description:e="< unknown name >",op:n="< unknown op >"}=Ee(t),{spanId:r}=t.spanContext(),s=`[Tracing] Finishing "${n}" ${Me(t)===t?"root ":""}span "${e}" with ID ${r}`;C.log(s)}(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Vt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Oe(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Yt],profile_id:this._attributes[te],exclusive_time:this._attributes[ee],measurements:pn(this._events),is_segment:this._isStandaloneSpan&&Me(this)===this||void 0,segment_id:this._isStandaloneSpan?Me(this).spanContext().spanId:void 0,links:xe(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(t,e,n){_&&C.log("[Tracing] Adding an event to span:",t);const r=fn(e)?e:n||Et(),s=fn(e)?{}:e||{},o={name:t,time:Te(r),attributes:s};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const t=Wt();t&&t.emit("spanEnd",this);if(!(this._isStandaloneSpan||this===Me(this)))return;if(this._isStandaloneSpan)return void(this._sampled?function(t){const e=Wt();if(!e)return;const n=t[1];if(!n||0===n.length)return void e.recordDroppedEvent("before_send","span");e.sendEnvelope(t)}(function(t,e){const n=Ge(t[0]),r=null==e?void 0:e.getDsn(),s=null==e?void 0:e.getOptions().tunnel,o=c(c({sent_at:/* @__PURE__ */(new Date).toISOString()},!!(i=n).trace_id&&!!i.public_key&&{trace:n}),!!s&&r&&{dsn:he(r)});var i;const{beforeSendSpan:a,ignoreSpans:u}=(null==e?void 0:e.getOptions())||{},l=(null==u?void 0:u.length)?t.filter((t=>!Ue(Ee(t),u))):t,p=t.length-l.length;p&&(null==e||e.recordDroppedEvent("before_send","span",p));const d=a?t=>{const e=Ee(t);return a(e)||(Re(),e)}:Ee,f=[];for(const c of l){const t=d(c);t&&f.push(rn(t))}return Xe(o,f)}([this],t)):(_&&C.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),t&&t.recordDroppedEvent("sample_rate","span")));const e=this._convertSpanToTransaction();if(e){(ce(this).scope||qt()).captureEvent(e)}}_convertSpanToTransaction(){var t;if(!hn(Ee(this)))return;this._name||(_&&C.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=ce(this),r=null==(t=null==e?void 0:e.getScopeData().sdkProcessingMetadata)?void 0:t.normalizedRequest;if(!0!==this._sampled)return;const s=je(this).filter((t=>t!==this&&!function(t){return t instanceof dn&&t.isStandaloneSpan()}(t))).map((t=>Ee(t))).filter(hn),o=this._attributes[Gt];delete this._attributes[Qt],s.forEach((t=>{delete t.data[Qt]}));const i=c({contexts:{trace:Se(this)},spans:s.length>1e3?s.sort(((t,e)=>t.start_timestamp-e.start_timestamp)).slice(0,1e3):s,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:Ge(this)},request:r},o&&{transaction_info:{source:o}}),a=pn(this._events);return a&&Object.keys(a).length&&(_&&C.log("[Measurements] Adding measurements to transaction event",JSON.stringify(a,void 0,2)),i.measurements=a),i}}function fn(t){return t&&"number"==typeof t||t instanceof Date||Array.isArray(t)}function hn(t){return!!(t.start_timestamp&&t.timestamp&&t.span_id&&t.trace_id)}function mn(t,e,n=()=>{},r=()=>{}){let s;try{s=t()}catch(o){throw e(o),n(),o}return function(t,e,n,r){if(Z(t))return t.then((t=>(n(),r(t),t)),(t=>{throw e(t),n(),t}));return n(),r(t),t}(s,e,n,r)}function gn(t,e,n){if(!Le(t))return[!1];let r,s;"function"==typeof t.tracesSampler?(s=t.tracesSampler(u(c({},e),{inheritOrSampleWith:t=>"number"==typeof e.parentSampleRate?e.parentSampleRate:"boolean"==typeof e.parentSampled?Number(e.parentSampled):t})),r=!0):void 0!==e.parentSampled?s=e.parentSampled:void 0!==t.tracesSampleRate&&(s=t.tracesSampleRate,r=!0);const o=ve(s);if(void 0===o)return _&&C.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!o)return _&&C.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),[!1,o,r];const i=n<o;return i||_&&C.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[i,o,r]}const _n="__SENTRY_SUPPRESS_TRACING__";function yn(t,e){const n=wn();if(n.startSpan)return n.startSpan(t,e);const r=Tn(t),{forceTransaction:s,parentSpan:o,scope:i}=t;return Ht(null==i?void 0:i.clone(),(()=>On(o)((()=>{const n=qt(),i=In(n,o),a=t.onlyIfParent&&!i?new Ke:xn({parentSpan:i,spanArguments:r,forceTransaction:s,scope:n});return jt(n,a),mn((()=>e(a)),(()=>{const{status:t}=Ee(a);!a.isRecording()||t&&"ok"!==t||a.setStatus({code:2,message:"internal_error"})}),(()=>{a.end()}))}))))}function vn(t,e){const n=wn();if(n.startSpanManual)return n.startSpanManual(t,e);const r=Tn(t),{forceTransaction:s,parentSpan:o,scope:i}=t;return Ht(null==i?void 0:i.clone(),(()=>On(o)((()=>{const n=qt(),i=In(n,o),a=t.onlyIfParent&&!i?new Ke:xn({parentSpan:i,spanArguments:r,forceTransaction:s,scope:n});return jt(n,a),mn((()=>e(a,(()=>a.end()))),(()=>{const{status:t}=Ee(a);!a.isRecording()||t&&"ok"!==t||a.setStatus({code:2,message:"internal_error"})}))}))))}function bn(t){const e=wn();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=Tn(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?e=>Ht(t.scope,e):void 0!==s?t=>Sn(s,t):t=>t())((()=>{const e=qt(),o=In(e,s);return t.onlyIfParent&&!o?new Ke:xn({parentSpan:o,spanArguments:n,forceTransaction:r,scope:e})}))}function Sn(t,e){const n=wn();return n.withActiveSpan?n.withActiveSpan(t,e):Ht((n=>(jt(n,t||void 0),e(n))))}function kn(t){return Ht((e=>(e.setPropagationContext({traceId:Ct(),sampleRand:Math.random()}),_&&C.log(`Starting a new trace with id ${e.getPropagationContext().traceId}`),Sn(null,t))))}function xn({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Le()){const r=new Ke;if(n||!t){He(r,c({sampled:"false",sample_rate:"0",transaction:e.name},Ge(r)))}return r}const s=Bt();let o;if(t&&!n)o=function(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),o=!e.getScopeData().sdkProcessingMetadata[_n]&&Ie(t),i=o?new dn(u(c({},n),{parentSpanId:r,traceId:s,sampled:o})):new Ke({traceId:s});$e(t,i);const a=Wt();a&&(a.emit("spanStart",i),n.endTimestamp&&a.emit("spanEnd",i));return i}(t,r,e),$e(t,o);else if(t){const n=Ge(t),{traceId:s,spanId:i}=t.spanContext(),a=Ie(t);o=En(c({traceId:s,parentSpanId:i},e),r,a),He(o,n)}else{const{traceId:t,dsc:n,parentSpanId:i,sampled:a}=c(c({},s.getPropagationContext()),r.getPropagationContext());o=En(c({traceId:t,parentSpanId:i},e),r,a),n&&He(o,n)}return function(t){if(!_)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=Ee(t),{spanId:s}=t.spanContext(),o=Ie(t),i=Me(t),a=i===t,c=`[Tracing] Starting ${o?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:t,description:e}=Ee(i);u.push(`root ID: ${i.spanContext().spanId}`),t&&u.push(`root op: ${t}`),e&&u.push(`root description: ${e}`)}C.log(`${c}\n  ${u.join("\n  ")}`)}(o),ae(o,r,s),o}function Tn(t){const e=t.experimental||{},n=c({isStandalone:e.standalone},t);if(t.startTime){const e=c({},n);return e.startTimestamp=Te(t.startTime),delete e.startTime,e}return n}function wn(){return Ut(b())}function En(t,e,n){var r,s;const o=Wt(),i=(null==o?void 0:o.getOptions())||{},{name:a=""}=t,l={spanAttributes:c({},t.attributes),spanName:a,parentSampled:n};null==o||o.emit("beforeSampling",l,{decision:!1});const p=null!=(r=l.parentSampled)?r:n,d=l.spanAttributes,f=e.getPropagationContext(),[h,m,g]=e.getScopeData().sdkProcessingMetadata[_n]?[!1]:gn(i,{name:a,parentSampled:p,attributes:d,parentSampleRate:ve(null==(s=f.dsc)?void 0:s.sample_rate)},f.sampleRand),y=new dn(u(c({},t),{attributes:c({[Gt]:"custom",[Kt]:void 0!==m&&g?m:void 0},d),sampled:h}));return!h&&o&&(_&&C.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),o.recordDroppedEvent("sample_rate","transaction")),o&&o.emit("spanStart",y),y}function In(t,e){if(e)return e;if(null===e)return;const n=Mt(t);if(!n)return;const r=Wt();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?Me(n):n}function On(t){return void 0!==t?e=>Sn(t,e):t=>t()}function Cn(t){return new $n((e=>{e(t)}))}function An(t){return new $n(((e,n)=>{n(t)}))}class $n{constructor(t){this._state=0,this._handlers=[],this._runExecutor(t)}then(t,e){return new $n(((n,r)=>{this._handlers.push([!1,e=>{if(t)try{n(t(e))}catch(s){r(s)}else n(e)},t=>{if(e)try{n(e(t))}catch(s){r(s)}else r(t)}]),this._executeHandlers()}))}catch(t){return this.then((t=>t),t)}finally(t){return new $n(((e,n)=>{let r,s;return this.then((e=>{s=!1,r=e,t&&t()}),(e=>{s=!0,r=e,t&&t()})).then((()=>{s?n(r):e(r)}))}))}_executeHandlers(){if(0===this._state)return;const t=this._handlers.slice();this._handlers=[],t.forEach((t=>{t[0]||(1===this._state&&t[1](this._value),2===this._state&&t[2](this._value),t[0]=!0)}))}_runExecutor(t){const e=(t,e)=>{0===this._state&&(Z(e)?e.then(n,r):(this._state=t,this._value=e,this._executeHandlers()))},n=t=>{e(1,t)},r=t=>{e(2,t)};try{t(n,r)}catch(s){r(s)}}}function jn(t,e,n,r=0){try{const s=Mn(e,n,t,r);return Z(s)?s:Cn(s)}catch(s){return An(s)}}function Mn(t,e,n,r){const s=n[r];if(!t||!s)return t;const o=s(c({},t),e);return _&&null===o&&C.log(`Event processor "${s.id||"?"}" dropped event`),Z(o)?o.then((t=>Mn(t,e,n,r+1))):Mn(o,e,n,r+1)}function Pn(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:o}=e;!function(t,e){const{extra:n,tags:r,user:s,contexts:o,level:i,transactionName:a}=e;Object.keys(n).length&&(t.extra=c(c({},n),t.extra));Object.keys(r).length&&(t.tags=c(c({},r),t.tags));Object.keys(s).length&&(t.user=c(c({},s),t.user));Object.keys(o).length&&(t.contexts=c(c({},o),t.contexts));i&&(t.level=i);a&&"transaction"!==t.type&&(t.transaction=a)}(t,e),r&&function(t,e){t.contexts=c({trace:ke(e)},t.contexts),t.sdkProcessingMetadata=c({dynamicSamplingContext:Ge(e)},t.sdkProcessingMetadata);const n=Me(e),r=Ee(n).description;r&&!t.transaction&&"transaction"===t.type&&(t.transaction=r)}(t,r),function(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e));t.fingerprint.length||delete t.fingerprint}(t,n),function(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}(t,s),function(t,e){t.sdkProcessingMetadata=c(c({},t.sdkProcessingMetadata),e)}(t,o)}function Rn(t,e){const{extra:n,tags:r,user:s,contexts:o,level:i,sdkProcessingMetadata:a,breadcrumbs:u,fingerprint:l,eventProcessors:p,attachments:d,propagationContext:f,transactionName:h,span:m}=e;Nn(t,"extra",n),Nn(t,"tags",r),Nn(t,"user",s),Nn(t,"contexts",o),t.sdkProcessingMetadata=Ot(t.sdkProcessingMetadata,a,2),i&&(t.level=i),h&&(t.transactionName=h),m&&(t.span=m),u.length&&(t.breadcrumbs=[...t.breadcrumbs,...u]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),p.length&&(t.eventProcessors=[...t.eventProcessors,...p]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext=c(c({},t.propagationContext),f)}function Nn(t,e,n){t[e]=Ot(t[e],n,1)}let Dn,Ln,Fn,Un;function qn(t,e,n,r,s,o){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=t,l=u(c({},e),{event_id:e.event_id||n.event_id||yt(),timestamp:e.timestamp||Tt()}),p=n.integrations||t.integrations.map((t=>t.name));!function(t,e){var n,r;const{environment:s,release:o,dist:i,maxValueLength:a}=e;t.environment=t.environment||s||Be,!t.release&&o&&(t.release=o);!t.dist&&i&&(t.dist=i);const c=t.request;(null==c?void 0:c.url)&&a&&(c.url=ft(c.url,a));a&&(null==(r=null==(n=t.exception)?void 0:n.values)||r.forEach((t=>{t.value&&(t.value=ft(t.value,a))})))}(l,t),function(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}(l,p),s&&s.emit("applyFrameMetadata",e),void 0===e.type&&function(t,e){var n,r;const s=function(t){const e=y._sentryDebugIds,n=y._debugIds;if(!e&&!n)return{};const r=e?Object.keys(e):[],s=n?Object.keys(n):[];if(Un&&r.length===Ln&&s.length===Fn)return Un;Ln=r.length,Fn=s.length,Un={},Dn||(Dn={});const o=(e,n)=>{for(const r of e){const e=n[r],s=null==Dn?void 0:Dn[r];if(s&&Un&&e)Un[s[0]]=e,Dn&&(Dn[r]=[s[0],e]);else if(e){const n=t(r);for(let t=n.length-1;t>=0;t--){const s=n[t],o=null==s?void 0:s.filename;if(o&&Un&&Dn){Un[o]=e,Dn[r]=[o,e];break}}}}};return e&&o(r,e),n&&o(s,n),Un}(e);null==(r=null==(n=t.exception)?void 0:n.values)||r.forEach((t=>{var e,n;null==(n=null==(e=t.stacktrace)?void 0:e.frames)||n.forEach((t=>{t.filename&&(t.debug_id=s[t.filename])}))}))}(l,t.stackParser);const d=function(t,e){if(!e)return t;const n=t?t.clone():new Pt;return n.update(e),n}(r,n.captureContext);n.mechanism&&kt(l,n.mechanism);const f=s?s.getEventProcessors():[],h=Jt().getScopeData();if(o){Rn(h,o.getScopeData())}if(d){Rn(h,d.getScopeData())}const m=[...n.attachments||[],...h.attachments];m.length&&(n.attachments=m),Pn(l,h);return jn([...f,...h.eventProcessors],l,n).then((t=>(t&&function(t){var e,n;const r={};if(null==(n=null==(e=t.exception)?void 0:e.values)||n.forEach((t=>{var e,n;null==(n=null==(e=t.stacktrace)?void 0:e.frames)||n.forEach((t=>{t.debug_id&&(t.abs_path?r[t.abs_path]=t.debug_id:t.filename&&(r[t.filename]=t.debug_id),delete t.debug_id)}))})),0===Object.keys(r).length)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const s=t.debug_meta.images;Object.entries(r).forEach((([t,e])=>{s.push({type:"sourcemap",code_file:t,debug_id:e})}))}(t),"number"==typeof i&&i>0?function(t,e,n){var r,s;if(!t)return null;const o=c(c(c(c(c({},t),t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map((t=>c(c({},t),t.data&&{data:Ve(t.data,e,n)})))}),t.user&&{user:Ve(t.user,e,n)}),t.contexts&&{contexts:Ve(t.contexts,e,n)}),t.extra&&{extra:Ve(t.extra,e,n)});(null==(r=t.contexts)?void 0:r.trace)&&o.contexts&&(o.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(o.contexts.trace.data=Ve(t.contexts.trace.data,e,n)));t.spans&&(o.spans=t.spans.map((t=>c(c({},t),t.data&&{data:Ve(t.data,e,n)}))));(null==(s=t.contexts)?void 0:s.flags)&&o.contexts&&(o.contexts.flags=Ve(t.contexts.flags,3,n));return o}(t,i,a):t)))}function Bn(t){if(t)return function(t){return t instanceof Pt||"function"==typeof t}(t)||function(t){return Object.keys(t).some((t=>Jn.includes(t)))}(t)?{captureContext:t}:t}const Jn=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function Hn(t,e){return qt().captureException(t,Bn(e))}function Wn(t,e){const n="string"==typeof e?e:void 0,r="string"!=typeof e?{captureContext:e}:void 0;return qt().captureMessage(t,n,r)}function zn(t,e){return qt().captureEvent(t,e)}function Gn(t,e){Bt().setContext(t,e)}function Kn(t){Bt().setExtras(t)}function Vn(t,e){Bt().setExtra(t,e)}function Yn(t){Bt().setTags(t)}function Zn(t,e){Bt().setTag(t,e)}function Xn(t){Bt().setUser(t)}function Qn(){return Bt().lastEventId()}function tr(t){Bt().addEventProcessor(t)}function er(t,e,n){return e||`${function(t){return`${function(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}(t)}${t.projectId}/envelope/`}(t)}?${function(t,e){const n={sentry_version:"7"};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}(t,n)}`}const nr=[];function rr(t,e){for(const n of e)(null==n?void 0:n.afterAllSetup)&&n.afterAllSetup(t)}function sr(t,e,n){if(n[e.name])_&&C.log(`Integration skipped because it was already installed: ${e.name}`);else{if(n[e.name]=e,nr.includes(e.name)||"function"!=typeof e.setupOnce||(e.setupOnce(),nr.push(e.name)),e.setup&&"function"==typeof e.setup&&e.setup(t),"function"==typeof e.preprocessEvent){const n=e.preprocessEvent.bind(e);t.on("preprocessEvent",((e,r)=>n(e,r,t)))}if("function"==typeof e.processEvent){const n=e.processEvent.bind(e),r=Object.assign(((e,r)=>n(e,r,t)),{id:e.name});t.addEventProcessor(r)}_&&C.log(`Integration installed: ${e.name}`)}}function or(t,e){return e?Ht(e,(()=>{const n=Pe(),r=n?ke(n):zt(e);return[n?Ge(n):ze(t,e),r]})):[void 0,void 0]}const ir={trace:1,debug:5,info:9,warn:13,error:17,fatal:21};function ar(t,e,n,r=!0){!n||t[e]&&!r||(t[e]=n)}function cr(t,e){const n=dr(),r=pr(t);void 0===r?n.set(t,[e]):r.length>=100?(lr(t,r),n.set(t,[e])):n.set(t,[...r,e])}function ur(t,e=qt(),n=cr){var r,s,o;const i=null!=(r=null==e?void 0:e.getClient())?r:Wt();if(!i)return void(_&&C.warn("No client available to capture log."));const{release:a,environment:l,enableLogs:p=!1,beforeSendLog:d}=i.getOptions();if(!p)return void(_&&C.warn("logging option not enabled, log will not be captured."));const[,f]=or(i,e),h=c({},t.attributes),{user:{id:m,email:g,username:y}}=function(t){const e=Jt().getScopeData();return Rn(e,Bt().getScopeData()),Rn(e,t.getScopeData()),e}(e);ar(h,"user.id",m,!1),ar(h,"user.email",g,!1),ar(h,"user.name",y,!1),ar(h,"sentry.release",a),ar(h,"sentry.environment",l);const{name:v,version:b}=null!=(o=null==(s=i.getSdkMetadata())?void 0:s.sdk)?o:{};ar(h,"sentry.sdk.name",v),ar(h,"sentry.sdk.version",b);const S=i.getIntegrationByName("Replay"),k=null==S?void 0:S.getReplayId(!0);ar(h,"sentry.replay_id",k),k&&"buffer"===(null==S?void 0:S.getRecordingMode())&&ar(h,"sentry._internal.replay_is_buffering",!0);const x=t.message;if(G(x)){const{__sentry_template_string__:t,__sentry_template_values__:e=[]}=x;(null==e?void 0:e.length)&&(h["sentry.message.template"]=t),e.forEach(((t,e)=>{h[`sentry.message.parameter.${e}`]=t}))}const T=Mt(e);ar(h,"sentry.trace.parent_span_id",null==T?void 0:T.spanContext().spanId);const E=u(c({},t),{attributes:h});i.emit("beforeCaptureLog",E);const I=d?w((()=>d(E))):E;if(!I)return i.recordDroppedEvent("before_send","log_item",1),void(_&&C.warn("beforeSendLog returned null, log will not be captured."));const{level:O,message:A,attributes:$={},severityNumber:j}=I,M={timestamp:Et(),level:O,body:A,trace_id:null==f?void 0:f.trace_id,severity_number:null!=j?j:ir[O],attributes:Object.keys($).reduce(((t,e)=>(t[e]=function(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let r="";try{r=null!=(e=JSON.stringify(t))?e:""}catch(n){}return{value:r,type:"string"}}}}($[e]),t)),{})};n(i,M),i.emit("afterCaptureLog",I)}function lr(t,e){var n;const r=null!=(n=null!=e?e:pr(t))?n:[];if(0===r.length)return;const s=t.getOptions(),o=function(t,e,n,r){const s={};return(null==e?void 0:e.sdk)&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=he(r)),Xe(s,[(o=t,[{type:"log",item_count:o.length,content_type:"application/vnd.sentry.items.log+json"},{items:o}])]);var o}(r,s._metadata,s.tunnel,t.getDsn());dr().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(o)}function pr(t){return dr().get(t)}function dr(){return k("clientToLogBufferMap",(()=>/* @__PURE__ */new WeakMap))}function fr(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let r="";try{r=null!=(e=JSON.stringify(t))?e:""}catch(n){}return{value:r,type:"string"}}}}function hr(t,e,n,r=!0){!n||!r&&e in t||(t[e]=n)}function mr(t,e){const n=br(),r=vr(t);void 0===r?n.set(t,[e]):r.length>=1e3?(yr(t,r),n.set(t,[e])):n.set(t,[...r,e])}function gr(t,e,n){var r,s;const{release:o,environment:i}=e.getOptions(),a=c({},t.attributes),{user:{id:l,email:p,username:d}}=function(t){const e=Jt().getScopeData();return Rn(e,Bt().getScopeData()),Rn(e,t.getScopeData()),e}(n);hr(a,"user.id",l,!1),hr(a,"user.email",p,!1),hr(a,"user.name",d,!1),hr(a,"sentry.release",o),hr(a,"sentry.environment",i);const{name:f,version:h}=null!=(s=null==(r=e.getSdkMetadata())?void 0:r.sdk)?s:{};hr(a,"sentry.sdk.name",f),hr(a,"sentry.sdk.version",h);const m=e.getIntegrationByName("Replay"),g=null==m?void 0:m.getReplayId(!0);return hr(a,"sentry.replay_id",g),g&&"buffer"===(null==m?void 0:m.getRecordingMode())&&hr(a,"sentry._internal.replay_is_buffering",!0),u(c({},t),{attributes:a})}function _r(t,e){var n,r,s,o;const i=null!=(n=null==e?void 0:e.scope)?n:qt(),a=null!=(r=null==e?void 0:e.captureSerializedMetric)?r:mr,c=null!=(s=null==i?void 0:i.getClient())?s:Wt();if(!c)return void(_&&C.warn("No client available to capture metric."));const{_experiments:u,enableMetrics:l,beforeSendMetric:p}=c.getOptions();if(!(null==(o=null!=l?l:null==u?void 0:u.enableMetrics)||o))return void(_&&C.warn("metrics option not enabled, metric will not be captured."));const d=gr(t,c,i);c.emit("processMetric",d);const f=p||(null==u?void 0:u.beforeSendMetric),h=f?f(d):d;if(!h)return void(_&&C.log("`beforeSendMetric` returned `null`, will not send metric."));const m=function(t,e,n){const r={};for(const c in t.attributes)void 0!==t.attributes[c]&&(r[c]=fr(t.attributes[c]));const[,s]=or(e,n),o=Mt(n),i=o?o.spanContext().traceId:null==s?void 0:s.trace_id,a=o?o.spanContext().spanId:void 0;return{timestamp:Et(),trace_id:null!=i?i:"",span_id:a,name:t.name,type:t.type,unit:t.unit,value:t.value,attributes:r}}(h,c,i);_&&C.log("[Metric]",m),a(c,m),c.emit("afterCaptureMetric",h)}function yr(t,e){var n;const r=null!=(n=null!=e?e:vr(t))?n:[];if(0===r.length)return;const s=t.getOptions(),o=function(t,e,n,r){const s={};return(null==e?void 0:e.sdk)&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=he(r)),Xe(s,[(o=t,[{type:"trace_metric",item_count:o.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:o}])]);var o}(r,s._metadata,s.tunnel,t.getDsn());br().set(t,[]),t.emit("flushMetrics"),t.sendEnvelope(o)}function vr(t){return br().get(t)}function br(){return k("clientToMetricBufferMap",(()=>/* @__PURE__ */new WeakMap))}const Sr=Symbol.for("SentryBufferFullError");function kr(t=100){const e=/* @__PURE__ */new Set;function n(t){e.delete(t)}return{get $(){return Array.from(e)},add:function(r){if(!(e.size<t))return An(Sr);const s=r();return e.add(s),s.then((()=>n(s)),(()=>n(s))),s},drain:function(t){if(!e.size)return Cn(!0);const n=Promise.allSettled(Array.from(e)).then((()=>!0));if(!t)return n;const r=[n,new Promise((e=>setTimeout((()=>e(!1)),t)))];return Promise.race(r)}}}function xr(t,{statusCode:e,headers:n},r=Date.now()){const s=c({},t),o=null==n?void 0:n["x-sentry-rate-limits"],i=null==n?void 0:n["retry-after"];if(o)for(const a of o.trim().split(",")){const[t,e,,,n]=a.split(":",5),o=parseInt(t,10),i=1e3*(isNaN(o)?60:o);if(e)for(const a of e.split(";"))"metric_bucket"===a&&n&&!n.split(";").includes("custom")||(s[a]=r+i);else s.all=r+i}else i?s.all=r+function(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${t}`);return isNaN(r)?6e4:r-e}(i,r):429===e&&(s.all=r+6e4);return s}function Tr(t,e,n=kr(t.bufferSize||64)){let r={};return{send:function(s){const o=[];if(tn(s,((e,n)=>{const s=an(n);!function(t,e,n=Date.now()){return function(t,e){return t[e]||t.all||0}(t,e)>n}(r,s)?o.push(e):t.recordDroppedEvent("ratelimit_backoff",s)})),0===o.length)return Promise.resolve({});const i=Xe(s[0],o),a=e=>{tn(i,((n,r)=>{t.recordDroppedEvent(e,an(r))}))};return n.add((()=>e({body:nn(i)}).then((t=>(void 0!==t.statusCode&&(t.statusCode<200||t.statusCode>=300)&&_&&C.warn(`Sentry responded with status code ${t.statusCode} to sent event.`),r=xr(r,t),t)),(t=>{throw a("network_error"),_&&C.error("Encountered error running transport request:",t),t})))).then((t=>t),(t=>{if(t===Sr)return _&&C.error("Skipped sending event because buffer is full."),a("queue_overflow"),Promise.resolve({});throw t}))},flush:t=>n.drain(t)}}function wr(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];(null==n?void 0:n.value)&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch(n){}return e}const Er="Not capturing exception because it's already been captured.",Ir="Discarded session because of missing or non-string release",Or=Symbol.for("SentryInternalError"),Cr=Symbol.for("SentryDoNotSendEventError");function Ar(t){return{message:t,[Or]:!0}}function $r(t){return{message:t,[Cr]:!0}}function jr(t){return!!t&&"object"==typeof t&&Or in t}function Mr(t){return!!t&&"object"==typeof t&&Cr in t}function Pr(t,e,n,r,s){let o,i=0,a=!1;t.on(n,(()=>{i=0,clearTimeout(o),a=!1})),t.on(e,(e=>{i+=r(e),i>=8e5?s(t):a||(a=!0,o=setTimeout((()=>{s(t)}),5e3))})),t.on("flush",(()=>{s(t)}))}class Rr{constructor(t){var e,n,r,s,o,i,a;if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=kr(null!=(n=null==(e=t.transportOptions)?void 0:e.bufferSize)?n:64),t.dsn?this._dsn=ye(t.dsn):_&&C.warn("No DSN provided, client will not send events."),this._dsn){const e=er(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport(u(c({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this)},t.transportOptions),{url:e}))}this._options.enableLogs=null!=(s=this._options.enableLogs)?s:null==(r=this._options._experiments)?void 0:r.enableLogs,this._options.enableLogs&&Pr(this,"afterCaptureLog","flushLogs",Ur,lr);(null==(a=null!=(i=this._options.enableMetrics)?i:null==(o=this._options._experiments)?void 0:o.enableMetrics)||a)&&Pr(this,"afterCaptureMetric","flushMetrics",Fr,yr)}captureException(t,e,n){const r=yt();if(xt(t))return _&&C.log(Er),r;const s=c({event_id:r},e);return this._process((()=>this.eventFromException(t,s).then((t=>this._captureEvent(t,s,n))).then((t=>t))),"error"),s.event_id}captureMessage(t,e,n,r){const s=c({event_id:yt()},n),o=G(t)?t:String(t),i=K(t),a=i?this.eventFromMessage(o,e,s):this.eventFromException(t,s);return this._process((()=>a.then((t=>this._captureEvent(t,s,r)))),i?"unknown":"error"),s.event_id}captureEvent(t,e,n){const r=yt();if((null==e?void 0:e.originalException)&&xt(e.originalException))return _&&C.log(Er),r;const s=c({event_id:r},e),o=t.sdkProcessingMetadata||{},i=o.capturedSpanScope,a=o.capturedSpanIsolationScope,u=Nr(t.type);return this._process((()=>this._captureEvent(t,s,i||n,a)),u),s.event_id}captureSession(t){this.sendSession(t),It(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){return p(this,null,(function*(){const e=this._transport;if(!e)return!0;this.emit("flush");const n=yield this._isClientDoneProcessing(t),r=yield e.flush(t);return n&&r}))}close(t){return p(this,null,(function*(){const e=yield this.flush(t);return this.getOptions().enabled=!1,this.emit("close"),e}))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some((({name:t})=>t.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const e=this._integrations[t.name];sr(this,t,this._integrations),e||rr(this,[t])}sendEvent(t,e={}){this.emit("beforeSendEvent",t,e);let n=un(t,this._dsn,this._options._metadata,this._options.tunnel);for(const r of e.attachments||[])n=Qe(n,sn(r));this.sendEnvelope(n).then((e=>this.emit("afterSendEvent",t,e)))}sendSession(t){const{release:e,environment:n=Be}=this._options;if("aggregates"in t){const r=t.attrs||{};if(!r.release&&!e)return void(_&&C.warn(Ir));r.release=r.release||e,r.environment=r.environment||n,t.attrs=r}else{if(!t.release&&!e)return void(_&&C.warn(Ir));t.release=t.release||e,t.environment=t.environment||n}this.emit("beforeSendSession",t);const r=function(t,e,n,r){const s=cn(n);return Xe(c(c({sent_at:/* @__PURE__ */(new Date).toISOString()},s&&{sdk:s}),!!r&&e&&{dsn:he(e)}),["aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()]])}(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(t,e,n=1){if(this._options.sendClientReports){const r=`${t}:${e}`;_&&C.log(`Recording outcome: "${r}"${n>1?` (${n} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+n}}on(t,e){const n=this._hooks[t]=this._hooks[t]||/* @__PURE__ */new Set,r=(...t)=>e(...t);return n.add(r),()=>{n.delete(r)}}emit(t,...e){const n=this._hooks[t];n&&n.forEach((t=>t(...e)))}sendEnvelope(t){return p(this,null,(function*(){if(this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport)try{return yield this._transport.send(t)}catch(e){return _&&C.error("Error while sending envelope:",e),{}}return _&&C.error("Transport disabled"),{}}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=function(t,e){const n={};return e.forEach((e=>{e&&sr(t,e,n)})),n}(this,t),rr(this,t)}_updateSessionFromEvent(t,e){var n,r;let s="fatal"===e.level,o=!1;const i=null==(n=e.exception)?void 0:n.values;if(i){o=!0,s=!1;for(const t of i)if(!1===(null==(r=t.mechanism)?void 0:r.handled)){s=!0;break}}const a="ok"===t.status;(a&&0===t.errors||a&&s)&&(It(t,u(c({},s&&{status:"crashed"}),{errors:t.errors||Number(o||s)})),this.captureSession(t))}_isClientDoneProcessing(t){return p(this,null,(function*(){let e=0;for(;!t||e<t;){if(yield new Promise((t=>setTimeout(t,1))),!this._numProcessing)return!0;e++}return!1}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(t,e,n,r){const s=this.getOptions(),o=Object.keys(this._integrations);return!e.integrations&&(null==o?void 0:o.length)&&(e.integrations=o),this.emit("preprocessEvent",t,e),t.type||r.setLastEventId(t.event_id||e.event_id),qn(s,t,e,n,this,r).then((t=>{if(null===t)return t;this.emit("postprocessEvent",t,e),t.contexts=c({trace:zt(n)},t.contexts);const r=ze(this,n);return t.sdkProcessingMetadata=c({dynamicSamplingContext:r},t.sdkProcessingMetadata),t}))}_captureEvent(t,e={},n=qt(),r=Bt()){return _&&Dr(t)&&C.log(`Captured error event \`${wr(t)[0]||"<unknown>"}\``),this._processEvent(t,e,n,r).then((t=>t.event_id),(t=>{_&&(Mr(t)?C.log(t.message):jr(t)?C.warn(t.message):C.warn(t))}))}_processEvent(t,e,n,r){const s=this.getOptions(),{sampleRate:o}=s,i=Lr(t),a=Dr(t),l=`before send for type \`${t.type||"error"}\``,p=void 0===o?void 0:ve(o);if(a&&"number"==typeof p&&Math.random()>p)return this.recordDroppedEvent("sample_rate","error"),An($r(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const d=Nr(t.type);return this._prepareEvent(t,e,n,r).then((t=>{if(null===t)throw this.recordDroppedEvent("event_processor",d),$r("An event processor returned `null`, will not send event.");if(e.data&&!0===e.data.__sentry__)return t;const n=function(t,e,n,r){const{beforeSend:s,beforeSendTransaction:o,beforeSendSpan:i,ignoreSpans:a}=e;let l=n;if(Dr(l)&&s)return s(l,r);if(Lr(l)){if(i||a){const e=function(t){var e,n,r;const{trace_id:s,parent_span_id:o,span_id:i,status:a,origin:c,data:u,op:l}=null!=(n=null==(e=t.contexts)?void 0:e.trace)?n:{};return{data:null!=u?u:{},description:t.transaction,op:l,parent_span_id:o,span_id:null!=i?i:"",start_timestamp:null!=(r=t.start_timestamp)?r:0,status:a,timestamp:t.timestamp,trace_id:null!=s?s:"",origin:c,profile_id:null==u?void 0:u[te],exclusive_time:null==u?void 0:u[ee],measurements:t.measurements,is_segment:!0}}(l);if((null==a?void 0:a.length)&&Ue(e,a))return null;if(i){const t=i(e);t?l=Ot(n,{type:"transaction",timestamp:(p=t).timestamp,start_timestamp:p.start_timestamp,transaction:p.description,contexts:{trace:{trace_id:p.trace_id,span_id:p.span_id,parent_span_id:p.parent_span_id,op:p.op,status:p.status,origin:p.origin,data:c(c(c({},p.data),p.profile_id&&{[te]:p.profile_id}),p.exclusive_time&&{[ee]:p.exclusive_time})}},measurements:p.measurements}):Re()}if(l.spans){const e=[],n=l.spans;for(const t of n)if((null==a?void 0:a.length)&&Ue(t,a))qe(n,t);else if(i){const n=i(t);n?e.push(n):(Re(),e.push(t))}else e.push(t);const r=l.spans.length-e.length;r&&t.recordDroppedEvent("before_send","span",r),l.spans=e}}if(o){if(l.spans){const t=l.spans.length;l.sdkProcessingMetadata=u(c({},n.sdkProcessingMetadata),{spanCountBeforeProcessing:t})}return o(l,r)}}var p;return l}(this,s,t,e);return function(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Z(t))return t.then((t=>{if(!V(t)&&null!==t)throw Ar(n);return t}),(t=>{throw Ar(`${e} rejected with ${t}`)}));if(!V(t)&&null!==t)throw Ar(n);return t}(n,l)})).then((s=>{var o;if(null===s){if(this.recordDroppedEvent("before_send",d),i){const e=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",e)}throw $r(`${l} returned \`null\`, will not send event.`)}const p=n.getSession()||r.getSession();if(a&&p&&this._updateSessionFromEvent(p,s),i){const t=((null==(o=s.sdkProcessingMetadata)?void 0:o.spanCountBeforeProcessing)||0)-(s.spans?s.spans.length:0);t>0&&this.recordDroppedEvent("before_send","span",t)}const f=s.transaction_info;if(i&&f&&s.transaction!==t.transaction){const t="custom";s.transaction_info=u(c({},f),{source:t})}return this.sendEvent(s,e),s})).then(null,(t=>{if(Mr(t)||jr(t))throw t;throw this.captureException(t,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:t}),Ar(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${t}`)}))}_process(t,e){this._numProcessing++,this._promiseBuffer.add(t).then((t=>(this._numProcessing--,t)),(t=>(this._numProcessing--,t===Sr&&this.recordDroppedEvent("queue_overflow",e),t)))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map((([t,e])=>{const[n,r]=t.split(":");return{reason:n,category:r,quantity:e}}))}_flushOutcomes(){_&&C.log("Flushing outcomes...");const t=this._clearOutcomes();if(0===t.length)return void(_&&C.log("No outcomes to send"));if(!this._dsn)return void(_&&C.log("No dsn provided, will not send outcomes"));_&&C.log("Sending outcomes:",t);const e=(n=t,Xe((r=this._options.tunnel&&he(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:Tt(),discarded_events:n}]]));var n,r;this.sendEnvelope(e)}}function Nr(t){return"replay_event"===t?"replay":t||"error"}function Dr(t){return void 0===t.type}function Lr(t){return"transaction"===t.type}function Fr(t){let e=0;return t.name&&(e+=2*t.name.length),e+=8,e+qr(t.attributes)}function Ur(t){let e=0;return t.message&&(e+=2*t.message.length),e+qr(t.attributes)}function qr(t){if(!t)return 0;let e=0;return Object.values(t).forEach((t=>{Array.isArray(t)?e+=t.length*Br(t[0]):K(t)?e+=Br(t):e+=100})),e}function Br(t){return"string"==typeof t?2*t.length:"number"==typeof t?8:"boolean"==typeof t?4:0}function Jr(t,e){!0===e.debug&&(_?C.enable():w((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})));qt().update(e.initialScope);const n=new t(e);return function(t){qt().setClient(t)}(n),n.init(),n}function Hr(t,e){let n;return tn(t,((t,r)=>(e.includes(r)&&(n=Array.isArray(t)?t[1]:void 0),!!n))),n}function Wr(t,e){return n=>{const r=t(n),s=/* @__PURE__ */new Map;function o(e,r){const o=r?`${e}:${r}`:e;let i=s.get(o);if(!i){const a=me(e);if(!a)return;const l=er(a,n.tunnel);i=r?function(t,e){return n=>{const r=t(n);return u(c({},r),{send:t=>p(null,null,(function*(){const n=Hr(t,["event","transaction","profile","replay_event"]);return n&&(n.release=e),r.send(t)}))})}}(t,r)(u(c({},n),{url:l})):t(u(c({},n),{url:l})),s.set(o,i)}return[e,i]}return{send:function(t){return p(this,null,(function*(){const n=e({envelope:t,getEvent:function(e){const n=(null==e?void 0:e.length)?e:["event"];return Hr(t,n)}}).map((t=>"string"==typeof t?o(t,void 0):o(t.dsn,t.release))).filter((t=>!!t)),s=n.length?n:[["",r]],i=yield Promise.all(s.map((([e,n])=>n.send(function(t,e){return Xe(e?u(c({},t[0]),{dsn:e}):t[0],t[1])}(t,e)))));return i[0]}))},flush:function(t){return p(this,null,(function*(){const e=[...s.values(),r];return(yield Promise.all(e.map((e=>e.flush(t))))).every((t=>t))}))}}}}const zr=function(t,...e){const n=new String(String.raw(t,...e));return n.__sentry_template_string__=t.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=e,n};const Gr=100;function Kr(t,e){const n=Wt(),r=Bt();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=Gr}=n.getOptions();if(o<=0)return;const i=Tt(),a=c({timestamp:i},t),u=s?w((()=>s(a,e))):a;null!==u&&(n.emit&&n.emit("beforeAddBreadcrumb",u,e),r.addBreadcrumb(u,o))}let Vr;const Yr=/* @__PURE__ */new WeakMap,Zr=()=>({name:"FunctionToString",setupOnce(){Vr=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=it(this),n=Yr.has(Wt())&&void 0!==e?e:this;return Vr.apply(n,t)}}catch(t){}},setup(t){Yr.set(t,!0)}}),Xr=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Qr=(t={})=>{let e;return{name:"EventFilters",setup(n){const r=n.getOptions();e=es(t,r)},processEvent(n,r,s){if(!e){const n=s.getOptions();e=es(t,n)}return function(t,e){if(t.type){if("transaction"===t.type&&function(t,e){if(!(null==e?void 0:e.length))return!1;const n=t.transaction;return!!n&&gt(n,e)}(t,e.ignoreTransactions))return _&&C.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${bt(t)}`),!0}else{if(function(t,e){if(!(null==e?void 0:e.length))return!1;return wr(t).some((t=>gt(t,e)))}(t,e.ignoreErrors))return _&&C.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${bt(t)}`),!0;if(function(t){var e,n;if(!(null==(n=null==(e=t.exception)?void 0:e.values)?void 0:n.length))return!1;return!t.message&&!t.exception.values.some((t=>t.stacktrace||t.type&&"Error"!==t.type||t.value))}(t))return _&&C.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${bt(t)}`),!0;if(function(t,e){if(!(null==e?void 0:e.length))return!1;const n=ns(t);return!!n&&gt(n,e)}(t,e.denyUrls))return _&&C.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${bt(t)}.\nUrl: ${ns(t)}`),!0;if(!function(t,e){if(!(null==e?void 0:e.length))return!0;const n=ns(t);return!n||gt(n,e)}(t,e.allowUrls))return _&&C.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${bt(t)}.\nUrl: ${ns(t)}`),!0}return!1}(n,e)?null:n}}},ts=(t={})=>u(c({},Qr(t)),{name:"InboundFilters"});function es(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:Xr],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function ns(t){var e,n,r;try{const s=[...null!=(n=null==(e=t.exception)?void 0:e.values)?n:[]].reverse().find((t=>{var e,n,r;return void 0===(null==(e=t.mechanism)?void 0:e.parent_id)&&(null==(r=null==(n=t.stacktrace)?void 0:n.frames)?void 0:r.length)})),o=null==(r=null==s?void 0:s.stacktrace)?void 0:r.frames;return o?function(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(o):null}catch(s){return _&&C.error(`Cannot extract url for event ${bt(t)}`),null}}const rs=/* @__PURE__ */new Map,ss=/* @__PURE__ */new Set;function os(t,e){return function(t){if(y._sentryModuleMetadata)for(const e of Object.keys(y._sentryModuleMetadata)){const n=y._sentryModuleMetadata[e];if(ss.has(e))continue;ss.add(e);const r=t(e);for(const t of r.reverse())if(t.filename){rs.set(t.filename,n);break}}}(t),rs.get(e)}function is(t,e){var n,r;null==(r=null==(n=e.exception)?void 0:n.values)||r.forEach((e=>{var n,r;null==(r=null==(n=e.stacktrace)?void 0:n.frames)||r.forEach((e=>{if(!e.filename||e.module_metadata)return;const n=os(t,e.filename);n&&(e.module_metadata=n)}))}))}function as(t){var e,n;null==(n=null==(e=t.exception)?void 0:e.values)||n.forEach((t=>{var e,n;null==(n=null==(e=t.stacktrace)?void 0:e.frames)||n.forEach((t=>{delete t.module_metadata}))}))}const cs=()=>({name:"ModuleMetadata",setup(t){t.on("beforeEnvelope",(t=>{tn(t,((t,e)=>{if("event"===e){const e=Array.isArray(t)?t[1]:void 0;e&&(as(e),t[1]=e)}}))})),t.on("applyFrameMetadata",(e=>{if(e.type)return;is(t.getOptions().stackParser,e)}))}});function us(t){const e="console";R(e,t),N(e,ls)}function ls(){"console"in y&&x.forEach((function(t){t in y.console&&rt(y.console,t,(function(e){return T[t]=e,function(...e){D("console",{args:e,level:t});const n=T[t];null==n||n.apply(y.console,e)}}))}))}function ps(t){return"warn"===t?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const ds=(t={})=>{var e;const n=t.levels||x,r=null==(e=t.handled)||e;return{name:"CaptureConsole",setup(t){"console"in y&&us((({args:e,level:s})=>{Wt()===t&&n.includes(s)&&function(t,e,n){const r=ps(e),s=new Error,o={level:ps(e),extra:{arguments:t}};Ht((i=>{if(i.addEventProcessor((t=>(t.logger="console",kt(t,{handled:n,type:"auto.core.capture_console"}),t))),"assert"===e){if(!t[0]){const e=`Assertion failed: ${ht(t.slice(1)," ")||"console.assert"}`;i.setExtra("arguments",t.slice(1)),i.captureMessage(e,r,{captureContext:o,syntheticException:s})}return}const a=t.find((t=>t instanceof Error));if(a)return void Hn(a,o);const c=ht(t," ");i.captureMessage(c,r,{captureContext:o,syntheticException:s})}))}(e,s,r)}))}}};const fs=(t={})=>{const{depth:e=3,captureErrorCause:n=!0}=t;return{name:"ExtraErrorData",processEvent(t,r,s){const{maxValueLength:o}=s.getOptions();return function(t,e={},n,r,s){if(!e.originalException||!J(e.originalException))return t;const o=e.originalException.name||e.originalException.constructor.name,i=hs(e.originalException,r,s);if(i){const e=c({},t.contexts),r=Ve(i,n);return V(r)&&(st(r,"__sentry_skip_normalization__",!0),e[o]=r),u(c({},t),{contexts:e})}return t}(t,r,e,n,o)}}};function hs(t,e,n){try{const r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],s={};for(const e of Object.keys(t)){if(-1!==r.indexOf(e))continue;const o=t[e];s[e]=J(o)||"string"==typeof o?n?ft(`${o}`,n):`${o}`:o}if(e&&void 0!==t.cause)if(J(t.cause)){const e=t.cause.name||t.cause.constructor.name;s.cause={[e]:hs(t.cause,!1,n)}}else s.cause=t.cause;if("function"==typeof t.toJSON){const e=t.toJSON();for(const t of Object.keys(e)){const n=e[t];s[t]=J(n)?n.toString():n}}return s}catch(r){_&&C.error("Unable to extract extra data from the Error object:",r)}return null}const ms=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function gs(...t){let e="",n=!1;for(let r=t.length-1;r>=-1&&!n;r--){const s=r>=0?t[r]:"/";s&&(e=`${s}/${e}`,n="/"===s.charAt(0))}return e=function(t,e){let n=0;for(let r=t.length-1;r>=0;r--){const e=t[r];"."===e?t.splice(r,1):".."===e?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}(e.split("/").filter((t=>!!t)),!n).join("/"),(n?"/":"")+e||"."}function _s(t){let e=0;for(;e<t.length&&""===t[e];e++);let n=t.length-1;for(;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}function ys(t,e){return function(t){const e=t.length>1024?`<truncated>${t.slice(-1024)}`:t,n=ms.exec(e);return n?n.slice(1):[]}(t)[2]||""}const vs=(t={})=>{const e=t.root,n=t.prefix||"app:///",r="window"in y&&!!y.window,s=t.iteratee||function({isBrowser:t,root:e,prefix:n}){return r=>{if(!r.filename)return r;const s=/^[a-zA-Z]:\\/.test(r.filename)||r.filename.includes("\\")&&!r.filename.includes("/"),o=/^\//.test(r.filename);if(t){if(e){const t=r.filename;0===t.indexOf(e)&&(r.filename=t.replace(e,n))}}else if(s||o){const t=s?r.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):r.filename,o=e?function(t,e){t=gs(t).slice(1),e=gs(e).slice(1);const n=_s(t.split("/")),r=_s(e.split("/")),s=Math.min(n.length,r.length);let o=s;for(let a=0;a<s;a++)if(n[a]!==r[a]){o=a;break}let i=[];for(let a=o;a<n.length;a++)i.push("..");return i=i.concat(r.slice(o)),i.join("/")}(e,t):ys(t);r.filename=`${n}${o}`}return r}}({isBrowser:r,root:e,prefix:n});return{name:"RewriteFrames",processEvent(t){let e=t;return t.exception&&Array.isArray(t.exception.values)&&(e=function(t){try{return u(c({},t),{exception:u(c({},t.exception),{values:t.exception.values.map((t=>{return c(c({},t),t.stacktrace&&{stacktrace:(e=t.stacktrace,u(c({},e),{frames:null==(n=null==e?void 0:e.frames)?void 0:n.map((t=>s(t)))}))});var e,n}))})})}catch(e){return t}}(e)),e}}};const bs=["reauthenticate","signInAnonymously","signInWithOAuth","signInWithIdToken","signInWithOtp","signInWithPassword","signInWithSSO","signOut","signUp","verifyOtp"],Ss=["createUser","deleteUser","listUsers","getUserById","updateUserById","inviteUserByEmail"],ks={eq:"eq",neq:"neq",gt:"gt",gte:"gte",lt:"lt",lte:"lte",like:"like","like(all)":"likeAllOf","like(any)":"likeAnyOf",ilike:"ilike","ilike(all)":"ilikeAllOf","ilike(any)":"ilikeAnyOf",is:"is",in:"in",cs:"contains",cd:"containedBy",sr:"rangeGt",nxl:"rangeGte",sl:"rangeLt",nxr:"rangeLte",adj:"rangeAdjacent",ov:"overlaps",fts:"",plfts:"plain",phfts:"phrase",wfts:"websearch",not:"not"},xs=["select","insert","upsert","update","delete"];function Ts(t){try{t.__SENTRY_INSTRUMENTED__=!0}catch(e){}}function ws(t){try{return t.__SENTRY_INSTRUMENTED__}catch(e){return!1}}function Es(t,e){if(""===e||"*"===e)return"select(*)";if("select"===t)return`select(${e})`;if("or"===t||t.endsWith(".or"))return`${t}${e}`;const[n,...r]=e.split(".");let s;return s=(null==n?void 0:n.startsWith("fts"))?"textSearch":(null==n?void 0:n.startsWith("plfts"))?"textSearch[plain]":(null==n?void 0:n.startsWith("phfts"))?"textSearch[phrase]":(null==n?void 0:n.startsWith("wfts"))?"textSearch[websearch]":n&&ks[n]||"filter",`${s}(${t}, ${r.join(".")})`}function Is(t,e=!1){return new Proxy(t,{apply:(n,r,s)=>yn({name:`auth ${e?"(admin) ":""}${t.name}`,attributes:{[Yt]:"auto.db.supabase",[Vt]:"db","db.system":"postgresql","db.operation":`auth.${e?"admin.":""}${t.name}`}},(t=>Reflect.apply(n,r,s).then((e=>(e&&"object"==typeof e&&"error"in e&&e.error?(t.setStatus({code:2}),Hn(e.error,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}})):t.setStatus({code:1}),t.end(),e))).catch((e=>{throw t.setStatus({code:2}),t.end(),Hn(e,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}}),e})).then(...s)))})}function Os(t){ws(t.prototype.from)||(t.prototype.from=new Proxy(t.prototype.from,{apply(t,e,n){const r=Reflect.apply(t,e,n);return function(t){for(const e of xs)ws(t.prototype[e])||(t.prototype[e]=new Proxy(t.prototype[e],{apply(t,n,r){const s=Reflect.apply(t,n,r),o=s.constructor;return _&&C.log(`Instrumenting ${e} operation's PostgRESTFilterBuilder`),Cs(o),s}}),Ts(t.prototype[e]))}(r.constructor),r}}),Ts(t.prototype.from))}function Cs(t){ws(t.prototype.then)||(t.prototype.then=new Proxy(t.prototype.then,{apply(t,e,n){var r;const s=xs,o=e,i=function(t,e={}){var n;switch(t){case"GET":return"select";case"POST":return(null==(n=e.Prefer)?void 0:n.includes("resolution="))?"upsert":"insert";case"PATCH":return"update";case"DELETE":return"delete";default:return"<unknown-op>"}}(o.method,o.headers);if(!s.includes(i))return Reflect.apply(t,e,n);if(!(null==(r=null==o?void 0:o.url)?void 0:r.pathname)||"string"!=typeof o.url.pathname)return Reflect.apply(t,e,n);const a=o.url.pathname.split("/"),c=a.length>0?a[a.length-1]:"",u=[];for(const[f,h]of o.url.searchParams.entries())u.push(Es(f,h));const l=/* @__PURE__ */Object.create(null);if(V(o.body))for(const[f,h]of Object.entries(o.body))l[f]=h;const p=`${"select"===i?"":`${i}${l?"(...) ":""}`}${u.join(" ")} from(${c})`,d={"db.table":c,"db.schema":o.schema,"db.url":o.url.origin,"db.sdk":o.headers["X-Client-Info"],"db.system":"postgresql","db.operation":i,[Yt]:"auto.db.supabase",[Vt]:"db"};return u.length&&(d["db.query"]=u),Object.keys(l).length&&(d["db.body"]=l),yn({name:p,attributes:d},(r=>Reflect.apply(t,e,[]).then((t=>{if(r&&(t&&"object"==typeof t&&"status"in t&&re(r,t.status||500),r.end()),t.error){const e=new Error(t.error.message);t.error.code&&(e.code=t.error.code),t.error.details&&(e.details=t.error.details);const n={};u.length&&(n.query=u),Object.keys(l).length&&(n.body=l),Hn(e,(t=>(t.addEventProcessor((t=>(kt(t,{handled:!1,type:"auto.db.supabase.postgres"}),t))),t.setContext("supabase",n),t)))}const e={type:"supabase",category:`db.${i}`,message:p},n={};return u.length&&(n.query=u),Object.keys(l).length&&(n.body=l),Object.keys(n).length&&(e.data=n),Kr(e),t}),(t=>{throw r&&(re(r,500),r.end()),t})).then(...n)))}}),Ts(t.prototype.then))}const As=t=>{if(!t)return void(_&&C.warn("Supabase integration was not installed because no Supabase client was provided."));Os(t.constructor===Function?t:t.constructor),function(t){const e=t.auth;if(e&&!ws(t.auth)){for(const n of bs){const r=e[n];r&&"function"==typeof t.auth[n]&&(t.auth[n]=Is(r))}for(const n of Ss){const r=e.admin[n];r&&"function"==typeof t.auth.admin[n]&&(t.auth.admin[n]=Is(r,!0))}Ts(t.auth)}}(t)},$s=t=>{return e=t.supabaseClient,{setupOnce(){As(e)},name:"Supabase"};var e};function js(t){return u(c({},t),{path:"path"in t&&Array.isArray(t.path)?t.path.join("."):void 0,keys:"keys"in t?JSON.stringify(t.keys):void 0,unionErrors:"unionErrors"in t?JSON.stringify(t.unionErrors):void 0})}function Ms(t){const e=/* @__PURE__ */new Set;for(const r of t.issues){const t=r.path.map((t=>"number"==typeof t?"<array>":t)).join(".");t.length>0&&e.add(t)}const n=Array.from(e);if(0===n.length){let e="variable";if(t.issues.length>0){const n=t.issues[0];void 0!==n&&"expected"in n&&"string"==typeof n.expected&&(e=n.expected)}return`Failed to validate ${e}`}return`Failed to validate keys: ${ft(n.join(", "),100)}`}function Ps(t,e=!1,n,r){var s,o;if(!((null==(s=n.exception)?void 0:s.values)&&r.originalException&&(o=r.originalException,J(o)&&"ZodError"===o.name&&Array.isArray(o.issues))&&0!==r.originalException.issues.length))return n;try{const s=(e?r.originalException.issues:r.originalException.issues.slice(0,t)).map(js);return e&&(Array.isArray(r.attachments)||(r.attachments=[]),r.attachments.push({filename:"zod_issues.json",data:JSON.stringify({issues:s})})),u(c({},n),{exception:u(c({},n.exception),{values:[u(c({},n.exception.values[0]),{value:Ms(r.originalException)}),...n.exception.values.slice(1)]}),extra:u(c({},n.extra),{"zoderror.issues":s.slice(0,t)})})}catch(i){return u(c({},n),{extra:u(c({},n.extra),{"zoderrors sentry integration parse error":{message:"an exception was thrown while processing ZodError within applyZodErrorsToEvent()",error:i instanceof Error?`${i.name}: ${i.message}\n${i.stack}`:"unknown"}})})}}const Rs=(t={})=>{var e;const n=null!=(e=t.limit)?e:10;return{name:"ZodErrors",processEvent:(e,r)=>Ps(n,t.saveZodIssuesAsAttachment,e,r)}},Ns=t=>({name:"ThirdPartyErrorsFilter",setup(t){t.on("beforeEnvelope",(t=>{tn(t,((t,e)=>{if("event"===e){const e=Array.isArray(t)?t[1]:void 0;e&&(as(e),t[1]=e)}}))})),t.on("applyFrameMetadata",(e=>{if(e.type)return;is(t.getOptions().stackParser,e)}))},processEvent(e){const n=function(t){const e=function(t){const e=t.exception;if(e){const t=[];try{return e.values.forEach((e=>{e.stacktrace.frames&&t.push(...e.stacktrace.frames)})),t}catch(n){return}}}(t);if(!e)return;return e.filter((t=>{var e;return!!t.filename&&null!=(null!=(e=t.lineno)?e:t.colno)})).map((t=>t.module_metadata?Object.keys(t.module_metadata).filter((t=>t.startsWith(Ds))).map((t=>t.slice(Ds.length))):[]))}(e);if(n){if(n["drop-error-if-contains-third-party-frames"===t.behaviour||"apply-tag-if-contains-third-party-frames"===t.behaviour?"some":"every"]((e=>!e.some((e=>t.filterKeys.includes(e)))))){if("drop-error-if-contains-third-party-frames"===t.behaviour||"drop-error-if-exclusively-contains-third-party-frames"===t.behaviour)return null;e.tags=u(c({},e.tags),{third_party_code:!0})}}return e}});const Ds="_sentryBundlerPluginAppKey:",Ls="flag.evaluation.";function Fs(t,e,n=100){const r=qt().getScopeData().contexts;r.flags||(r.flags={values:[]});!function(t,e,n,r){if("boolean"!=typeof n)return;if(t.length>r)return void(_&&C.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${r}`));const s=t.findIndex((t=>t.flag===e));-1!==s&&t.splice(s,1);t.length===r&&t.shift();t.push({flag:e,result:n})}(r.flags.values,t,e,n)}const Us=()=>({name:"FeatureFlags",processEvent:(t,e,n)=>function(t){const e=qt().getScopeData().contexts.flags,n=e?e.values:[];return n.length?(void 0===t.contexts&&(t.contexts={}),t.contexts.flags={values:[...n]},t):t}(t),addFeatureFlag(t,e){Fs(t,e),function(t,e,n=10){if("boolean"!=typeof e)return;const r=Pe();if(!r)return;const s=Ee(r).data;if(`${Ls}${t}`in s)return void r.setAttribute(`${Ls}${t}`,e);Object.keys(s).filter((t=>t.startsWith(Ls))).length<n&&r.setAttribute(`${Ls}${t}`,e)}(t,e)}});function qs(t,e,n,r,s){ur({level:t,message:e,attributes:n,severityNumber:s},r)}const Bs=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,debug:function(t,e,{scope:n}={}){qs("debug",t,e,n)},error:function(t,e,{scope:n}={}){qs("error",t,e,n)},fatal:function(t,e,{scope:n}={}){qs("fatal",t,e,n)},fmt:zr,info:function(t,e,{scope:n}={}){qs("info",t,e,n)},trace:function(t,e,{scope:n}={}){qs("trace",t,e,n)},warn:function(t,e,{scope:n}={}){qs("warn",t,e,n)}},Symbol.toStringTag,{value:"Module"}));function Js(t,e,n){return"util"in y&&"function"==typeof y.util.format?y.util.format(...t):function(t,e,n){return t.map((t=>K(t)?String(t):JSON.stringify(Ve(t,e,n)))).join(" ")}(t,e,n)}const Hs={[Yt]:"auto.log.console"},Ws=(t={})=>{const e=t.levels||x;return{name:"ConsoleLogs",setup(t){const{enableLogs:n,normalizeDepth:r=3,normalizeMaxBreadth:s=1e3}=t.getOptions();n?us((({args:n,level:o})=>{if(Wt()!==t||!e.includes(o))return;const i=n[0],a=n.slice(1);if("assert"===o){if(!i){ur({level:"error",message:a.length>0?`Assertion failed: ${Js(a,r,s)}`:"Assertion failed",attributes:Hs})}return}const u="log"===o,l=n.length>1&&"string"==typeof n[0]&&(p=n[0],!/%[sdifocO]/.test(p));var p;const d=c(c({},Hs),l?function(t,e){const n={},r=new Array(e.length).fill("{}").join(" ");return n["sentry.message.template"]=`${t} ${r}`,e.forEach(((t,e)=>{n[`sentry.message.parameter.${e}`]=t})),n}(i,a):{});ur({level:u?"info":o,message:Js(n,r,s),severityNumber:u?10:void 0,attributes:d})})):_&&C.warn("`enableLogs` is not enabled, ConsoleLogs integration disabled")}}};function zs(t,e,n,r){_r({type:t,name:e,value:n,unit:null==r?void 0:r.unit,attributes:null==r?void 0:r.attributes},{scope:null==r?void 0:r.scope})}const Gs=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,count:function(t,e=1,n){zs("counter",t,e,n)},distribution:function(t,e,n){zs("distribution",t,e,n)},gauge:function(t,e,n){zs("gauge",t,e,n)}},Symbol.toStringTag,{value:"Module"})),Ks=["trace","debug","info","warn","error","fatal"];function Vs(t={}){var e;const n=new Set(null!=(e=t.levels)?e:Ks),r=t.client;return{log(t){const e=t,{type:s,level:o,message:i,args:a,tag:c,date:u}=e,p=l(e,["type","level","message","args","tag","date"]),d=r||Wt();if(!d)return;const f=function(t,e){if("verbose"===t)return"debug";if("silent"===t)return"trace";if(t){const e=Ys[t];if(e)return e}if("number"==typeof e){const t=Zs[e];if(t)return t}return"info"}(s,o);if(!n.has(f))return;const{normalizeDepth:h=3,normalizeMaxBreadth:m=1e3}=d.getOptions(),g=[];i&&g.push(i),a&&a.length>0&&g.push(Js(a,h,m));const _=g.join(" ");p["sentry.origin"]="auto.log.consola",c&&(p["consola.tag"]=c),s&&(p["consola.type"]=s),null!=o&&"number"==typeof o&&(p["consola.level"]=o),ur({level:f,message:_,attributes:p})}}}const Ys={silent:"trace",fatal:"fatal",error:"error",warn:"warn",log:"info",info:"info",success:"info",fail:"error",ready:"info",start:"info",box:"info",debug:"debug",trace:"trace",verbose:"debug",critical:"fatal",notice:"info"},Zs={0:"fatal",1:"warn",2:"info",3:"info",4:"debug",5:"trace"};const Xs="gen_ai.prompt",Qs="gen_ai.system",to="gen_ai.request.model",eo="gen_ai.request.stream",no="gen_ai.request.temperature",ro="gen_ai.request.max_tokens",so="gen_ai.request.frequency_penalty",oo="gen_ai.request.presence_penalty",io="gen_ai.request.top_p",ao="gen_ai.request.top_k",co="gen_ai.response.finish_reasons",uo="gen_ai.response.model",lo="gen_ai.response.id",po="gen_ai.usage.input_tokens",fo="gen_ai.usage.output_tokens",ho="gen_ai.usage.total_tokens",mo="gen_ai.operation.name",go="gen_ai.request.messages",_o="gen_ai.response.text",yo="gen_ai.request.available_tools",vo="gen_ai.response.streaming",bo="gen_ai.response.tool_calls",So="openai.response.id",ko="openai.response.model",xo="openai.response.timestamp",To="openai.usage.completion_tokens",wo="openai.usage.prompt_tokens",Eo="chat",Io="responses",Oo="embeddings",Co="anthropic.response.timestamp",Ao=t=>(new TextEncoder).encode(t).length,$o=t=>Ao(JSON.stringify(t));function jo(t,e){if(Ao(t)<=e)return t;let n=0,r=t.length,s="";for(;n<=r;){const o=Math.floor((n+r)/2),i=t.slice(0,o);Ao(i)<=e?(s=i,n=o+1):r=o-1}return s}function Mo(t){return"string"==typeof t?t:t.text}function Po(t,e){return"string"==typeof t?e:u(c({},t),{text:e})}function Ro(t,e){return t&&"object"==typeof t?function(t){return null!==t&&"object"==typeof t&&"content"in t&&"string"==typeof t.content}(t)?function(t,e){const n=u(c({},t),{content:""}),r=e-$o(n);if(r<=0)return[];const s=jo(t.content,r);return[u(c({},t),{content:s})]}(t,e):function(t){return null!==t&&"object"==typeof t&&"parts"in t&&Array.isArray(t.parts)&&t.parts.length>0}(t)?function(t,e){const{parts:n}=t,r=n.map((t=>Po(t,"")));let s=e-$o(u(c({},t),{parts:r}));if(s<=0)return[];const o=[];for(const i of n){const t=Mo(i),e=Ao(t);if(!(e<=s)){if(0===o.length){const e=jo(t,s);e&&o.push(Po(i,e));break}break}o.push(i),s-=e}return o.length>0?[u(c({},t),{parts:o})]:[]}(t,e):[]:[]}function No(t){return function(t,e){if(!Array.isArray(t)||0===t.length)return t;if($o(t)<=e)return t;const n=t.map($o);let r=0,s=t.length;for(let o=t.length-1;o>=0;o--){const t=n[o];if(t&&r+t>e)break;t&&(r+=t),s=o}if(s===t.length)return Ro(t[t.length-1],e);return t.slice(s)}(t,2e4)}function Do(t){return t.includes("messages")?"messages":t.includes("completions")?"completions":t.includes("models")?"models":t.includes("chat")?"chat":t.split(".").pop()||"unknown"}function Lo(t){return`gen_ai.${Do(t)}`}function Fo(t,e){return t?`${t}.${e}`:e}function Uo(t,e,n,r,s){if(void 0!==e&&t.setAttributes({[po]:e}),void 0!==n&&t.setAttributes({[fo]:n}),void 0!==e||void 0!==n||void 0!==r||void 0!==s){const o=(null!=e?e:0)+(null!=n?n:0)+(null!=r?r:0)+(null!=s?s:0);t.setAttributes({[ho]:o})}}function qo(t){if("string"==typeof t)return jo(t,2e4);if(Array.isArray(t)){const e=No(t);return JSON.stringify(e)}return JSON.stringify(t)}const Bo=["responses.create","chat.completions.create","embeddings.create"],Jo=["response.created","response.in_progress","response.failed","response.completed","response.incomplete","response.queued","response.output_text.delta","response.output_item.added","response.function_call_arguments.delta","response.function_call_arguments.done","response.output_item.done"];function Ho(t){return t.includes("chat.completions")?Eo:t.includes("responses")?Io:t.includes("embeddings")?Oo:t.split(".").pop()||"unknown"}function Wo(t){return`gen_ai.${Ho(t)}`}function zo(t){return null!==t&&"object"==typeof t&&"type"in t&&"string"==typeof t.type&&t.type.startsWith("response.")}function Go(t){return null!==t&&"object"==typeof t&&"object"in t&&"chat.completion.chunk"===t.object}function Ko(t,e,n,r){void 0!==e&&t.setAttributes({[wo]:e,[po]:e}),void 0!==n&&t.setAttributes({[To]:n,[fo]:n}),void 0!==r&&t.setAttributes({[ho]:r})}function Vo(t,e,n,r){t.setAttributes({[So]:e,[lo]:e}),t.setAttributes({[ko]:n,[uo]:n}),t.setAttributes({[xo]:new Date(1e3*r).toISOString()})}function Yo(t,e){for(const n of t){const t=n.index;if(void 0!==t&&n.function)if(t in e.chatCompletionToolCalls){const r=e.chatCompletionToolCalls[t];n.function.arguments&&(null==r?void 0:r.function)&&(r.function.arguments+=n.function.arguments)}else e.chatCompletionToolCalls[t]=u(c({},n),{function:{name:n.function.name,arguments:n.function.arguments||""}})}}function Zo(t,e,n){var r,s,o,i,a,c;e.responseId=null!=(r=t.id)?r:e.responseId,e.responseModel=null!=(s=t.model)?s:e.responseModel,e.responseTimestamp=null!=(o=t.created)?o:e.responseTimestamp,t.usage&&(e.promptTokens=t.usage.prompt_tokens,e.completionTokens=t.usage.completion_tokens,e.totalTokens=t.usage.total_tokens);for(const u of null!=(i=t.choices)?i:[])n&&((null==(a=u.delta)?void 0:a.content)&&e.responseTexts.push(u.delta.content),(null==(c=u.delta)?void 0:c.tool_calls)&&Yo(u.delta.tool_calls,e)),u.finish_reason&&e.finishReasons.push(u.finish_reason)}function Xo(t,e,n,r){var s,o,i;if(!t||"object"!=typeof t)return void e.eventTypes.push("unknown:non-object");if(t instanceof Error)return r.setStatus({code:2,message:"internal_error"}),void Hn(t,{mechanism:{handled:!1,type:"auto.ai.openai.stream-response"}});if(!("type"in t))return;const a=t;if(Jo.includes(a.type)){if(n&&("response.output_item.done"===a.type&&"item"in a&&e.responsesApiToolCalls.push(a.item),"response.output_text.delta"===a.type&&"delta"in a&&a.delta))e.responseTexts.push(a.delta);else if("response"in a){const{response:t}=a;e.responseId=null!=(s=t.id)?s:e.responseId,e.responseModel=null!=(o=t.model)?o:e.responseModel,e.responseTimestamp=null!=(i=t.created_at)?i:e.responseTimestamp,t.usage&&(e.promptTokens=t.usage.input_tokens,e.completionTokens=t.usage.output_tokens,e.totalTokens=t.usage.total_tokens),t.status&&e.finishReasons.push(t.status),n&&t.output_text&&e.responseTexts.push(t.output_text)}}else e.eventTypes.push(a.type)}function Qo(t,e,n){var r;if(!e||"object"!=typeof e)return;const s=e;if(function(t){return null!==t&&"object"==typeof t&&"object"in t&&"chat.completion"===t.object}(s)){if(function(t,e,n){if(Vo(t,e.id,e.model,e.created),e.usage&&Ko(t,e.usage.prompt_tokens,e.usage.completion_tokens,e.usage.total_tokens),Array.isArray(e.choices)){const r=e.choices.map((t=>t.finish_reason)).filter((t=>null!==t));if(r.length>0&&t.setAttributes({[co]:JSON.stringify(r)}),n){const n=e.choices.map((t=>{var e;return null==(e=t.message)?void 0:e.tool_calls})).filter((t=>Array.isArray(t)&&t.length>0)).flat();n.length>0&&t.setAttributes({[bo]:JSON.stringify(n)})}}}(t,s,n),n&&(null==(r=s.choices)?void 0:r.length)){const e=s.choices.map((t=>{var e;return(null==(e=t.message)?void 0:e.content)||""}));t.setAttributes({[_o]:JSON.stringify(e)})}}else!function(t){return null!==t&&"object"==typeof t&&"object"in t&&"response"===t.object}(s)?function(t){if(null===t||"object"!=typeof t||!("object"in t))return!1;const e=t;return"list"===e.object&&"string"==typeof e.model&&e.model.toLowerCase().includes("embedding")}(s)&&function(t,e){t.setAttributes({[ko]:e.model,[uo]:e.model}),e.usage&&Ko(t,e.usage.prompt_tokens,void 0,e.usage.total_tokens)}(t,s):(!function(t,e,n){if(Vo(t,e.id,e.model,e.created_at),e.status&&t.setAttributes({[co]:JSON.stringify([e.status])}),e.usage&&Ko(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.total_tokens),n){const n=e;if(Array.isArray(n.output)&&n.output.length>0){const e=n.output.filter((t=>"object"==typeof t&&null!==t&&"function_call"===t.type));e.length>0&&t.setAttributes({[bo]:JSON.stringify(e)})}}}(t,s,n),n&&s.output_text&&t.setAttributes({[_o]:s.output_text}))}function ti(t,e){if("messages"in e){const n=qo(e.messages);t.setAttributes({[go]:n})}if("input"in e){const n=qo(e.input);t.setAttributes({[go]:n})}}function ei(t,e,n,r){return function(...s){return p(this,null,(function*(){const o=r||function(){var t,e,n,r;const s=qt().getClient(),o=null==s?void 0:s.getIntegrationByName("OpenAI"),i=!!o&&Boolean(null==s?void 0:s.getOptions().sendDefaultPii);return{recordInputs:null!=(e=null==(t=null==o?void 0:o.options)?void 0:t.recordInputs)?e:i,recordOutputs:null!=(r=null==(n=null==o?void 0:o.options)?void 0:n.recordOutputs)?r:i}}(),i=function(t,e){var n;const r={[Qs]:"openai",[mo]:Ho(e),[Yt]:"auto.ai.openai"};if(t.length>0&&"object"==typeof t[0]&&null!==t[0]){const e=t[0],n=[...Array.isArray(e.tools)?e.tools:[],...e.web_search_options&&"object"==typeof e.web_search_options?[c({type:"web_search_options"},e.web_search_options)]:[]];n.length>0&&(r[yo]=JSON.stringify(n))}if(t.length>0&&"object"==typeof t[0]&&null!==t[0]){const e=t[0];r[to]=null!=(n=e.model)?n:"unknown","temperature"in e&&(r[no]=e.temperature),"top_p"in e&&(r[io]=e.top_p),"frequency_penalty"in e&&(r[so]=e.frequency_penalty),"presence_penalty"in e&&(r[oo]=e.presence_penalty),"stream"in e&&(r[eo]=e.stream),"encoding_format"in e&&(r["gen_ai.request.encoding_format"]=e.encoding_format),"dimensions"in e&&(r["gen_ai.request.dimensions"]=e.dimensions)}else r[to]="unknown";return r}(s,e),a=i[to]||"unknown",u=Ho(e),l=s[0];return l&&"object"==typeof l&&!0===l.stream?vn({name:`${u} ${a} stream-response`,op:Wo(e),attributes:i},(r=>p(null,null,(function*(){var i;try{o.recordInputs&&s[0]&&"object"==typeof s[0]&&ti(r,s[0]);return function(t,e,n){return f(this,null,(function*(){const r={eventTypes:[],responseTexts:[],finishReasons:[],responseId:"",responseModel:"",responseTimestamp:0,promptTokens:void 0,completionTokens:void 0,totalTokens:void 0,chatCompletionToolCalls:{},responsesApiToolCalls:[]};try{try{for(var s,o,i,a=h(t);s=!(o=yield new d(a.next())).done;s=!1){const t=o.value;Go(t)?Zo(t,r,n):zo(t)&&Xo(t,r,n,e),yield t}}catch(o){i=[o]}finally{try{s&&(o=a.return)&&(yield new d(o.call(a)))}finally{if(i)throw i[0]}}}finally{Vo(e,r.responseId,r.responseModel,r.responseTimestamp),Ko(e,r.promptTokens,r.completionTokens,r.totalTokens),e.setAttributes({[vo]:!0}),r.finishReasons.length&&e.setAttributes({[co]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length&&e.setAttributes({[_o]:r.responseTexts.join("")});const t=[...Object.values(r.chatCompletionToolCalls),...r.responsesApiToolCalls];t.length>0&&e.setAttributes({[bo]:JSON.stringify(t)}),e.end()}}))}(yield t.apply(n,s),r,null!=(i=o.recordOutputs)&&i)}catch(a){throw r.setStatus({code:2,message:"internal_error"}),Hn(a,{mechanism:{handled:!1,type:"auto.ai.openai.stream",data:{function:e}}}),r.end(),a}})))):yn({name:`${u} ${a}`,op:Wo(e),attributes:i},(r=>p(null,null,(function*(){try{o.recordInputs&&s[0]&&"object"==typeof s[0]&&ti(r,s[0]);const e=yield t.apply(n,s);return Qo(r,e,o.recordOutputs),e}catch(i){throw Hn(i,{mechanism:{handled:!1,type:"auto.ai.openai",data:{function:e}}}),i}}))))}))}}function ni(t,e="",n){return new Proxy(t,{get(t,r){const s=t[r],o=function(t,e){return t?`${t}.${e}`:e}(e,String(r));return"function"==typeof s&&function(t){return Bo.includes(t)}(o)?ei(s,o,t,n):"function"==typeof s?s.bind(t):s&&"object"==typeof s?ni(s,o,n):s}})}function ri(t,e){return ni(t,"",e)}function si(t,e,n,r){if(!t||"object"!=typeof t)return;const s=function(t,e){var n,r;return"type"in t&&"string"==typeof t.type&&"error"===t.type&&(e.setStatus({code:2,message:null!=(r=null==(n=t.error)?void 0:n.type)?r:"internal_error"}),Hn(t.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}),!0)}(t,r);s||(function(t,e){if("message_delta"===t.type&&t.usage&&"output_tokens"in t.usage&&"number"==typeof t.usage.output_tokens&&(e.completionTokens=t.usage.output_tokens),t.message){const n=t.message;n.id&&(e.responseId=n.id),n.model&&(e.responseModel=n.model),n.stop_reason&&e.finishReasons.push(n.stop_reason),n.usage&&("number"==typeof n.usage.input_tokens&&(e.promptTokens=n.usage.input_tokens),"number"==typeof n.usage.cache_creation_input_tokens&&(e.cacheCreationInputTokens=n.usage.cache_creation_input_tokens),"number"==typeof n.usage.cache_read_input_tokens&&(e.cacheReadInputTokens=n.usage.cache_read_input_tokens))}}(t,e),function(t,e){"content_block_start"===t.type&&"number"==typeof t.index&&t.content_block&&("tool_use"!==t.content_block.type&&"server_tool_use"!==t.content_block.type||(e.activeToolBlocks[t.index]={id:t.content_block.id,name:t.content_block.name,inputJsonParts:[]}))}(t,e),function(t,e,n){if("content_block_delta"===t.type&&t.delta){if("number"==typeof t.index&&"partial_json"in t.delta&&"string"==typeof t.delta.partial_json){const n=e.activeToolBlocks[t.index];n&&n.inputJsonParts.push(t.delta.partial_json)}n&&"string"==typeof t.delta.text&&e.responseTexts.push(t.delta.text)}}(t,e,n),function(t,e){if("content_block_stop"!==t.type||"number"!=typeof t.index)return;const n=e.activeToolBlocks[t.index];if(!n)return;const r=n.inputJsonParts.join("");let s;try{s=r?JSON.parse(r):{}}catch(o){s={__unparsed:r}}e.toolCalls.push({type:"tool_use",id:n.id,name:n.name,input:s}),delete e.activeToolBlocks[t.index]}(t,e))}function oi(t,e,n){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};return t.on("streamEvent",(t=>{si(t,r,n,e)})),t.on("message",(()=>{!function(t,e,n){e.isRecording()&&(t.responseId&&e.setAttributes({[lo]:t.responseId}),t.responseModel&&e.setAttributes({[uo]:t.responseModel}),Uo(e,t.promptTokens,t.completionTokens,t.cacheCreationInputTokens,t.cacheReadInputTokens),e.setAttributes({[vo]:!0}),t.finishReasons.length>0&&e.setAttributes({[co]:JSON.stringify(t.finishReasons)}),n&&t.responseTexts.length>0&&e.setAttributes({[_o]:t.responseTexts.join("")}),n&&t.toolCalls.length>0&&e.setAttributes({[bo]:JSON.stringify(t.toolCalls)}),e.end())}(r,e,n)})),t.on("error",(t=>{Hn(t,{mechanism:{handled:!1,type:"auto.ai.anthropic.stream_error"}}),e.isRecording()&&(e.setStatus({code:2,message:"stream_error"}),e.end())})),t}const ii=["messages.create","messages.stream","messages.countTokens","models.get","completions.create","models.retrieve","beta.messages.create"];function ai(t,e){if("messages"in e){const n=qo(e.messages);t.setAttributes({[go]:n})}if("input"in e){const n=qo(e.input);t.setAttributes({[go]:n})}"prompt"in e&&t.setAttributes({[Xs]:JSON.stringify(e.prompt)})}function ci(t,e,n){e&&"object"==typeof e&&("type"in e&&"error"===e.type?function(t,e){e.error&&(t.setStatus({code:2,message:e.error.type||"internal_error"}),Hn(e.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}))}(t,e):(n&&function(t,e){if("content"in e&&Array.isArray(e.content)){t.setAttributes({[_o]:e.content.map((t=>t.text)).filter((t=>!!t)).join("")});const n=[];for(const t of e.content)"tool_use"!==t.type&&"server_tool_use"!==t.type||n.push(t);n.length>0&&t.setAttributes({[bo]:JSON.stringify(n)})}"completion"in e&&t.setAttributes({[_o]:e.completion}),"input_tokens"in e&&t.setAttributes({[_o]:JSON.stringify(e.input_tokens)})}(t,e),function(t,e){"id"in e&&"model"in e&&(t.setAttributes({[lo]:e.id,[uo]:e.model}),"created"in e&&"number"==typeof e.created&&t.setAttributes({[Co]:new Date(1e3*e.created).toISOString()}),"created_at"in e&&"number"==typeof e.created_at&&t.setAttributes({[Co]:new Date(1e3*e.created_at).toISOString()}),"usage"in e&&e.usage&&Uo(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.cache_creation_input_tokens,e.usage.cache_read_input_tokens))}(t,e)))}function ui(t,e,n){throw Hn(t,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:n}}}),e.isRecording()&&(e.setStatus({code:2,message:"internal_error"}),e.end()),t}function li(t,e,n,r,s,o,i,a,c,u,l){var m;const g={name:`${o} ${null!=(m=s[to])?m:"unknown"} stream-response`,op:Lo(i),attributes:s};return vn(g,u&&!l?e=>p(null,null,(function*(){var s;try{c.recordInputs&&a&&ai(e,a);return function(t,e,n){return f(this,null,(function*(){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};try{try{for(var s,o,i,a=h(t);s=!(o=yield new d(a.next())).done;s=!1){const t=o.value;si(t,r,n,e),yield t}}catch(o){i=[o]}finally{try{s&&(o=a.return)&&(yield new d(o.call(a)))}finally{if(i)throw i[0]}}}finally{r.responseId&&e.setAttributes({[lo]:r.responseId}),r.responseModel&&e.setAttributes({[uo]:r.responseModel}),Uo(e,r.promptTokens,r.completionTokens,r.cacheCreationInputTokens,r.cacheReadInputTokens),e.setAttributes({[vo]:!0}),r.finishReasons.length>0&&e.setAttributes({[co]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length>0&&e.setAttributes({[_o]:r.responseTexts.join("")}),n&&r.toolCalls.length>0&&e.setAttributes({[bo]:JSON.stringify(r.toolCalls)}),e.end()}}))}(yield t.apply(n,r),e,null!=(s=c.recordOutputs)&&s)}catch(o){return ui(o,e,i)}})):t=>{var s;try{c.recordInputs&&a&&ai(t,a);return oi(e.apply(n,r),t,null!=(s=c.recordOutputs)&&s)}catch(o){return ui(o,t,i)}})}function pi(t,e,n,r){return new Proxy(t,{apply(s,o,i){var a;const c=function(t,e){var n;const r={[Qs]:"anthropic",[mo]:Do(e),[Yt]:"auto.ai.anthropic"};if(t.length>0&&"object"==typeof t[0]&&null!==t[0]){const e=t[0];e.tools&&Array.isArray(e.tools)&&(r[yo]=JSON.stringify(e.tools)),r[to]=null!=(n=e.model)?n:"unknown","temperature"in e&&(r[no]=e.temperature),"top_p"in e&&(r[io]=e.top_p),"stream"in e&&(r[eo]=e.stream),"top_k"in e&&(r[ao]=e.top_k),"frequency_penalty"in e&&(r[so]=e.frequency_penalty),"max_tokens"in e&&(r[ro]=e.max_tokens)}else r[to]="models.retrieve"===e||"models.get"===e?t[0]:"unknown";return r}(i,e),u=null!=(a=c[to])?a:"unknown",l=Do(e),p="object"==typeof i[0]?i[0]:void 0,d=Boolean(null==p?void 0:p.stream),f="messages.stream"===e;return d||f?li(t,s,n,i,c,l,e,p,r,d,f):yn({name:`${l} ${u}`,op:Lo(e),attributes:c},(t=>(r.recordInputs&&p&&ai(t,p),mn((()=>s.apply(n,i)),(t=>{Hn(t,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:e}}})}),(()=>{}),(e=>ci(t,e,r.recordOutputs))))))}})}function di(t,e="",n){return new Proxy(t,{get(t,r){const s=t[r],o=Fo(e,String(r));return"function"==typeof s&&function(t){return ii.includes(t)}(o)?pi(s,o,t,n):"function"==typeof s?s.bind(t):s&&"object"==typeof s?di(s,o,n):s}})}function fi(t,e){var n;const r=Boolean(null==(n=Wt())?void 0:n.getOptions().sendDefaultPii);return di(t,"",c({recordInputs:r,recordOutputs:r},e))}const hi=["models.generateContent","models.generateContentStream","chats.create","sendMessage","sendMessageStream"],mi="chats.create";function gi(t,e,n,r){t&&!function(t,e){var n;const r=null==t?void 0:t.promptFeedback;if(null==r?void 0:r.blockReason){const t=null!=(n=r.blockReasonMessage)?n:r.blockReason;return e.setStatus({code:2,message:`Content blocked: ${t}`}),Hn(`Content blocked: ${t}`,{mechanism:{handled:!1,type:"auto.ai.google_genai"}}),!0}return!1}(t,r)&&(function(t,e){"string"==typeof t.responseId&&(e.responseId=t.responseId),"string"==typeof t.modelVersion&&(e.responseModel=t.modelVersion);const n=t.usageMetadata;n&&("number"==typeof n.promptTokenCount&&(e.promptTokens=n.promptTokenCount),"number"==typeof n.candidatesTokenCount&&(e.completionTokens=n.candidatesTokenCount),"number"==typeof n.totalTokenCount&&(e.totalTokens=n.totalTokenCount))}(t,e),function(t,e,n){var r,s,o;Array.isArray(t.functionCalls)&&e.toolCalls.push(...t.functionCalls);for(const i of null!=(r=t.candidates)?r:[]){(null==i?void 0:i.finishReason)&&!e.finishReasons.includes(i.finishReason)&&e.finishReasons.push(i.finishReason);for(const t of null!=(o=null==(s=null==i?void 0:i.content)?void 0:s.parts)?o:[])n&&t.text&&e.responseTexts.push(t.text),t.functionCall&&e.toolCalls.push({type:"function",id:t.functionCall.id,name:t.functionCall.name,arguments:t.functionCall.args})}}(t,e,n))}function _i(t,e){if("model"in t&&"string"==typeof t.model)return t.model;if(e&&"object"==typeof e){const t=e;if("model"in t&&"string"==typeof t.model)return t.model;if("modelVersion"in t&&"string"==typeof t.modelVersion)return t.modelVersion}return"unknown"}function yi(t,e,n){const r={[Qs]:"google_genai",[mo]:Do(t),[Yt]:"auto.ai.google_genai"};if(e){if(r[to]=_i(e,n),"config"in e&&"object"==typeof e.config&&e.config){const t=e.config;if(Object.assign(r,function(t){const e={};return"temperature"in t&&"number"==typeof t.temperature&&(e[no]=t.temperature),"topP"in t&&"number"==typeof t.topP&&(e[io]=t.topP),"topK"in t&&"number"==typeof t.topK&&(e[ao]=t.topK),"maxOutputTokens"in t&&"number"==typeof t.maxOutputTokens&&(e[ro]=t.maxOutputTokens),"frequencyPenalty"in t&&"number"==typeof t.frequencyPenalty&&(e[so]=t.frequencyPenalty),"presencePenalty"in t&&"number"==typeof t.presencePenalty&&(e[oo]=t.presencePenalty),e}(t)),"tools"in t&&Array.isArray(t.tools)){const e=t.tools.flatMap((t=>t.functionDeclarations));r[yo]=JSON.stringify(e)}}}else r[to]=_i({},n);return r}function vi(t,e){if("contents"in e){const n=qo(e.contents);t.setAttributes({[go]:n})}if("message"in e){const n=qo(e.message);t.setAttributes({[go]:n})}if("history"in e){const n=qo(e.history);t.setAttributes({[go]:n})}}function bi(t,e,n,r){const s=e===mi;return new Proxy(t,{apply(t,o,i){var a;const c=i[0],u=yi(e,c,n),l=null!=(a=u[to])?a:"unknown",m=Do(e);return function(t){return t.includes("Stream")||t.endsWith("generateContentStream")||t.endsWith("sendMessageStream")}(e)?vn({name:`${m} ${l} stream-response`,op:Lo(e),attributes:u},(s=>p(null,null,(function*(){try{r.recordInputs&&c&&vi(s,c);return function(t,e,n){return f(this,null,(function*(){const r={responseTexts:[],finishReasons:[],toolCalls:[]};try{try{for(var s,o,i,a=h(t);s=!(o=yield new d(a.next())).done;s=!1){const t=o.value;gi(t,r,n,e),yield t}}catch(o){i=[o]}finally{try{s&&(o=a.return)&&(yield new d(o.call(a)))}finally{if(i)throw i[0]}}}finally{const t={[vo]:!0};r.responseId&&(t[lo]=r.responseId),r.responseModel&&(t[uo]=r.responseModel),void 0!==r.promptTokens&&(t[po]=r.promptTokens),void 0!==r.completionTokens&&(t[fo]=r.completionTokens),void 0!==r.totalTokens&&(t[ho]=r.totalTokens),r.finishReasons.length&&(t[co]=JSON.stringify(r.finishReasons)),n&&r.responseTexts.length&&(t[_o]=r.responseTexts.join("")),n&&r.toolCalls.length&&(t[bo]=JSON.stringify(r.toolCalls)),e.setAttributes(t),e.end()}}))}(yield t.apply(n,i),s,Boolean(r.recordOutputs))}catch(o){throw s.setStatus({code:2,message:"internal_error"}),Hn(o,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}}),s.end(),o}})))):yn({name:s?`${m} ${l} create`:`${m} ${l}`,op:Lo(e),attributes:u},(o=>(r.recordInputs&&c&&vi(o,c),mn((()=>t.apply(n,i)),(t=>{Hn(t,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}})}),(()=>{}),(t=>{s||function(t,e,n){if(e&&"object"==typeof e){if(e.usageMetadata&&"object"==typeof e.usageMetadata){const n=e.usageMetadata;"number"==typeof n.promptTokenCount&&t.setAttributes({[po]:n.promptTokenCount}),"number"==typeof n.candidatesTokenCount&&t.setAttributes({[fo]:n.candidatesTokenCount}),"number"==typeof n.totalTokenCount&&t.setAttributes({[ho]:n.totalTokenCount})}if(n&&Array.isArray(e.candidates)&&e.candidates.length>0){const n=e.candidates.map((t=>{var e;return(null==(e=t.content)?void 0:e.parts)&&Array.isArray(t.content.parts)?t.content.parts.map((t=>"string"==typeof t.text?t.text:"")).filter((t=>t.length>0)).join(""):""})).filter((t=>t.length>0));n.length>0&&t.setAttributes({[_o]:n.join("")})}if(n&&e.functionCalls){const n=e.functionCalls;Array.isArray(n)&&n.length>0&&t.setAttributes({[bo]:JSON.stringify(n)})}}}(o,t,r.recordOutputs)})))))}})}function Si(t,e="",n){return new Proxy(t,{get:(t,r,s)=>{const o=Reflect.get(t,r,s),i=Fo(e,String(r));if("function"==typeof o&&function(t){if(hi.includes(t))return!0;const e=t.split(".").pop();return hi.includes(e)}(i)){if(i===mi){const e=bi(o,i,t,n);return function(...t){const r=e(...t);return r&&"object"==typeof r?Si(r,"chat",n):r}}return bi(o,i,t,n)}return"function"==typeof o?o.bind(t):o&&"object"==typeof o?Si(o,i,n):o}})}function ki(t,e){var n;const r=Boolean(null==(n=Wt())?void 0:n.getOptions().sendDefaultPii);return Si(t,"",c({recordInputs:r,recordOutputs:r},e))}function xi(t){t(qt())}const Ti="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,wi="finishReason",Ei=["heartbeatFailed","idleTimeout","documentHidden"];let Ii;function Oi(t){Ii=t}function Ci(t){return t/1e3}class Ai{constructor(t=1e3){this.spans=[],this._maxlen=t}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}class $i{constructor(t){var e,n,r,s,o,i,a,u,l,p,d,f,h;if(this.name="",this.traceId=yt(),this.spanId=yt().substring(16),this.startTimestamp=Tt(),this.tags={},this.data={},this.attributes={},this.instrumenter="sentry",!t)return this;this.traceId=null!=(e=t.traceId)?e:this.traceId,this.spanId=null!=(n=t.spanId)?n:this.spanId,this.parentSpanId=null!=(r=t.parentSpanId)?r:this.parentSpanId,"sampled"in t&&(this.sampled=t.sampled),this.op=null!=(s=t.op)?s:this.op,this.description=null!=(i=null!=(o=t.description)?o:t.name)?i:this.description,this.name=null!=(u=null!=(a=t.name)?a:t.description)?u:this.name,this.data=t.data?c({},t.data):this.data,this.tags=t.tags?c({},t.tags):this.tags,this.attributes=t.attributes?c({},t.attributes):this.attributes,this.status=null!=(l=t.status)?l:this.status,this.startTimestamp=null!=(p=t.startTimestamp)?p:this.startTimestamp,this.endTimestamp=null!=(d=t.endTimestamp)?d:this.endTimestamp,this.instrumenter=null!=(f=t.instrumenter)?f:this.instrumenter,this.origin=null!=(h=t.origin)?h:this.origin}child(t){return this.startChild(t)}startChild(t){var e;const n=new $i(u(c({},t),{parentSpanId:this.spanId,sampled:this.sampled,attributes:null!=(e=null==t?void 0:t.attributes)?e:{},instrumenter:this.instrumenter,traceId:this.traceId}));return n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n),n.transaction=this.transaction,n}setTag(t,e){return this.tags=u(c({},this.tags),{[t]:e}),this}setData(t,e){return this.data=u(c({},this.data),{[t]:e}),this}setAttribute(t,e){return void 0===e?delete this.attributes[t]:this.attributes[t]=e,this}setAttributes(t){return Object.keys(t).forEach((e=>this.setAttribute(e,t[e]))),this}setStatus(t){var e;return this.status="string"==typeof t?t:null!=(e=t.message)?e:t.code,this}setHttpStatus(t){this.setTag("http.status_code",String(t));const e=function(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(t);return"unknown_error"!==e&&this.setStatus(e),this}addEvent(t,e,n){return this}addLink(t){return this}addLinks(t){return this}recordException(t){}isSuccess(){return"ok"===this.status}setName(t){this.name=t,this.description=t}updateName(t){return this.setName(t),this}end(t){this.finish(function(t){if(void 0===t)return Tt();if(Array.isArray(t)&&2===t.length){const[e,n]=t;return e+n/1e9}if(t instanceof Date)return t.getTime()/1e3;if("number"==typeof t)return t>1e12?Ci(t):t;return Tt()}(t))}finish(t){this.endTimestamp="number"==typeof t?t:Tt()}toTraceparent(){let t="";return void 0!==this.sampled&&(t=this.sampled?"-1":"-0"),`${this.traceId}-${this.spanId}${t}`}toContext(){return pt({data:this.data,description:this.description,attributes:this.attributes,name:this.name,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:"number"==typeof this.status?String(this.status):this.status,tags:this.tags,traceId:this.traceId})}updateWithContext(t){var e,n,r,s,o,i,a,c,u;return this.data=null!=(e=t.data)?e:{},this.description=null!=(n=t.description)?n:t.name,this.name=null!=(s=null!=(r=t.name)?r:t.description)?s:this.name,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=null!=(o=t.spanId)?o:this.spanId,this.startTimestamp=null!=(i=t.startTimestamp)?i:this.startTimestamp,this.status=t.status,this.tags=null!=(a=t.tags)?a:{},this.attributes=null!=(c=t.attributes)?c:this.attributes,this.traceId=null!=(u=t.traceId)?u:this.traceId,this}getTraceContext(){return pt({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:"number"==typeof this.status?String(this.status):this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})}toJSON(){return pt({data:Object.keys(this.data).length>0?this.data:{},description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:"number"==typeof this.status?String(this.status):this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId,origin:this.origin})}spanContext(){return{traceId:this.traceId,spanId:this.spanId,traceFlags:this.sampled?1:0}}isRecording(){return!1!==this.sampled&&void 0===this.endTimestamp}}class ji extends $i{constructor(t){super(t),this._measurements={},this._contexts={},this.name=t.name||"",this.metadata=c({source:"custom",spanMetadata:{}},t.metadata),this._trimEnd=t.trimEnd,this.transaction=this}setName(t){this.name=t}setContext(t,e){this._contexts[t]=e}setMeasurement(t,e,n=""){this._measurements[t]={value:e,unit:n}}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new Ai(t)),this.spanRecorder.add(this)}setMeasurements(t){this._measurements=c({},t)}setMetadata(t){this.metadata=c(c({},this.metadata),t)}getDynamicSamplingContext(){var t;return(null==(t=this.metadata)?void 0:t.dynamicSamplingContext)||{}}getProfileId(){}finish(t){if(void 0!==this.endTimestamp)return;if(this.name||(Ti&&C.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),super.finish(t),!0!==this.sampled)return void(Ti&&C.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."));const e=this.spanRecorder?this.spanRecorder.spans.filter((t=>t!==this&&t.endTimestamp)):[],n=e.map((t=>t.toJSON()));this._trimEnd&&e.length>0&&(this.endTimestamp=e.reduce(((t,e)=>t.endTimestamp&&e.endTimestamp?t.endTimestamp>e.endTimestamp?t:e:t)).endTimestamp);const r={contexts:c({trace:this.getTraceContext()},this._contexts),spans:n,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:this.metadata};return Object.keys(this._measurements).length>0&&(Ti&&C.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),r.measurements=this._measurements),Ti&&C.log(`[Tracing] Finishing ${this.op} transaction: ${this.name}.`),zn(r)}toContext(){const t=super.toContext();return pt(u(c({},t),{name:this.name,trimEnd:this._trimEnd}))}updateWithContext(t){var e;return super.updateWithContext(t),this.name=null!=(e=t.name)?e:"",this._trimEnd=t.trimEnd,this}}class Mi extends Ai{constructor(t,e,n="",r){super(r),this._pushActivity=t,this._popActivity=e,this.transactionSpanId=n}add(t){t.spanId!==this.transactionSpanId&&(t.finish=e=>{t.endTimestamp="number"==typeof e?e:Tt(),this._popActivity(t.spanId)},void 0===t.endTimestamp&&this._pushActivity(t.spanId)),super.add(t)}}class Pi extends ji{constructor(t,e=1e3,n=!1){super(t),this._idleTimeout=e,this._onScope=n,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._beforeFinishCallbacks=[],n&&(Ti&&C.log(`Setting idle transaction as active. Span ID: ${this.spanId}`),Oi(this)),this._initTimeout=setTimeout((()=>{this._finished||this.finish()}),this._idleTimeout)}finish(t=Tt()){if(this._finished=!0,this.activities={},this.spanRecorder){Ti&&C.log("[Tracing] finishing IdleTransaction",new Date(1e3*t).toISOString(),this.op);for(const e of this._beforeFinishCallbacks)e(this,t);this.spanRecorder.spans=this.spanRecorder.spans.filter((e=>{if(e.spanId===this.spanId)return!0;e.endTimestamp||(e.endTimestamp=t,e.setStatus("cancelled"),Ti&&C.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(e,void 0,2)));const n=e.startTimestamp<t;return n||Ti&&C.log("[Tracing] discarding Span since it happened after Transaction was finished",JSON.stringify(e,void 0,2)),n})),Ti&&C.log("[Tracing] flushing IdleTransaction")}else Ti&&C.log("[Tracing] No active IdleTransaction");return this._onScope&&Oi(void 0),super.finish(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){if(!this.spanRecorder){const e=t=>{this._finished||this._pushActivity(t)},n=t=>{this._finished||this._popActivity(t)};this.spanRecorder=new Mi(e,n,this.spanId,t),Ti&&C.log("Starting heartbeat"),this._pingHeartbeat()}this.spanRecorder.add(this)}_pushActivity(t){this._initTimeout&&(clearTimeout(this._initTimeout),this._initTimeout=void 0),Ti&&C.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,Ti&&C.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&(Ti&&C.log(`[Tracing] popActivity ${t}`),delete this.activities[t],Ti&&C.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){const t=this._idleTimeout,e=Tt()+t/1e3;setTimeout((()=>{this._finished||(this.setTag(wi,Ei[1]),this.finish(e))}),t)}}_beat(){if(this._finished)return;const t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter+=1:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?(Ti&&C.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this.setTag(wi,Ei[0]),this.finish()):this._pingHeartbeat()}_pingHeartbeat(){Ti&&C.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout((()=>{this._beat()}),5e3)}}let Ri,Ni;function Di(){return Ri||(Ri={traceId:Ct(),spanId:At(),sampleRand:Math.random()}),Ri}function Li(t){const e=Di();return Ri=c(c({},e),t),Ri}function Fi(t,e,n){const[r,s]=gn({tracesSampleRate:e.tracesSampleRate,tracesSampler:e.tracesSampler},n,Math.random());return t.sampled=r,t.sampled?(Ti&&C.log(`[Tracing] starting ${t.op} transaction - ${t.name}`),t):(Ti&&C.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(null!=s?s:0)})`),t)}function Ui(t,e,n){var r,s;const o=Wt(),i=o&&o.getOptions&&o.getOptions()||{},a=Bi(t,null!=(r=null==n?void 0:n.traceContinuityMode)?r:"off",null!=(s=null==n?void 0:n.consistentTraceSampling)&&s),l=a.name||a.op||"unknown-transaction",p=c({parentSampled:a.parentSampled,transactionContext:u(c({},a),{name:l}),name:l},e);let d=new ji(u(c({},a),{name:l}));if(d=Fi(d,i,p),d.sampled){const t=i._experiments&&i._experiments.maxSpans;d.initSpanRecorder(t),Oi(d)}return Li({traceId:d.traceId,spanId:d.spanId,sampled:d.sampled}),d}function qi(t,e,n,r,s){var o,i;const a=Wt(),l=a&&a.getOptions&&a.getOptions()||{},p=Bi(t,null!=(o=null==s?void 0:s.traceContinuityMode)?o:"off",null!=(i=null==s?void 0:s.consistentTraceSampling)&&i),d=p.name||p.op||"unknown-transaction",f=c({parentSampled:p.parentSampled,transactionContext:u(c({},p),{name:d}),name:d},r);let h=new Pi(u(c({},p),{name:d}),e,n);if(h=Fi(h,l,f),h.sampled){const t=l._experiments&&l._experiments.maxSpans;h.initSpanRecorder(t),Oi(h)}return Li({traceId:h.traceId,spanId:h.spanId,sampled:h.sampled}),h.registerBeforeFinishCallback((t=>{var e;const n=null!=(e=l.tracesSampleRate)?e:1,r=Di();!function(t,e,n,r,s,o){Ni={spanContext:{traceId:t,spanId:e,traceFlags:n?1:0},startTimestamp:r,sampleRate:s,sampleRand:o}}(t.traceId,t.spanId,t.sampled,t.startTimestamp,n,r.sampleRand),Ti&&C.log(`[Tracing] Updated previous trace info: traceId=${t.traceId}, spanId=${t.spanId}`)})),h}function Bi(t,e,n){if("off"===e)return t;const r=Di(),s=Ni,o=!!Ni&&Date.now()/1e3-Ni.startTimestamp<=3600;if("session"===e){const e=u(c({},t),{traceId:r.traceId});return n&&o&&s&&(e.parentSampled=1===s.spanContext.traceFlags),Ti&&C.log(`[Tracing] Session mode: reusing traceId=${r.traceId}`),e}if("link"===e){const e=function(t=!1){return Ri={traceId:t&&Ri?Ri.traceId:Ct(),spanId:At(),sampleRand:Math.random()},Ri}(!1),r=u(c({},t),{traceId:e.traceId});return n&&o&&s&&(r.parentSampled=1===s.spanContext.traceFlags),o&&s?(r.metadata=u(c({},r.metadata),{previousTrace:{traceId:s.spanContext.traceId,spanId:s.spanContext.spanId,sampled:1===s.spanContext.traceFlags}}),Ti&&C.log(`[Tracing] Link mode: new traceId=${e.traceId}, linked from previous traceId=${s.spanContext.traceId}`)):Ti&&C.log(`[Tracing] Link mode: new traceId=${e.traceId} (first trace)`),r}return t}const Ji="sentry.javascript.miniapp",Hi="10.27.0-rc.1",Wi="?",zi=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Gi=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,Ki=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Vi=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Yi=/\((\S*)(?::(\d+))(?::(\d+))\)/,Zi=/^\s*at (.*?) ?\((\S*):(\d+):(\d+)\)/i;function Xi(t){let e=null;const n=t&&t.framesToPop;try{if(e=function(t){if(!t||!t.stacktrace)return null;const e=t.stacktrace,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,s=e.split("\n"),o=[];let i;for(let a=0;a<s.length;a+=2){let t=null;(i=n.exec(s[a]))?t={url:i[2],func:i[3],args:[],line:+i[1],column:null}:(i=r.exec(s[a]))&&(t={url:i[6],func:i[3]||i[4],args:i[5]?i[5].split(","):[],line:+i[1],column:+i[2]}),t&&(!t.func&&t.line&&(t.func=Wi),o.push(t))}if(!o.length)return null;return{message:ta(t),name:t.name,stack:o}}(t),e)return Qi(e,n)}catch(r){}try{if(e=function(t){if(!t||!t.stack)return null;const e=[],n=t.stack.split("\n");let r,s,o,i;for(let a=0;a<n.length;++a){if(o=zi.exec(n[a])){const t=o[2]&&0===o[2].indexOf("native");r=o[2]&&0===o[2].indexOf("eval"),r&&(s=Yi.exec(o[2]))&&(o[2]=s[1],o[3]=s[2],o[4]=s[3]),i={url:o[2],func:o[1]||Wi,args:t?[o[2]]:[],line:o[3]?+o[3]:null,column:o[4]?+o[4]:null}}else if(o=Ki.exec(n[a]))i={url:o[2],func:o[1]||Wi,args:[],line:+o[3],column:o[4]?+o[4]:null};else if(o=Gi.exec(n[a]))r=o[3]&&o[3].indexOf(" > eval")>-1,r&&(s=Vi.exec(o[3]))?(o[1]=o[1]||"eval",o[3]=s[1],o[4]=s[2],o[5]=""):0!==a||o[5]||void 0===t.columnNumber||(e[0].column=t.columnNumber+1),i={url:o[3],func:o[1]||Wi,args:o[2]?o[2].split(","):[],line:o[4]?+o[4]:null,column:o[5]?+o[5]:null};else{if(!(o=Zi.exec(n[a])))continue;i={url:o[2],func:o[1]||Wi,args:[],line:o[3]?+o[3]:null,column:o[4]?+o[4]:null}}!i.func&&i.line&&(i.func=Wi),e.push(i)}if(!e.length)return null;return{message:ta(t),name:t.name,stack:e}}(t),e)return Qi(e,n)}catch(r){}return{message:ta(t),name:t&&t.name,stack:[],failed:!0}}function Qi(t,e){try{return u(c({},t),{stack:t.stack.slice(e)})}catch(n){return t}}function ta(t){const e=t&&t.message;return e?e.error&&"string"==typeof e.error.message?e.error.message:e:"No error message"}function ea(t){const e=ra(t.stack),n={type:t.name,value:t.message};return e&&e.length&&(n.stacktrace={frames:e}),void 0===n.type&&""===n.value&&(n.value="Unrecoverable error caught"),n}function na(t){return{exception:{values:[ea(t)]}}}function ra(t){if(!t||!t.length)return[];let e=t;const n=e[0].func||"",r=e[e.length-1].func||"";return-1===n.indexOf("captureMessage")&&-1===n.indexOf("captureException")||(e=e.slice(1)),-1!==r.indexOf("sentryWrapped")&&(e=e.slice(0,-1)),e.map((t=>({colno:null===t.column?void 0:t.column,filename:t.url||e[0].url,function:t.func||"?",in_app:!0,lineno:null===t.line?void 0:t.line}))).slice(0,100).reverse()}function sa(t,e,n={}){let r;if(H(t,"ErrorEvent")&&t.error){return r=na(Xi(t=t.error)),r}if(W(t)||function(t){return H(t,"DOMException")}(t)){const s=t,o=s.name||(W(s)?"DOMError":"DOMException"),i=s.message?`${o}: ${s.message}`:o;return r=oa(i,e,n),St(r,i),r}if(J(t))return r=na(Xi(t)),r;if(V(t)||Y(t)){return r=function(t,e,n){const r={exception:{values:[{type:Y(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:`Non-Error ${n?"promise rejection":"exception"} captured with keys: ${lt(t)}`}]},extra:{__serialized__:Ye(t)}};if(e){const t=ra(Xi(e).stack);r.stacktrace={frames:t}}return r}(t,e,n.rejection),kt(r,{synthetic:!0}),r}return r=oa(t,e,n),St(r,`${t}`),kt(r,{synthetic:!0}),r}function oa(t,e,n={}){const r={message:t};if(n.attachStacktrace&&e){const t=ra(Xi(e).stack);r.stacktrace={frames:t}}return r}const ia=(()=>{let t={request:()=>{},httpRequest:()=>{},getSystemInfoSync:()=>{},getPerformance:()=>({}),onAppHide:function(t){},canIUse:function(t){return!1}};if("object"==typeof wx)t=wx;else if("object"==typeof my)t=my;else if("object"==typeof tt)t=tt;else if("object"==typeof dd)t=dd;else if("object"==typeof qq)t=qq;else{if("object"!=typeof swan)throw new Error("sentry-miniapp ");t=swan}return t})(),aa=(()=>{let t="unknown";return"object"==typeof wx?t="wechat":"object"==typeof my?t="alipay":"object"==typeof tt?t="bytedance":"object"==typeof dd?t="dingtalk":"object"==typeof qq?t="qq":"object"==typeof swan&&(t="swan"),t})();function ca(t){return Tr(t,(function(e){return new $n(((n,r)=>{const s=ia.request||ia.httpRequest;"function"==typeof s?s({url:t.url,method:"POST",data:e.body,header:{"content-type":"application/json"},success(t){var e,r,s,o;n({statusCode:null==t?void 0:t.statusCode,headers:{"x-sentry-rate-limits":null!=(r=null==(e=null==t?void 0:t.headers)?void 0:e["X-Sentry-Rate-Limits"])?r:null,"retry-after":null!=(o=null==(s=null==t?void 0:t.headers)?void 0:s["Retry-After"])?o:null}})},fail(t){r(t)}}):r(new Error("Miniapp request function is not available"))}))}))}const ua=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,makeMiniappTransport:ca},Symbol.toStringTag,{value:"Module"})),la=()=>[];class pa extends Rr{constructor(t={}){const e=t.transport||ca,n=t.stackParser||la,r=t.integrations||t.defaultIntegrations||[],s=u(c({},t),{transport:e,stackParser:n,integrations:r,dsn:t.dsn,tracesSampleRate:t.tracesSampleRate});!function(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map((t=>({name:`${r}:@sentry/${t}`,version:v}))),version:v}),t._metadata=s}(s,"miniapp",["miniapp"]),super(s)}_prepareEvent(t,e,n,r){return t.platform=t.platform||"javascript",t.sdk=u(c({},t.sdk),{name:Ji,packages:[...t.sdk&&t.sdk.packages||[],{name:"npm:@sentry/miniapp",version:Hi}],version:Hi}),super._prepareEvent(t,e,n,r)}showReportDialog(t={}){console.log("sentry-miniapp ",t)}eventFromException(t,e){const n=sa(t,e&&e.syntheticException?e.syntheticException:void 0,{attachStacktrace:this._options.attachStacktrace});return e&&e.event_id&&(n.event_id=e.event_id),Promise.resolve(n)}eventFromMessage(t,e="info",n){const r=n&&n.syntheticException?n.syntheticException:void 0,s=oa(String(t),r,{attachStacktrace:this._options.attachStacktrace});return s.level=e,n&&n.event_id&&(s.event_id=n.event_id),Promise.resolve(s)}}function da(t,e={},n){if("function"!=typeof t)return t;try{const e=t.__sentry_wrapped__;if(e)return e;if(it(t))return t}catch(s){return t}const r=function(...n){try{const r=n.map((t=>da(t,e)));return t.handleEvent?t.handleEvent.apply(this,r):t.apply(this,r)}catch(r){throw setTimeout((()=>{})),Ht((t=>{t.addEventProcessor((t=>{const r=c({},t);return e.mechanism&&(St(r,void 0),kt(r,e.mechanism)),r.extra=u(c({},r.extra),{arguments:Ve(n,3)}),r})),Hn(r)})),r}};try{for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}catch(s){}ot(r,t),st(t,"__sentry_wrapped__",r);try{const e=Object.getOwnPropertyDescriptor(r,"name");(null==e?void 0:e.configurable)&&Object.defineProperty(r,"name",{get:()=>t.name})}catch(s){}return r}const fa=class t{constructor(e){this.name=t.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._onPageNotFoundHandlerInstalled=!1,this._onMemoryWarningHandlerInstalled=!1,this._options=c({onerror:!0,onunhandledrejection:!0,onpagenotfound:!0,onmemorywarning:!0},e)}setupOnce(){Error.stackTraceLimit=50,this._options.onerror&&(C.log("Global Handler attached: onError"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(C.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler()),this._options.onpagenotfound&&(C.log("Global Handler attached: onPageNotFound"),this._installGlobalOnPageNotFoundHandler()),this._options.onmemorywarning&&(C.log("Global Handler attached: onMemoryWarning"),this._installGlobalOnMemoryWarningHandler())}_installGlobalOnErrorHandler(){this._onErrorHandlerInstalled||(ia.onError&&ia.onError((t=>{Hn("string"==typeof t?new Error(t):t)})),this._onErrorHandlerInstalled=!0)}_installGlobalOnUnhandledRejectionHandler(){this._onUnhandledRejectionHandlerInstalled||(ia.onUnhandledRejection&&ia.onUnhandledRejection((({reason:t,promise:e})=>{Hn("string"==typeof t?new Error(t):t,{data:e})})),this._onUnhandledRejectionHandlerInstalled=!0)}_installGlobalOnPageNotFoundHandler(){this._onPageNotFoundHandlerInstalled||(ia.onPageNotFound&&ia.onPageNotFound((t=>{const e=t.path.split("?")[0];Zn("pagenotfound",e),Vn("message",JSON.stringify(t)),Wn(`: ${e}`)})),this._onPageNotFoundHandlerInstalled=!0)}_installGlobalOnMemoryWarningHandler(){this._onMemoryWarningHandlerInstalled||(ia.onMemoryWarning&&ia.onMemoryWarning((({level:t=-1})=>{let e="";switch(t){case 5:e="TRIM_MEMORY_RUNNING_MODERATE";break;case 10:e="TRIM_MEMORY_RUNNING_LOW";break;case 15:e="TRIM_MEMORY_RUNNING_CRITICAL";break;default:return}Zn("memory-warning",String(t)),Vn("message",e),Wn("")})),this._onMemoryWarningHandlerInstalled=!0)}};fa.id="GlobalHandlers";let ha=fa;const ma=class t{constructor(){this._ignoreOnError=0,this.name=t.id}_wrapTimeFunction(t){return function(...e){const n=e[0];return e[0]=da(n,{mechanism:{data:{function:_a(t)},handled:!0,type:"instrument"}}),t.apply(this,e)}}_wrapRAF(t){return function(e){return t(da(e,{mechanism:{data:{function:"requestAnimationFrame",handler:_a(t)},handled:!0,type:"instrument"}}))}}_wrapEventTarget(t){const e=y,n=e[t]&&e[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(rt(n,"addEventListener",(function(e){return function(n,r,s){try{"function"==typeof r.handleEvent&&(r.handleEvent=da(r.handleEvent.bind(r),{mechanism:{data:{function:"handleEvent",handler:_a(r),target:t},handled:!0,type:"instrument"}}))}catch(o){}return e.call(this,n,da(r,{mechanism:{data:{function:"addEventListener",handler:_a(r),target:t},handled:!0,type:"instrument"}}),s)}})),rt(n,"removeEventListener",(function(t){return function(e,n,r){let s=n;try{s=s&&(s.__sentry_wrapped__||s)}catch(o){}return t.call(this,e,s,r)}})))}setupOnce(){this._ignoreOnError=this._ignoreOnError;const t=y;rt(t,"setTimeout",this._wrapTimeFunction.bind(this)),rt(t,"setInterval",this._wrapTimeFunction.bind(this)),rt(t,"requestAnimationFrame",this._wrapRAF.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))}};ma.id="TryCatch";let ga=ma;function _a(t){try{return t&&t.name||"<anonymous>"}catch(e){return"<anonymous>"}}const ya=class t{constructor(e={}){this.name=t.id,this._key=e.key||"cause",this._limit=e.limit||5}setupOnce(){tr(((e,n)=>{const r=Wt(),s=r&&r.getIntegrationByName(t.id);return s?s._handler(e,n):e}))}_handler(t,e){if(!(t.exception&&t.exception.values&&e&&e.originalException instanceof Error))return t;const n=this._walkErrorTree(e.originalException,this._key);return t.exception.values=[...n,...t.exception.values],t}_walkErrorTree(t,e,n=[]){if(!(t[e]instanceof Error)||n.length+1>=this._limit)return n;const r=ea(Xi(t[e]));return this._walkErrorTree(t[e],e,[r,...n])}};ya.id="LinkedErrors";let va=ya;const ba=class t{constructor(){this.name=t.id}setupOnce(){tr((e=>{const n=Wt();if(n&&n.getIntegrationByName(t.id))try{const t=ia.getSystemInfoSync(),{SDKVersion:n="0.0.0",batteryLevel:r,currentBattery:s,battery:o,brand:i,language:a,model:l,pixelRatio:p,platform:d,screenHeight:f,screenWidth:h,system:m,version:g,app:_,appName:y}=t,[v,b]=m.split(" "),S=u(c({},e.tags),{SDKVersion:n}),k=_||y||aa||"app";return u(c({},e),{tags:S,contexts:u(c({},e.contexts),{device:{brand:i,battery_level:r||s||o,model:l,language:a,platform:d,screen_dpi:p,screen_height:f,screen_width:h},os:{name:v||m,version:b||m},browser:{name:k,version:g}})})}catch(r){console.warn(`sentry-miniapp get system info fail: ${r}`)}return e}))}};ba.id="System";let Sa=ba;const ka=class t{constructor(e){this.name=t.id,this._options=c({enable:!0},e)}setupOnce(){tr((e=>{const n=Wt();if(n&&n.getIntegrationByName(t.id)&&this._options.enable)try{const t=getCurrentPages().map((t=>({route:t.route,options:t.options})));return u(c({},e),{extra:u(c({},e.extra),{routers:t})})}catch(r){console.warn(`sentry-miniapp get router info fail: ${r}`)}return e}))}};ka.id="Router";let xa=ka;const Ta=class t{constructor(){this.name=t.id}setupOnce(){tr((e=>{const n=Wt();if(n&&n.getIntegrationByName(t.id)&&"wechat"===aa&&ia.getLaunchOptionsSync){if(1129===ia.getLaunchOptionsSync().scene)return null}return e}))}};Ta.id="IgnoreMpcrawlerErrors";let wa=Ta;const Ea=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,GlobalHandlers:ha,IgnoreMpcrawlerErrors:wa,LinkedErrors:va,Router:xa,System:Sa,TryCatch:ga},Symbol.toStringTag,{value:"Module"}));class Ia{constructor(t=!1){this._reportAllChanges=t,this._measurements={}}addPerformanceEntries(t){var e;const n=this._getPerformance();n&&(this._timeOrigin=this._getTimeOrigin(n,t),this._observer=null==(e=n.createObserver)?void 0:e.call(n,(e=>{var n;((null==(n=null==e?void 0:e.getEntries)?void 0:n.call(e))||[]).forEach((e=>this._handleEntry(t,e)))})),this._observer&&this._observer.observe({entryTypes:["navigation","render","script","loadPackage","resource"]}))}_getPerformance(){if(!ia.getPerformance)return;const t=ia.getPerformance();return t&&"function"==typeof t.createObserver?t:void 0}_getTimeOrigin(t,e){if("number"==typeof t.timeOrigin)return Ci(t.timeOrigin);const n="function"==typeof t.now?t.now():void 0;return"number"==typeof n?Ci(Date.now()-n):e.startTimestamp}_handleEntry(t,e){if(void 0!==t.endTimestamp)return void this._stopObserver();const n=this._toTimestamp(e.startTime,t.startTimestamp),r=this._toTimestamp(e.startTime+e.duration,t.startTimestamp);!function(t,e){var n=e,{startTimestamp:r}=n,s=l(n,["startTimestamp"]);r&&t.startTimestamp>r&&(t.startTimestamp=r);t.startChild(c({startTimestamp:r},s))}(t,{op:this._mapOp(e),description:this._getDescription(e),startTimestamp:n,endTimestamp:r,data:this._buildSpanData(e)}),this._recordMeasurements(e,t,n),t.setTag("sentry_reportAllChanges",this._reportAllChanges),Object.keys(this._measurements).length>0&&t.setMeasurements(this._measurements)}_mapOp(t){switch(t.entryType){case"navigation":return"navigation";case"render":return"ui.render";case"script":return"script";case"loadPackage":return"resource.package";case"resource":return"resource";default:return t.entryType||"custom"}}_getDescription(t){return t.path||t.moduleName||t.name}_buildSpanData(t){const e={entryType:t.entryType};return t.moduleName&&(e.moduleName=t.moduleName),t.path&&(e.path=t.path),"number"==typeof t.duration&&(e.duration=t.duration),e}_recordMeasurements(t,e,n){const r=(t.name||"").toLowerCase(),s=t.duration,o=Math.max(1e3*(n-e.startTimestamp),0);if("first-paint"===r||"firstpaint"===r?this._measurements.fp={value:o,unit:"millisecond"}:"first-contentful-paint"===r||"firstcontentfulpaint"===r?this._measurements.fcp={value:o,unit:"millisecond"}:"largest-contentful-paint"===r||"largestcontentfulpaint"===r||"lcp"===r?this._measurements.lcp={value:o,unit:"millisecond"}:"first-input-delay"!==r&&"firstinputdelay"!==r&&"fid"!==r||"number"!=typeof s?"navigation"!==t.entryType||"number"!=typeof s||this._measurements.navigation||(this._measurements.navigation={value:s,unit:"millisecond"}):this._measurements.fid={value:s,unit:"millisecond"},this._reportAllChanges&&"number"==typeof s){const e=this._measurementKey(t);e&&!this._measurements[e]&&(this._measurements[e]={value:s,unit:"millisecond"})}}_measurementKey(t){const e=t.name||t.entryType;if(e)return e.replace(/\s+/g,"_").toLowerCase()}_toTimestamp(t,e){var n;if(t>1e12)return Ci(t);return(null!=(n=this._timeOrigin)?n:e)+Ci(t)}_stopObserver(t){var e;null==(e=this._observer)||e.disconnect(),this._observer=void 0,t&&!t.endTimestamp&&t.finish()}}const Oa=c({idleTimeout:5e3,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,maxTransactionDuration:600,routingInstrumentation:function(t,e=!0,n=!0){const r=y,s=ia.onAppRoute||r.wx&&r.wx.onAppRoute;if("function"!=typeof s)return;let o,i=!1;const a=(r,s=!1)=>{const i=(null==r?void 0:r.path)||(null==r?void 0:r.route)||(null==r?void 0:r.url)||"",a="string"==typeof i&&i.length>0?i:"unknown-route";((r,s)=>{(s&&e||!s&&n)&&(o&&"function"==typeof o.finish&&o.finish(),o=t(r))})({name:a,op:"navigation",description:(null==r?void 0:r.openType)||(null==r?void 0:r.event)||void 0,metadata:{requestPath:a}},s)};if(e&&"function"==typeof r.getCurrentPages){const t=r.getCurrentPages()||[],e=t[t.length-1];e&&e.route&&(i=!0,a({path:e.route},!0))}s((t=>{const e=!i;i=!0,a(t,e)}))},traceContinuityMode:"link",consistentTraceSampling:!1},{traceRequest:!0}),Ca=class t{constructor(e){this.name=t.id,this._configuredIdleTimeout=null==e?void 0:e.idleTimeout,this.options=c(c({},Oa),e);const{_metricOptions:n}=this.options;this._metrics=new Ia(n&&n._reportAllChanges)}setupOnce(){var t;const{routingInstrumentation:e,startTransactionOnLocationChange:n,startTransactionOnPageLoad:r}=this.options;e((t=>this._createRouteTransaction(t)),r,n),null==(t=ia.onAppHide)||t.call(ia,(()=>{null==Ii||Ii.finish()}))}_createRouteTransaction(t){var e;const{beforeNavigate:n,idleTimeout:r,maxTransactionDuration:s,traceContinuityMode:o,consistentTraceSampling:i}=this.options,a=u(c({},t),{trimEnd:!0}),l="function"==typeof n?n(a):a;if(void 0===l)return;const p={traceContinuityMode:null!=o?o:"link",consistentTraceSampling:null!=i&&i};Ti&&C.log(`[MiniAppTracing] Creating route transaction with traceContinuityMode=${p.traceContinuityMode}`);const d=qi(l,r,!0,{},p);return d.registerBeforeFinishCallback(((t,e)=>{var n;!function(t,e,n){const r=n-e.startTimestamp,s=n&&(r>t||r<0);s&&(e.setStatus("deadline_exceeded"),e.setTag("maxTransactionDurationExceeded","true"))}((n=s,1e3*n),t,e)})),d.setTag("idleTimeout",null!=(e=this._configuredIdleTimeout)?e:r),d.setTag("traceContinuityMode",null!=o?o:"link"),this._metrics.addPerformanceEntries(d),d}};Ca.id="MiniAppTracing";let Aa=Ca;const $a=[ts(),Zr(),new ga,new ha,new va,new Sa,new xa,new wa,new Aa];function ja(t={}){void 0===t.defaultIntegrations&&(t.defaultIntegrations=$a),t.normalizeDepth=t.normalizeDepth||5;const e=c({integrations:t.integrations||t.defaultIntegrations||[],stackParser:t.stackParser||(()=>[]),transport:t.transport||ca},t);Jr(pa,e)}function Ma(t={}){t.eventId||(t.eventId=Qn());const e=Wt();e&&e.showReportDialog(t)}function Pa(){return Qn()}function Ra(t){const e=Wt();return e?e.flush(t):Cn(!1)}function Na(t){const e=Wt();return e?e.close(t):Cn(!1)}function Da(t){return da(t)()}export{Ea as Integrations,Aa as MiniAppTracing,pa as MiniappClient,Ji as SDK_NAME,Hi as SDK_VERSION,ua as Transports,Kr as addBreadcrumb,tr as addEventProcessor,ds as captureConsoleIntegration,zn as captureEvent,Hn as captureException,Wn as captureMessage,Na as close,xi as configureScope,Ws as consoleLoggingIntegration,Vs as createConsolaReporter,$a as defaultIntegrations,fs as extraErrorDataIntegration,Us as featureFlagsIntegration,Ra as flush,Pe as getActiveSpan,qt as getCurrentScope,Me as getRootSpan,je as getSpanDescendants,ne as getSpanStatusFromHttpCode,ja as init,fi as instrumentAnthropicAiClient,ki as instrumentGoogleGenAIClient,ri as instrumentOpenAiClient,As as instrumentSupabaseClient,Pa as lastEventId,Bs as logger,Wr as makeMultiplexedTransport,Gs as metrics,cs as moduleMetadataIntegration,De as registerSpanErrorInstrumentation,vs as rewriteFramesIntegration,Gn as setContext,Vn as setExtra,Kn as setExtras,re as setHttpStatus,ln as setMeasurement,Zn as setTag,Yn as setTags,Xn as setUser,Ma as showReportDialog,bn as startInactiveSpan,kn as startNewTrace,yn as startSpan,vn as startSpanManual,Ui as startTransaction,$s as supabaseIntegration,Ns as thirdPartyErrorFilterIntegration,Sn as withActiveSpan,Ht as withScope,Da as wrap,Rs as zodErrorsIntegration};
