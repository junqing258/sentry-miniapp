var t=Object.defineProperty,e=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),a=(e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,c=(t,e)=>{for(var n in e||(e={}))o.call(e,n)&&a(t,n,e[n]);if(r)for(var n of r(e))s.call(e,n)&&a(t,n,e[n]);return t},u=(t,r)=>e(t,n(r)),l=(t,e)=>{var n={};for(var i in t)o.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&r)for(var i of r(t))e.indexOf(i)<0&&s.call(t,i)&&(n[i]=t[i]);return n},p=(t,e,n)=>new Promise(((r,o)=>{var s=t=>{try{a(n.next(t))}catch(e){o(e)}},i=t=>{try{a(n.throw(t))}catch(e){o(e)}},a=t=>t.done?r(t.value):Promise.resolve(t.value).then(s,i);a((n=n.apply(t,e)).next())})),d=function(t,e){this[0]=t,this[1]=e},f=(t,e,n)=>{var r=(t,e,o,s)=>{try{var i=n[t](e),a=(e=i.value)instanceof d,c=i.done;Promise.resolve(a?e[0]:e).then((n=>a?r("return"===t?t:"next",e[1]?{done:n.done,value:n.value}:n,o,s):o({value:n,done:c}))).catch((t=>r("throw",t,o,s)))}catch(u){s(u)}},o=t=>s[t]=e=>new Promise(((n,o)=>r(t,e,n,o))),s={};return n=n.apply(t,e),s[i("asyncIterator")]=()=>s,o("next"),o("throw"),o("return"),s},m=(t,e,n)=>(e=t[i("asyncIterator")])?e.call(t):(t=t[i("iterator")](),e={},(n=(n,r)=>(r=t[n])&&(e[n]=e=>new Promise(((n,o,s)=>(e=r.call(t,e),s=e.done,Promise.resolve(e.value).then((t=>n({value:t,done:s})),o))))))("next"),n("return"),e);const h="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof window&&window||"undefined"!=typeof global&&global||{};class g{constructor(t){if(this._entries=[],t)if("string"!=typeof t)Array.isArray(t)?t.forEach((([t,e])=>this.append(t,e))):Object.keys(t).forEach((e=>{const n=t[e];null!=n&&this.append(e,String(n))}));else{const e=t.startsWith("?")?t.slice(1):t;e.length>0&&e.split("&").forEach((t=>{if(!t)return;const[e,n=""]=t.split("=");this.append(decodeURIComponent(e),decodeURIComponent(n))}))}}append(t,e){this._entries.push([t,e])}toString(){return this._entries.map((([t,e])=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&")}}h.URLSearchParams||(h.URLSearchParams=g);const _="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,y=globalThis,v="10.27.0";function b(){return S(y),y}function S(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||v,e[v]=e[v]||{}}function k(t,e,n=y){const r=n.__SENTRY__=n.__SENTRY__||{},o=r[v]=r[v]||{};return o[t]||(o[t]=e())}const x=["debug","info","warn","error","log","assert","trace"],w={};function E(t){if(!("console"in y))return t();const e=y.console,n={},r=Object.keys(w);r.forEach((t=>{const r=w[t];n[t]=e[t],e[t]=r}));try{return t()}finally{r.forEach((t=>{e[t]=n[t]}))}}function T(){return O().enabled}function I(t,...e){_&&T()&&E((()=>{y.console[t](`Sentry Logger [${t}]:`,...e)}))}function O(){return _?k("loggerSettings",(()=>({enabled:!1}))):{enabled:!1}}const A={enable:function(){O().enabled=!0},disable:function(){O().enabled=!1},isEnabled:T,log:function(...t){I("log",...t)},warn:function(...t){I("warn",...t)},error:function(...t){I("error",...t)}},$="<anonymous>";function C(t){try{return t&&"function"==typeof t&&t.name||$}catch(e){return $}}function j(t){return"__v_isVNode"in t&&t.__v_isVNode?"[VueVNode]":"[VueViewModel]"}const M={},P={};function N(t,e){M[t]=M[t]||[],M[t].push(e)}function R(t,e){if(!P[t]){P[t]=!0;try{e()}catch(n){_&&A.error(`Error while instrumenting ${t}`,n)}}}function D(t,e){const n=t&&M[t];if(n)for(const o of n)try{o(e)}catch(r){_&&A.error(`Error while triggering instrumentation handler.\nType: ${t}\nName: ${C(o)}\nError:`,r)}}let L=null;function F(){L=y.onerror,y.onerror=function(t,e,n,r,o){return D("error",{column:r,error:o,line:n,msg:t,url:e}),!!L&&L.apply(this,arguments)},y.onerror.__SENTRY_INSTRUMENTED__=!0}let U=null;function q(){U=y.onunhandledrejection,y.onunhandledrejection=function(t){return D("unhandledrejection",t),!U||U.apply(this,arguments)},y.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const B=Object.prototype.toString;function J(t){switch(B.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return X(t,Error)}}function H(t,e){return B.call(t)===`[object ${e}]`}function W(t){return H(t,"DOMError")}function z(t){return H(t,"String")}function G(t){return"object"==typeof t&&null!==t&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function K(t){return null===t||G(t)||"object"!=typeof t&&"function"!=typeof t}function V(t){return H(t,"Object")}function Y(t){return"undefined"!=typeof Event&&X(t,Event)}function Z(t){return Boolean((null==t?void 0:t.then)&&"function"==typeof t.then)}function X(t,e){try{return t instanceof e}catch(n){return!1}}function Q(t){return!("object"!=typeof t||null===t||!(t.__isVue||t._isVue||t.__v_isVNode))}const et=y;function nt(t,e){const n=t,r=[];if(!(null==n?void 0:n.tagName))return"";if(et.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const o=(null==e?void 0:e.length)?e.filter((t=>n.getAttribute(t))).map((t=>[t,n.getAttribute(t)])):null;if(null==o?void 0:o.length)o.forEach((t=>{r.push(`[${t[0]}="${t[1]}"]`)}));else{n.id&&r.push(`#${n.id}`);const t=n.className;if(t&&z(t)){const e=t.split(/\s+/);for(const t of e)r.push(`.${t}`)}}const s=["aria-label","type","name","title","alt"];for(const i of s){const t=n.getAttribute(i);t&&r.push(`[${i}="${t}"]`)}return r.join("")}function rt(t,e,n){if(!(e in t))return;const r=t[e];if("function"!=typeof r)return;const o=n(r);"function"==typeof o&&st(o,r);try{t[e]=o}catch(s){_&&A.log(`Failed to replace method "${e}" in object`,t)}}function ot(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch(r){_&&A.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function st(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,ot(t,"__sentry_original__",e)}catch(n){}}function it(t){return t.__sentry_original__}function at(t){if(J(t))return c({message:t.message,name:t.name,stack:t.stack},ut(t));if(Y(t)){const e=c({type:t.type,target:ct(t.target),currentTarget:ct(t.currentTarget)},ut(t));return"undefined"!=typeof CustomEvent&&X(t,CustomEvent)&&(e.detail=t.detail),e}return t}function ct(t){try{return e=t,"undefined"!=typeof Element&&X(e,Element)?function(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,o=[];let s=0,i=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,p=!Array.isArray(e)&&e.maxStringLength||80;for(;n&&s++<r&&(u=nt(n,l),!("html"===u||s>1&&i+o.length*c+u.length>=p));)o.push(u),i+=u.length,n=n.parentNode;return o.reverse().join(a)}catch(n){return"<unknown>"}}(t):Object.prototype.toString.call(t)}catch(n){return"<unknown>"}var e}function ut(t){if("object"==typeof t&&null!==t){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}return{}}function lt(t){const e=Object.keys(at(t));return e.sort(),e[0]?e.join(", "):"[object has no keys]"}function pt(t,e=0){return"string"!=typeof t||0===e||t.length<=e?t:`${t.slice(0,e)}...`}function dt(t,e){if(!Array.isArray(t))return"";const n=[];for(let o=0;o<t.length;o++){const e=t[o];try{Q(e)?n.push(j(e)):n.push(String(e))}catch(r){n.push("[value cannot be serialized]")}}return n.join(e)}function ft(t,e,n=!1){return!!z(t)&&(H(e,"RegExp")?e.test(t):!!z(e)&&(n?t===e:t.includes(e)))}function mt(t,e=[],n=!1){return e.some((e=>ft(t,e,n)))}let ht;function gt(t=function(){const t=y;return t.crypto||t.msCrypto}()){try{if(null==t?void 0:t.randomUUID)return t.randomUUID().replace(/-/g,"")}catch(e){}return ht||(ht="10000000100040008000100000000000"),ht.replace(/[018]/g,(t=>(t^(16*Math.random()&15)>>t/4).toString(16)))}function _t(t){var e,n;return null==(n=null==(e=t.exception)?void 0:e.values)?void 0:n[0]}function yt(t){const{message:e,event_id:n}=t;if(e)return e;const r=_t(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function vt(t,e,n){const r=t.exception=t.exception||{},o=r.values=r.values||[],s=o[0]=o[0]||{};s.value||(s.value=e||""),s.type||(s.type="Error")}function bt(t,e){const n=_t(t);if(!n)return;const r=n.mechanism;if(n.mechanism=c(c(c({},{type:"generic",handled:!0}),r),e),e&&"data"in e){const t=c(c({},null==r?void 0:r.data),e.data);n.mechanism.data=t}}function St(t){if(function(t){try{return t.__sentry_captured__}catch(e){}}(t))return!0;try{ot(t,"__sentry_captured__",!0)}catch(e){}return!1}function kt(){return Date.now()/1e3}let xt;function wt(){return(null!=xt?xt:xt=function(){const{performance:t}=y;if(!(null==t?void 0:t.now)||!t.timeOrigin)return kt;const e=t.timeOrigin;return()=>(e+t.now())/1e3}())()}function Et(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||wt(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=32===e.sid.length?e.sid:gt()),void 0!==e.init&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),"number"==typeof e.started&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if("number"==typeof e.duration)t.duration=e.duration;else{const e=t.timestamp-t.started;t.duration=e>=0?e:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),"number"==typeof e.errors&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Tt(t,e,n=2){if(!e||"object"!=typeof e||n<=0)return e;if(t&&0===Object.keys(e).length)return t;const r=c({},t);for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=Tt(r[o],e[o],n-1));return r}function It(){return gt()}function Ot(){return gt().substring(16)}const At="_sentrySpan";function $t(t,e){e?ot(t,At,e):delete t[At]}function Ct(t){return t[At]}class jt{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:It(),sampleRand:Math.random()}}clone(){const t=new jt;return t._breadcrumbs=[...this._breadcrumbs],t._tags=c({},this._tags),t._attributes=c({},this._attributes),t._extra=c({},this._extra),t._contexts=c({},this._contexts),this._contexts.flags&&(t._contexts.flags={values:[...this._contexts.flags.values]}),t._user=this._user,t._level=this._level,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._attachments=[...this._attachments],t._sdkProcessingMetadata=c({},this._sdkProcessingMetadata),t._propagationContext=c({},this._propagationContext),t._client=this._client,t._lastEventId=this._lastEventId,$t(t,Ct(this)),t}setClient(t){this._client=t}setLastEventId(t){this._lastEventId=t}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Et(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(t){return this._tags=c(c({},this._tags),t),this._notifyScopeListeners(),this}setTag(t,e){return this.setTags({[t]:e})}setAttributes(t){return this._attributes=c(c({},this._attributes),t),this._notifyScopeListeners(),this}setAttribute(t,e){return this.setAttributes({[t]:e})}removeAttribute(t){return t in this._attributes&&(delete this._attributes[t],this._notifyScopeListeners()),this}setExtras(t){return this._extra=c(c({},this._extra),t),this._notifyScopeListeners(),this}setExtra(t,e){return this._extra=u(c({},this._extra),{[t]:e}),this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,e){return null===e?delete this._contexts[t]:this._contexts[t]=e,this._notifyScopeListeners(),this}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;const e="function"==typeof t?t(this):t,n=e instanceof jt?e.getScopeData():V(e)?t:void 0,{tags:r,attributes:o,extra:s,user:i,contexts:a,level:u,fingerprint:l=[],propagationContext:p}=n||{};return this._tags=c(c({},this._tags),r),this._attributes=c(c({},this._attributes),o),this._extra=c(c({},this._extra),s),this._contexts=c(c({},this._contexts),a),i&&Object.keys(i).length&&(this._user=i),u&&(this._level=u),l.length&&(this._fingerprint=l),p&&(this._propagationContext=p),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,$t(this,void 0),this._attachments=[],this.setPropagationContext({traceId:It(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(t,e){var n;const r="number"==typeof e?e:100;if(r<=0)return this;const o=u(c({timestamp:kt()},t),{message:t.message?pt(t.message,2048):t.message});return this._breadcrumbs.push(o),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),null==(n=this._client)||n.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ct(this)}}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata=Tt(this._sdkProcessingMetadata,t,2),this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,e){const n=(null==e?void 0:e.event_id)||gt();if(!this._client)return _&&A.warn("No client configured on scope - will not capture exception!"),n;const r=new Error("Sentry syntheticException");return this._client.captureException(t,u(c({originalException:t,syntheticException:r},e),{event_id:n}),this),n}captureMessage(t,e,n){var r;const o=(null==n?void 0:n.event_id)||gt();if(!this._client)return _&&A.warn("No client configured on scope - will not capture message!"),o;const s=null!=(r=null==n?void 0:n.syntheticException)?r:new Error(t);return this._client.captureMessage(t,e,u(c({originalException:t,syntheticException:s},n),{event_id:o}),this),o}captureEvent(t,e){const n=(null==e?void 0:e.event_id)||gt();return this._client?(this._client.captureEvent(t,u(c({},e),{event_id:n}),this),n):(_&&A.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((t=>{t(this)})),this._notifyingListeners=!1)}}class Mt{constructor(t,e){let n,r;n=t||new jt,r=e||new jt,this._stack=[{scope:n}],this._isolationScope=r}withScope(t){const e=this._pushScope();let n;try{n=t(e)}catch(r){throw this._popScope(),r}return Z(n)?n.then((t=>(this._popScope(),t)),(t=>{throw this._popScope(),t})):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const t=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:t}),t}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function Pt(){const t=S(b());return t.stack=t.stack||new Mt(k("defaultCurrentScope",(()=>new jt)),k("defaultIsolationScope",(()=>new jt)))}function Nt(t){return Pt().withScope(t)}function Rt(t,e){const n=Pt();return n.withScope((()=>(n.getStackTop().scope=t,e(t))))}function Dt(t){return Pt().withScope((()=>t(Pt().getIsolationScope())))}function Lt(t){const e=S(t);return e.acs?e.acs:{withIsolationScope:Dt,withScope:Nt,withSetScope:Rt,withSetIsolationScope:(t,e)=>Dt(e),getCurrentScope:()=>Pt().getScope(),getIsolationScope:()=>Pt().getIsolationScope()}}function Ft(){return Lt(b()).getCurrentScope()}function Ut(){return Lt(b()).getIsolationScope()}function qt(){return k("globalScope",(()=>new jt))}function Bt(...t){const e=Lt(b());if(2===t.length){const[n,r]=t;return n?e.withSetScope(n,r):e.withScope(r)}return e.withScope(t[0])}function Jt(){return Ft().getClient()}function Ht(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:o}=e,s={trace_id:n,span_id:o||Ot()};return r&&(s.parent_span_id=r),s}const Wt="sentry.source",zt="sentry.sample_rate",Gt="sentry.op",Kt="sentry.origin",Vt="sentry.idle_span_finish_reason",Yt="sentry.measurement_unit",Zt="sentry.measurement_value",Xt="sentry.custom_span_name",Qt="sentry.profile_id",te="sentry.exclusive_time";function ee(t){if(t<400&&t>=100)return{code:1};if(t>=400&&t<500)switch(t){case 401:return{code:2,message:"unauthenticated"};case 403:return{code:2,message:"permission_denied"};case 404:return{code:2,message:"not_found"};case 409:return{code:2,message:"already_exists"};case 413:return{code:2,message:"failed_precondition"};case 429:return{code:2,message:"resource_exhausted"};case 499:return{code:2,message:"cancelled"};default:return{code:2,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:2,message:"unimplemented"};case 503:return{code:2,message:"unavailable"};case 504:return{code:2,message:"deadline_exceeded"};default:return{code:2,message:"internal_error"}}return{code:2,message:"internal_error"}}function ne(t,e){t.setAttribute("http.response.status_code",e);const n=ee(e);"unknown_error"!==n.message&&t.setStatus(n)}const re="_sentryScope",oe="_sentryIsolationScope";function se(t){if(t){if("object"==typeof t&&"deref"in t&&"function"==typeof t.deref)try{return t.deref()}catch(e){return}return t}}function ie(t,e,n){t&&(ot(t,oe,function(t){try{const e=y.WeakRef;if("function"==typeof e)return new e(t)}catch(e){}return t}(n)),ot(t,re,e))}function ae(t){const e=t;return{scope:e[re],isolationScope:se(e[oe])}}const ce=/^sentry-/;function ue(t){const e=function(t){if(!t||!z(t)&&!Array.isArray(t))return;if(Array.isArray(t))return t.reduce(((t,e)=>{const n=le(e);return Object.entries(n).forEach((([e,n])=>{t[e]=n})),t}),{});return le(t)}(t);if(!e)return;const n=Object.entries(e).reduce(((t,[e,n])=>{if(e.match(ce)){t[e.slice(7)]=n}return t}),{});return Object.keys(n).length>0?n:void 0}function le(t){return t.split(",").map((t=>{const e=t.indexOf("=");if(-1===e)return[];return[t.slice(0,e),t.slice(e+1)].map((t=>{try{return decodeURIComponent(t.trim())}catch(e){return}}))})).reduce(((t,[e,n])=>(e&&n&&(t[e]=n),t)),{})}const pe=/^o(\d+)\./,de=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function fe(t,e=!1){const{host:n,path:r,pass:o,port:s,projectId:i,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&o?`:${o}`:""}@${n}${s?`:${s}`:""}/${r?`${r}/`:r}${i}`}function me(t){const e=de.exec(t);if(!e)return void E((()=>{console.error(`Invalid Sentry Dsn: ${t}`)}));const[n,r,o="",s="",i="",a=""]=e.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const t=u.match(/^\d+/);t&&(u=t[0])}return he({host:s,pass:o,path:c,projectId:u,port:i,protocol:n,publicKey:r})}function he(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function ge(t){const e=t.getOptions(),{host:n}=t.getDsn()||{};let r;return e.orgId?r=String(e.orgId):n&&(r=function(t){const e=t.match(pe);return null==e?void 0:e[1]}(n)),r}function _e(t){const e="string"==typeof t?me(t):he(t);if(e&&function(t){if(!_)return!0;const{port:e,projectId:n,protocol:r}=t;return!(["protocol","publicKey","host","projectId"].find((e=>!t[e]&&(A.error(`Invalid Sentry Dsn: ${e} missing`),!0)))||(n.match(/^\d+$/)?function(t){return"http"===t||"https"===t}(r)?e&&isNaN(parseInt(e,10))&&(A.error(`Invalid Sentry Dsn: Invalid port ${e}`),1):(A.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),1):(A.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(e))return e}function ye(t){if("boolean"==typeof t)return Number(t);const e="string"==typeof t?parseFloat(t):t;return"number"!=typeof e||isNaN(e)||e<0||e>1?void 0:e}let ve=!1;function be(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:o,parent_span_id:s,status:i,origin:a,links:c}=Ee(t);return{parent_span_id:s,span_id:e,trace_id:n,data:r,op:o,status:i,origin:a,links:c}}function Se(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),o=r?e:Ee(t).parent_span_id,s=ae(t).scope;return{parent_span_id:o,span_id:r?(null==s?void 0:s.getPropagationContext().propagationSpanId)||Ot():e,trace_id:n}}function ke(t){return t&&t.length>0?t.map((t=>{var e=t,{context:n}=e,r=n,{spanId:o,traceId:s,traceFlags:i}=r,a=l(r,["spanId","traceId","traceFlags"]),{attributes:u}=e;return c({span_id:o,trace_id:s,sampled:1===i,attributes:u},a)})):void 0}function xe(t){return"number"==typeof t?we(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?we(t.getTime()):wt()}function we(t){return t>9999999999?t/1e3:t}function Ee(t){var e;if(function(t){return"function"==typeof t.getSpanJSON}(t))return t.getSpanJSON();const{spanId:n,traceId:r}=t.spanContext();if(function(t){const e=t;return!!(e.attributes&&e.startTime&&e.name&&e.endTime&&e.status)}(t)){const{attributes:o,startTime:s,name:i,endTime:a,status:c,links:u}=t;return{span_id:n,trace_id:r,data:o,description:i,parent_span_id:"parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?null==(e=t.parentSpanContext)?void 0:e.spanId:void 0,start_timestamp:xe(s),timestamp:xe(a)||void 0,status:Ie(c),op:o[Gt],origin:o[Kt],links:ke(u)}}return{span_id:n,trace_id:r,start_timestamp:0,data:{}}}function Te(t){const{traceFlags:e}=t.spanContext();return 1===e}function Ie(t){if(t&&0!==t.code)return 1===t.code?"ok":t.message||"internal_error"}const Oe="_sentryChildSpans",Ae="_sentryRootSpan";function $e(t,e){const n=t[Ae]||t;ot(e,Ae,n),t[Oe]?t[Oe].add(e):ot(t,Oe,/* @__PURE__ */new Set([e]))}function Ce(t){const e=/* @__PURE__ */new Set;return function t(n){if(!e.has(n)&&Te(n)){e.add(n);const r=n[Oe]?Array.from(n[Oe]):[];for(const e of r)t(e)}}(t),Array.from(e)}function je(t){return t[Ae]||t}function Me(){const t=Lt(b());return t.getActiveSpan?t.getActiveSpan():Ct(Ft())}function Pe(){ve||(E((()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")})),ve=!0)}let Ne=!1;function Re(){function t(){const t=Me(),e=t&&je(t);if(e){const t="internal_error";_&&A.log(`[Tracing] Root span: ${t} -> Global error occurred`),e.setStatus({code:2,message:t})}}Ne||(t.tag="sentry_tracingErrorCallback",Ne=!0,function(t){const e="error";N(e,t),R(e,F)}(t),function(t){const e="unhandledrejection";N(e,t),R(e,q)}(t))}function De(t){var e;if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;const n=t||(null==(e=Jt())?void 0:e.getOptions());return!(!n||null==n.tracesSampleRate&&!n.tracesSampler)}function Le(t){A.log(`Ignoring span ${t.op} - ${t.description} because it matches \`ignoreSpans\`.`)}function Fe(t,e){if(!(null==e?void 0:e.length)||!t.description)return!1;for(const r of e){if("string"==typeof(n=r)||n instanceof RegExp){if(ft(t.description,r))return _&&Le(t),!0;continue}if(!r.name&&!r.op)continue;const e=!r.name||ft(t.description,r.name),o=!r.op||t.op&&ft(t.op,r.op);if(e&&o)return _&&Le(t),!0}var n;return!1}function Ue(t,e){const n=e.parent_span_id,r=e.span_id;if(n)for(const o of t)o.parent_span_id===r&&(o.parent_span_id=n)}const qe="production",Be="_frozenDsc";function Je(t,e){ot(t,Be,e)}function He(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},o={environment:n.environment||qe,release:n.release,public_key:r,trace_id:t,org_id:ge(e)};return e.emit("createDsc",o),o}function We(t,e){const n=e.getPropagationContext();return n.dsc||He(n.traceId,t)}function ze(t){var e,n,r,o;const s=Jt();if(!s)return{};const i=je(t),a=Ee(i),c=a.data,u=i.spanContext().traceState,l=null!=(n=null!=(e=null==u?void 0:u.get("sentry.sample_rate"))?e:c[zt])?n:c["sentry.previous_trace_sample_rate"];function p(t){return"number"!=typeof l&&"string"!=typeof l||(t.sample_rate=`${l}`),t}const d=i[Be];if(d)return p(d);const f=null==u?void 0:u.get("sentry.dsc"),m=f&&ue(f);if(m)return p(m);const h=He(t.spanContext().traceId,s),g=c[Wt],_=a.description;return"url"!==g&&_&&(h.transaction=_),De()&&(h.sampled=String(Te(i)),h.sample_rand=null!=(o=null==u?void 0:u.get("sentry.sample_rand"))?o:null==(r=ae(i).scope)?void 0:r.getPropagationContext().sampleRand.toString()),p(h),s.emit("createDsc",h,i),h}class Ge{constructor(t={}){this._traceId=t.traceId||It(),this._spanId=t.spanId||Ot()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:0}}end(t){}setAttribute(t,e){return this}setAttributes(t){return this}setStatus(t){return this}updateName(t){return this}isRecording(){return!1}addEvent(t,e,n){return this}addLink(t){return this}addLinks(t){return this}recordException(t,e){}}function Ke(t,e=100,n=1/0){try{return Ye("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Ve(t,e=3,n=102400){const r=Ke(t,e);return o=r,function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(o))>n?Ve(t,e-1,n):r;var o}function Ye(t,e,n=1/0,r=1/0,o=function(){const t=/* @__PURE__ */new WeakSet;function e(e){return!!t.has(e)||(t.add(e),!1)}function n(e){t.delete(e)}return[e,n]}()){const[s,i]=o;if(null==e||["boolean","string"].includes(typeof e)||"number"==typeof e&&Number.isFinite(e))return e;const a=function(t,e){try{if("domain"===t&&e&&"object"==typeof e&&e._events)return"[Domain]";if("domainEmitter"===t)return"[DomainEmitter]";if("undefined"!=typeof global&&e===global)return"[Global]";if("undefined"!=typeof window&&e===window)return"[Window]";if("undefined"!=typeof document&&e===document)return"[Document]";if(Q(e))return j(e);if(V(n=e)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof e&&!Number.isFinite(e))return`[${e}]`;if("function"==typeof e)return`[Function: ${C(e)}]`;if("symbol"==typeof e)return`[${String(e)}]`;if("bigint"==typeof e)return`[BigInt: ${String(e)}]`;const r=function(t){const e=Object.getPrototypeOf(t);return(null==e?void 0:e.constructor)?e.constructor.name:"null prototype"}(e);return/^HTML(\w*)Element$/.test(r)?`[HTMLElement: ${r}]`:`[object ${r}]`}catch(r){return`**non-serializable** (${r})`}var n}(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c="number"==typeof e.__sentry_override_normalization_depth__?e.__sentry_override_normalization_depth__:n;if(0===c)return a.replace("object ","");if(s(e))return"[Circular ~]";const u=e;if(u&&"function"==typeof u.toJSON)try{return Ye("",u.toJSON(),c-1,r,o)}catch(f){}const l=Array.isArray(e)?[]:{};let p=0;const d=at(e);for(const m in d){if(!Object.prototype.hasOwnProperty.call(d,m))continue;if(p>=r){l[m]="[MaxProperties ~]";break}const t=d[m];l[m]=Ye(m,t,c-1,r,o),p++}return i(e),l}function Ze(t,e=[]){return[t,e]}function Xe(t,e){const[n,r]=t;return[n,[...r,e]]}function Qe(t,e){const n=t[1];for(const r of n){if(e(r,r[0].type))return!0}return!1}function tn(t){const e=S(y);return e.encodePolyfill?e.encodePolyfill(t):(new TextEncoder).encode(t)}function en(t){const[e,n]=t;let r=JSON.stringify(e);function o(t){"string"==typeof r?r="string"==typeof t?r+t:[tn(r),t]:r.push("string"==typeof t?tn(t):t)}for(const i of n){const[t,e]=i;if(o(`\n${JSON.stringify(t)}\n`),"string"==typeof e||e instanceof Uint8Array)o(e);else{let t;try{t=JSON.stringify(e)}catch(s){t=JSON.stringify(Ke(e))}o(t)}}return"string"==typeof r?r:function(t){const e=t.reduce(((t,e)=>t+e.length),0),n=new Uint8Array(e);let r=0;for(const o of t)n.set(o,r),r+=o.length;return n}(r)}function nn(t){return[{type:"span"},t]}function rn(t){const e="string"==typeof t.data?tn(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const on={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function sn(t){return on[t]}function an(t){if(!(null==t?void 0:t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function cn(t,e,n,r){const o=an(n),s=t.type&&"replay_event"!==t.type?t.type:"event";!function(t,e){var n,r,o,s;if(!e)return t;const i=t.sdk||{};t.sdk=u(c({},i),{name:i.name||e.name,version:i.version||e.version,integrations:[...(null==(n=t.sdk)?void 0:n.integrations)||[],...e.integrations||[]],packages:[...(null==(r=t.sdk)?void 0:r.packages)||[],...e.packages||[]],settings:(null==(o=t.sdk)?void 0:o.settings)||e.settings?c(c({},null==(s=t.sdk)?void 0:s.settings),e.settings):void 0})}(t,null==n?void 0:n.sdk);const i=function(t,e,n,r){var o;const s=null==(o=t.sdkProcessingMetadata)?void 0:o.dynamicSamplingContext;return c(c(c({event_id:t.event_id,sent_at:/* @__PURE__ */(new Date).toISOString()},e&&{sdk:e}),!!n&&r&&{dsn:fe(r)}),s&&{trace:s})}(t,o,r,e);delete t.sdkProcessingMetadata;return Ze(i,[[{type:s},t]])}function un(t,e,n,r=Me()){const o=r&&je(r);o&&(_&&A.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),o.addEvent(t,{[Zt]:e,[Yt]:n}))}function ln(t){if(!t||0===t.length)return;const e={};return t.forEach((t=>{const n=t.attributes||{},r=n[Yt],o=n[Zt];"string"==typeof r&&"number"==typeof o&&(e[t.name]={value:o,unit:r})})),e}class pn{constructor(t={}){this._traceId=t.traceId||It(),this._spanId=t.spanId||Ot(),this._startTime=t.startTimestamp||wt(),this._links=t.links,this._attributes={},this.setAttributes(c({[Kt]:"manual",[Gt]:t.op},t.attributes)),this._name=t.name,t.parentSpanId&&(this._parentSpanId=t.parentSpanId),"sampled"in t&&(this._sampled=t.sampled),t.endTimestamp&&(this._endTime=t.endTimestamp),this._events=[],this._isStandaloneSpan=t.isStandalone,this._endTime&&this._onSpanEnded()}addLink(t){return this._links?this._links.push(t):this._links=[t],this}addLinks(t){return this._links?this._links.push(...t):this._links=t,this}recordException(t,e){}spanContext(){const{_spanId:t,_traceId:e,_sampled:n}=this;return{spanId:t,traceId:e,traceFlags:n?1:0}}setAttribute(t,e){return void 0===e?delete this._attributes[t]:this._attributes[t]=e,this}setAttributes(t){return Object.keys(t).forEach((e=>this.setAttribute(e,t[e]))),this}updateStartTime(t){this._startTime=xe(t)}setStatus(t){return this._status=t,this}updateName(t){return this._name=t,this.setAttribute(Wt,"custom"),this}end(t){this._endTime||(this._endTime=xe(t),function(t){if(!_)return;const{description:e="< unknown name >",op:n="< unknown op >"}=Ee(t),{spanId:r}=t.spanContext(),o=`[Tracing] Finishing "${n}" ${je(t)===t?"root ":""}span "${e}" with ID ${r}`;A.log(o)}(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Gt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Ie(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Kt],profile_id:this._attributes[Qt],exclusive_time:this._attributes[te],measurements:ln(this._events),is_segment:this._isStandaloneSpan&&je(this)===this||void 0,segment_id:this._isStandaloneSpan?je(this).spanContext().spanId:void 0,links:ke(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(t,e,n){_&&A.log("[Tracing] Adding an event to span:",t);const r=dn(e)?e:n||wt(),o=dn(e)?{}:e||{},s={name:t,time:xe(r),attributes:o};return this._events.push(s),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const t=Jt();t&&t.emit("spanEnd",this);if(!(this._isStandaloneSpan||this===je(this)))return;if(this._isStandaloneSpan)return void(this._sampled?function(t){const e=Jt();if(!e)return;const n=t[1];if(!n||0===n.length)return void e.recordDroppedEvent("before_send","span");e.sendEnvelope(t)}(function(t,e){const n=ze(t[0]),r=null==e?void 0:e.getDsn(),o=null==e?void 0:e.getOptions().tunnel,s=c(c({sent_at:/* @__PURE__ */(new Date).toISOString()},!!(i=n).trace_id&&!!i.public_key&&{trace:n}),!!o&&r&&{dsn:fe(r)});var i;const{beforeSendSpan:a,ignoreSpans:u}=(null==e?void 0:e.getOptions())||{},l=(null==u?void 0:u.length)?t.filter((t=>!Fe(Ee(t),u))):t,p=t.length-l.length;p&&(null==e||e.recordDroppedEvent("before_send","span",p));const d=a?t=>{const e=Ee(t);return a(e)||(Pe(),e)}:Ee,f=[];for(const c of l){const t=d(c);t&&f.push(nn(t))}return Ze(s,f)}([this],t)):(_&&A.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),t&&t.recordDroppedEvent("sample_rate","span")));const e=this._convertSpanToTransaction();if(e){(ae(this).scope||Ft()).captureEvent(e)}}_convertSpanToTransaction(){var t;if(!fn(Ee(this)))return;this._name||(_&&A.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=ae(this),r=null==(t=null==e?void 0:e.getScopeData().sdkProcessingMetadata)?void 0:t.normalizedRequest;if(!0!==this._sampled)return;const o=Ce(this).filter((t=>t!==this&&!function(t){return t instanceof pn&&t.isStandaloneSpan()}(t))).map((t=>Ee(t))).filter(fn),s=this._attributes[Wt];delete this._attributes[Xt],o.forEach((t=>{delete t.data[Xt]}));const i=c({contexts:{trace:be(this)},spans:o.length>1e3?o.sort(((t,e)=>t.start_timestamp-e.start_timestamp)).slice(0,1e3):o,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:ze(this)},request:r},s&&{transaction_info:{source:s}}),a=ln(this._events);return a&&Object.keys(a).length&&(_&&A.log("[Measurements] Adding measurements to transaction event",JSON.stringify(a,void 0,2)),i.measurements=a),i}}function dn(t){return t&&"number"==typeof t||t instanceof Date||Array.isArray(t)}function fn(t){return!!(t.start_timestamp&&t.timestamp&&t.span_id&&t.trace_id)}function mn(t,e,n=()=>{},r=()=>{}){let o;try{o=t()}catch(s){throw e(s),n(),s}return function(t,e,n,r){if(Z(t))return t.then((t=>(n(),r(t),t)),(t=>{throw e(t),n(),t}));return n(),r(t),t}(o,e,n,r)}const hn="__SENTRY_SUPPRESS_TRACING__";function gn(t,e){const n=xn();if(n.startSpan)return n.startSpan(t,e);const r=kn(t),{forceTransaction:o,parentSpan:s,scope:i}=t;return Bt(null==i?void 0:i.clone(),(()=>Tn(s)((()=>{const n=Ft(),i=En(n,s),a=t.onlyIfParent&&!i?new Ge:Sn({parentSpan:i,spanArguments:r,forceTransaction:o,scope:n});return $t(n,a),mn((()=>e(a)),(()=>{const{status:t}=Ee(a);!a.isRecording()||t&&"ok"!==t||a.setStatus({code:2,message:"internal_error"})}),(()=>{a.end()}))}))))}function _n(t,e){const n=xn();if(n.startSpanManual)return n.startSpanManual(t,e);const r=kn(t),{forceTransaction:o,parentSpan:s,scope:i}=t;return Bt(null==i?void 0:i.clone(),(()=>Tn(s)((()=>{const n=Ft(),i=En(n,s),a=t.onlyIfParent&&!i?new Ge:Sn({parentSpan:i,spanArguments:r,forceTransaction:o,scope:n});return $t(n,a),mn((()=>e(a,(()=>a.end()))),(()=>{const{status:t}=Ee(a);!a.isRecording()||t&&"ok"!==t||a.setStatus({code:2,message:"internal_error"})}))}))))}function yn(t){const e=xn();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=kn(t),{forceTransaction:r,parentSpan:o}=t;return(t.scope?e=>Bt(t.scope,e):void 0!==o?t=>vn(o,t):t=>t())((()=>{const e=Ft(),s=En(e,o);return t.onlyIfParent&&!s?new Ge:Sn({parentSpan:s,spanArguments:n,forceTransaction:r,scope:e})}))}function vn(t,e){const n=xn();return n.withActiveSpan?n.withActiveSpan(t,e):Bt((n=>($t(n,t||void 0),e(n))))}function bn(t){return Bt((e=>(e.setPropagationContext({traceId:It(),sampleRand:Math.random()}),_&&A.log(`Starting a new trace with id ${e.getPropagationContext().traceId}`),vn(null,t))))}function Sn({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!De()){const r=new Ge;if(n||!t){Je(r,c({sampled:"false",sample_rate:"0",transaction:e.name},ze(r)))}return r}const o=Ut();let s;if(t&&!n)s=function(t,e,n){const{spanId:r,traceId:o}=t.spanContext(),s=!e.getScopeData().sdkProcessingMetadata[hn]&&Te(t),i=s?new pn(u(c({},n),{parentSpanId:r,traceId:o,sampled:s})):new Ge({traceId:o});$e(t,i);const a=Jt();a&&(a.emit("spanStart",i),n.endTimestamp&&a.emit("spanEnd",i));return i}(t,r,e),$e(t,s);else if(t){const n=ze(t),{traceId:o,spanId:i}=t.spanContext(),a=Te(t);s=wn(c({traceId:o,parentSpanId:i},e),r,a),Je(s,n)}else{const{traceId:t,dsc:n,parentSpanId:i,sampled:a}=c(c({},o.getPropagationContext()),r.getPropagationContext());s=wn(c({traceId:t,parentSpanId:i},e),r,a),n&&Je(s,n)}return function(t){if(!_)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=Ee(t),{spanId:o}=t.spanContext(),s=Te(t),i=je(t),a=i===t,c=`[Tracing] Starting ${s?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${o}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:t,description:e}=Ee(i);u.push(`root ID: ${i.spanContext().spanId}`),t&&u.push(`root op: ${t}`),e&&u.push(`root description: ${e}`)}A.log(`${c}\n  ${u.join("\n  ")}`)}(s),ie(s,r,o),s}function kn(t){const e=t.experimental||{},n=c({isStandalone:e.standalone},t);if(t.startTime){const e=c({},n);return e.startTimestamp=xe(t.startTime),delete e.startTime,e}return n}function xn(){return Lt(b())}function wn(t,e,n){var r,o;const s=Jt(),i=(null==s?void 0:s.getOptions())||{},{name:a=""}=t,l={spanAttributes:c({},t.attributes),spanName:a,parentSampled:n};null==s||s.emit("beforeSampling",l,{decision:!1});const p=null!=(r=l.parentSampled)?r:n,d=l.spanAttributes,f=e.getPropagationContext(),[m,h,g]=e.getScopeData().sdkProcessingMetadata[hn]?[!1]:function(t,e,n){if(!De(t))return[!1];let r,o;"function"==typeof t.tracesSampler?(o=t.tracesSampler(u(c({},e),{inheritOrSampleWith:t=>"number"==typeof e.parentSampleRate?e.parentSampleRate:"boolean"==typeof e.parentSampled?Number(e.parentSampled):t})),r=!0):void 0!==e.parentSampled?o=e.parentSampled:void 0!==t.tracesSampleRate&&(o=t.tracesSampleRate,r=!0);const s=ye(o);if(void 0===s)return _&&A.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(o)} of type ${JSON.stringify(typeof o)}.`),[!1];if(!s)return _&&A.log("[Tracing] Discarding transaction because "+("function"==typeof t.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0")),[!1,s,r];const i=n<s;return i||_&&A.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(o)})`),[i,s,r]}(i,{name:a,parentSampled:p,attributes:d,parentSampleRate:ye(null==(o=f.dsc)?void 0:o.sample_rate)},f.sampleRand),y=new pn(u(c({},t),{attributes:c({[Wt]:"custom",[zt]:void 0!==h&&g?h:void 0},d),sampled:m}));return!m&&s&&(_&&A.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),s.recordDroppedEvent("sample_rate","transaction")),s&&s.emit("spanStart",y),y}function En(t,e){if(e)return e;if(null===e)return;const n=Ct(t);if(!n)return;const r=Jt();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?je(n):n}function Tn(t){return void 0!==t?e=>vn(t,e):t=>t()}const In={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3};function On(t,e={}){const n=/* @__PURE__ */new Map;let r,o=!1,s="externalFinish",i=!e.disableAutoFinish;const a=[],{idleTimeout:u=In.idleTimeout,finalTimeout:l=In.finalTimeout,childSpanTimeout:p=In.childSpanTimeout,beforeSpanEnd:d,trimIdleSpanEndTimestamp:f=!0}=e,m=Jt();if(!m||!De()){const t=new Ge;return Je(t,c({sample_rate:"0",sampled:"false"},ze(t))),t}const h=Ft(),g=Me(),y=function(t){const e=yn(t);return $t(Ft(),e),_&&A.log("[Tracing] Started span is an idle span"),e}(t);function v(){r&&(clearTimeout(r),r=void 0)}function b(t){v(),r=setTimeout((()=>{!o&&0===n.size&&i&&(s="idleTimeout",y.end(t))}),u)}function S(t){r=setTimeout((()=>{!o&&i&&(s="heartbeatFailed",y.end(t))}),p)}function k(t){o=!0,n.clear(),a.forEach((t=>t())),$t(h,g);const e=Ee(y),{start_timestamp:r}=e;if(!r)return;e.data[Vt]||y.setAttribute(Vt,s);const i=e.status;i&&"unknown"!==i||y.setStatus({code:1}),A.log(`[Tracing] Idle span "${e.op}" finished`);const c=Ce(y).filter((t=>t!==y));let p=0;c.forEach((e=>{e.isRecording()&&(e.setStatus({code:2,message:"cancelled"}),e.end(t),_&&A.log("[Tracing] Cancelling span since span ended early",JSON.stringify(e,void 0,2)));const n=Ee(e),{timestamp:r=0,start_timestamp:o=0}=n,s=o<=t,i=r-o<=(l+u)/1e3;if(_){const t=JSON.stringify(e,void 0,2);s?i||A.log("[Tracing] Discarding span since it finished after idle span final timeout",t):A.log("[Tracing] Discarding span since it happened after idle span was finished",t)}i&&s||(!function(t,e){t[Oe]&&t[Oe].delete(e)}(y,e),p++)})),p>0&&y.setAttribute("sentry.idle_span_discarded_spans",p)}return y.end=new Proxy(y.end,{apply(t,e,n){if(d&&d(y),e instanceof Ge)return;const[r,...o]=n,s=xe(r||wt()),i=Ce(y).filter((t=>t!==y)),a=Ee(y);if(!i.length||!f)return k(s),Reflect.apply(t,e,[s,...o]);const c=m.getOptions().ignoreSpans,u=null==i?void 0:i.reduce(((t,e)=>{const n=Ee(e);return n.timestamp?c&&Fe(n,c)?t:t?Math.max(t,n.timestamp):n.timestamp:t}),void 0),p=a.start_timestamp,h=Math.min(p?p+l/1e3:1/0,Math.max(p||-1/0,Math.min(s,u||1/0)));return k(h),Reflect.apply(t,e,[h,...o])}}),a.push(m.on("spanStart",(t=>{if(o||t===y||Ee(t).timestamp||t instanceof pn&&t.isStandaloneSpan())return;var e;Ce(y).includes(t)&&(e=t.spanContext().spanId,v(),n.set(e,!0),S(wt()+p/1e3))}))),a.push(m.on("spanEnd",(t=>{var e;o||(e=t.spanContext().spanId,n.has(e)&&n.delete(e),0===n.size&&b(wt()+u/1e3))}))),a.push(m.on("idleSpanEnableAutoFinish",(t=>{t===y&&(i=!0,b(),n.size&&S())}))),e.disableAutoFinish||b(),setTimeout((()=>{o||(y.setStatus({code:2,message:"deadline_exceeded"}),s="finalTimeout",y.end())}),l),y}function An(t){return new Cn((e=>{e(t)}))}function $n(t){return new Cn(((e,n)=>{n(t)}))}class Cn{constructor(t){this._state=0,this._handlers=[],this._runExecutor(t)}then(t,e){return new Cn(((n,r)=>{this._handlers.push([!1,e=>{if(t)try{n(t(e))}catch(o){r(o)}else n(e)},t=>{if(e)try{n(e(t))}catch(o){r(o)}else r(t)}]),this._executeHandlers()}))}catch(t){return this.then((t=>t),t)}finally(t){return new Cn(((e,n)=>{let r,o;return this.then((e=>{o=!1,r=e,t&&t()}),(e=>{o=!0,r=e,t&&t()})).then((()=>{o?n(r):e(r)}))}))}_executeHandlers(){if(0===this._state)return;const t=this._handlers.slice();this._handlers=[],t.forEach((t=>{t[0]||(1===this._state&&t[1](this._value),2===this._state&&t[2](this._value),t[0]=!0)}))}_runExecutor(t){const e=(t,e)=>{0===this._state&&(Z(e)?e.then(n,r):(this._state=t,this._value=e,this._executeHandlers()))},n=t=>{e(1,t)},r=t=>{e(2,t)};try{t(n,r)}catch(o){r(o)}}}function jn(t,e,n,r=0){try{const o=Mn(e,n,t,r);return Z(o)?o:An(o)}catch(o){return $n(o)}}function Mn(t,e,n,r){const o=n[r];if(!t||!o)return t;const s=o(c({},t),e);return _&&null===s&&A.log(`Event processor "${o.id||"?"}" dropped event`),Z(s)?s.then((t=>Mn(t,e,n,r+1))):Mn(s,e,n,r+1)}function Pn(t,e){const{fingerprint:n,span:r,breadcrumbs:o,sdkProcessingMetadata:s}=e;!function(t,e){const{extra:n,tags:r,user:o,contexts:s,level:i,transactionName:a}=e;Object.keys(n).length&&(t.extra=c(c({},n),t.extra));Object.keys(r).length&&(t.tags=c(c({},r),t.tags));Object.keys(o).length&&(t.user=c(c({},o),t.user));Object.keys(s).length&&(t.contexts=c(c({},s),t.contexts));i&&(t.level=i);a&&"transaction"!==t.type&&(t.transaction=a)}(t,e),r&&function(t,e){t.contexts=c({trace:Se(e)},t.contexts),t.sdkProcessingMetadata=c({dynamicSamplingContext:ze(e)},t.sdkProcessingMetadata);const n=je(e),r=Ee(n).description;r&&!t.transaction&&"transaction"===t.type&&(t.transaction=r)}(t,r),function(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e));t.fingerprint.length||delete t.fingerprint}(t,n),function(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}(t,o),function(t,e){t.sdkProcessingMetadata=c(c({},t.sdkProcessingMetadata),e)}(t,s)}function Nn(t,e){const{extra:n,tags:r,user:o,contexts:s,level:i,sdkProcessingMetadata:a,breadcrumbs:u,fingerprint:l,eventProcessors:p,attachments:d,propagationContext:f,transactionName:m,span:h}=e;Rn(t,"extra",n),Rn(t,"tags",r),Rn(t,"user",o),Rn(t,"contexts",s),t.sdkProcessingMetadata=Tt(t.sdkProcessingMetadata,a,2),i&&(t.level=i),m&&(t.transactionName=m),h&&(t.span=h),u.length&&(t.breadcrumbs=[...t.breadcrumbs,...u]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),p.length&&(t.eventProcessors=[...t.eventProcessors,...p]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext=c(c({},t.propagationContext),f)}function Rn(t,e,n){t[e]=Tt(t[e],n,1)}let Dn,Ln,Fn,Un;function qn(t,e,n,r,o,s){const{normalizeDepth:i=3,normalizeMaxBreadth:a=1e3}=t,l=u(c({},e),{event_id:e.event_id||n.event_id||gt(),timestamp:e.timestamp||kt()}),p=n.integrations||t.integrations.map((t=>t.name));!function(t,e){var n,r;const{environment:o,release:s,dist:i,maxValueLength:a}=e;t.environment=t.environment||o||qe,!t.release&&s&&(t.release=s);!t.dist&&i&&(t.dist=i);const c=t.request;(null==c?void 0:c.url)&&a&&(c.url=pt(c.url,a));a&&(null==(r=null==(n=t.exception)?void 0:n.values)||r.forEach((t=>{t.value&&(t.value=pt(t.value,a))})))}(l,t),function(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}(l,p),o&&o.emit("applyFrameMetadata",e),void 0===e.type&&function(t,e){var n,r;const o=function(t){const e=y._sentryDebugIds,n=y._debugIds;if(!e&&!n)return{};const r=e?Object.keys(e):[],o=n?Object.keys(n):[];if(Un&&r.length===Ln&&o.length===Fn)return Un;Ln=r.length,Fn=o.length,Un={},Dn||(Dn={});const s=(e,n)=>{for(const r of e){const e=n[r],o=null==Dn?void 0:Dn[r];if(o&&Un&&e)Un[o[0]]=e,Dn&&(Dn[r]=[o[0],e]);else if(e){const n=t(r);for(let t=n.length-1;t>=0;t--){const o=n[t],s=null==o?void 0:o.filename;if(s&&Un&&Dn){Un[s]=e,Dn[r]=[s,e];break}}}}};return e&&s(r,e),n&&s(o,n),Un}(e);null==(r=null==(n=t.exception)?void 0:n.values)||r.forEach((t=>{var e,n;null==(n=null==(e=t.stacktrace)?void 0:e.frames)||n.forEach((t=>{t.filename&&(t.debug_id=o[t.filename])}))}))}(l,t.stackParser);const d=function(t,e){if(!e)return t;const n=t?t.clone():new jt;return n.update(e),n}(r,n.captureContext);n.mechanism&&bt(l,n.mechanism);const f=o?o.getEventProcessors():[],m=qt().getScopeData();if(s){Nn(m,s.getScopeData())}if(d){Nn(m,d.getScopeData())}const h=[...n.attachments||[],...m.attachments];h.length&&(n.attachments=h),Pn(l,m);return jn([...f,...m.eventProcessors],l,n).then((t=>(t&&function(t){var e,n;const r={};if(null==(n=null==(e=t.exception)?void 0:e.values)||n.forEach((t=>{var e,n;null==(n=null==(e=t.stacktrace)?void 0:e.frames)||n.forEach((t=>{t.debug_id&&(t.abs_path?r[t.abs_path]=t.debug_id:t.filename&&(r[t.filename]=t.debug_id),delete t.debug_id)}))})),0===Object.keys(r).length)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const o=t.debug_meta.images;Object.entries(r).forEach((([t,e])=>{o.push({type:"sourcemap",code_file:t,debug_id:e})}))}(t),"number"==typeof i&&i>0?function(t,e,n){var r,o;if(!t)return null;const s=c(c(c(c(c({},t),t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map((t=>c(c({},t),t.data&&{data:Ke(t.data,e,n)})))}),t.user&&{user:Ke(t.user,e,n)}),t.contexts&&{contexts:Ke(t.contexts,e,n)}),t.extra&&{extra:Ke(t.extra,e,n)});(null==(r=t.contexts)?void 0:r.trace)&&s.contexts&&(s.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(s.contexts.trace.data=Ke(t.contexts.trace.data,e,n)));t.spans&&(s.spans=t.spans.map((t=>c(c({},t),t.data&&{data:Ke(t.data,e,n)}))));(null==(o=t.contexts)?void 0:o.flags)&&s.contexts&&(s.contexts.flags=Ke(t.contexts.flags,3,n));return s}(t,i,a):t)))}function Bn(t){if(t)return function(t){return t instanceof jt||"function"==typeof t}(t)||function(t){return Object.keys(t).some((t=>Jn.includes(t)))}(t)?{captureContext:t}:t}const Jn=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function Hn(t,e){return Ft().captureException(t,Bn(e))}function Wn(t,e){const n="string"==typeof e?e:void 0,r="string"!=typeof e?{captureContext:e}:void 0;return Ft().captureMessage(t,n,r)}function zn(t,e){return Ft().captureEvent(t,e)}function Gn(t,e){Ut().setContext(t,e)}function Kn(t){Ut().setExtras(t)}function Vn(t,e){Ut().setExtra(t,e)}function Yn(t){Ut().setTags(t)}function Zn(t,e){Ut().setTag(t,e)}function Xn(t){Ut().setUser(t)}function Qn(){return Ut().lastEventId()}function tr(t){Ut().addEventProcessor(t)}function er(t,e,n){return e||`${function(t){return`${function(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}(t)}${t.projectId}/envelope/`}(t)}?${function(t,e){const n={sentry_version:"7"};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}(t,n)}`}const nr=[];function rr(t,e){for(const n of e)(null==n?void 0:n.afterAllSetup)&&n.afterAllSetup(t)}function or(t,e,n){if(n[e.name])_&&A.log(`Integration skipped because it was already installed: ${e.name}`);else{if(n[e.name]=e,nr.includes(e.name)||"function"!=typeof e.setupOnce||(e.setupOnce(),nr.push(e.name)),e.setup&&"function"==typeof e.setup&&e.setup(t),"function"==typeof e.preprocessEvent){const n=e.preprocessEvent.bind(e);t.on("preprocessEvent",((e,r)=>n(e,r,t)))}if("function"==typeof e.processEvent){const n=e.processEvent.bind(e),r=Object.assign(((e,r)=>n(e,r,t)),{id:e.name});t.addEventProcessor(r)}_&&A.log(`Integration installed: ${e.name}`)}}function sr(t,e){return e?Bt(e,(()=>{const n=Me(),r=n?Se(n):Ht(e);return[n?ze(n):We(t,e),r]})):[void 0,void 0]}const ir={trace:1,debug:5,info:9,warn:13,error:17,fatal:21};function ar(t,e,n,r=!0){!n||t[e]&&!r||(t[e]=n)}function cr(t,e){const n=dr(),r=pr(t);void 0===r?n.set(t,[e]):r.length>=100?(lr(t,r),n.set(t,[e])):n.set(t,[...r,e])}function ur(t,e=Ft(),n=cr){var r,o,s;const i=null!=(r=null==e?void 0:e.getClient())?r:Jt();if(!i)return void(_&&A.warn("No client available to capture log."));const{release:a,environment:l,enableLogs:p=!1,beforeSendLog:d}=i.getOptions();if(!p)return void(_&&A.warn("logging option not enabled, log will not be captured."));const[,f]=sr(i,e),m=c({},t.attributes),{user:{id:h,email:g,username:y}}=function(t){const e=qt().getScopeData();return Nn(e,Ut().getScopeData()),Nn(e,t.getScopeData()),e}(e);ar(m,"user.id",h,!1),ar(m,"user.email",g,!1),ar(m,"user.name",y,!1),ar(m,"sentry.release",a),ar(m,"sentry.environment",l);const{name:v,version:b}=null!=(s=null==(o=i.getSdkMetadata())?void 0:o.sdk)?s:{};ar(m,"sentry.sdk.name",v),ar(m,"sentry.sdk.version",b);const S=i.getIntegrationByName("Replay"),k=null==S?void 0:S.getReplayId(!0);ar(m,"sentry.replay_id",k),k&&"buffer"===(null==S?void 0:S.getRecordingMode())&&ar(m,"sentry._internal.replay_is_buffering",!0);const x=t.message;if(G(x)){const{__sentry_template_string__:t,__sentry_template_values__:e=[]}=x;(null==e?void 0:e.length)&&(m["sentry.message.template"]=t),e.forEach(((t,e)=>{m[`sentry.message.parameter.${e}`]=t}))}const w=Ct(e);ar(m,"sentry.trace.parent_span_id",null==w?void 0:w.spanContext().spanId);const T=u(c({},t),{attributes:m});i.emit("beforeCaptureLog",T);const I=d?E((()=>d(T))):T;if(!I)return i.recordDroppedEvent("before_send","log_item",1),void(_&&A.warn("beforeSendLog returned null, log will not be captured."));const{level:O,message:$,attributes:C={},severityNumber:j}=I,M={timestamp:wt(),level:O,body:$,trace_id:null==f?void 0:f.trace_id,severity_number:null!=j?j:ir[O],attributes:Object.keys(C).reduce(((t,e)=>(t[e]=function(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let r="";try{r=null!=(e=JSON.stringify(t))?e:""}catch(n){}return{value:r,type:"string"}}}}(C[e]),t)),{})};n(i,M),i.emit("afterCaptureLog",I)}function lr(t,e){var n;const r=null!=(n=null!=e?e:pr(t))?n:[];if(0===r.length)return;const o=t.getOptions(),s=function(t,e,n,r){const o={};return(null==e?void 0:e.sdk)&&(o.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(o.dsn=fe(r)),Ze(o,[(s=t,[{type:"log",item_count:s.length,content_type:"application/vnd.sentry.items.log+json"},{items:s}])]);var s}(r,o._metadata,o.tunnel,t.getDsn());dr().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function pr(t){return dr().get(t)}function dr(){return k("clientToLogBufferMap",(()=>/* @__PURE__ */new WeakMap))}function fr(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let r="";try{r=null!=(e=JSON.stringify(t))?e:""}catch(n){}return{value:r,type:"string"}}}}function mr(t,e,n,r=!0){!n||!r&&e in t||(t[e]=n)}function hr(t,e){const n=br(),r=vr(t);void 0===r?n.set(t,[e]):r.length>=1e3?(yr(t,r),n.set(t,[e])):n.set(t,[...r,e])}function gr(t,e,n){var r,o;const{release:s,environment:i}=e.getOptions(),a=c({},t.attributes),{user:{id:l,email:p,username:d}}=function(t){const e=qt().getScopeData();return Nn(e,Ut().getScopeData()),Nn(e,t.getScopeData()),e}(n);mr(a,"user.id",l,!1),mr(a,"user.email",p,!1),mr(a,"user.name",d,!1),mr(a,"sentry.release",s),mr(a,"sentry.environment",i);const{name:f,version:m}=null!=(o=null==(r=e.getSdkMetadata())?void 0:r.sdk)?o:{};mr(a,"sentry.sdk.name",f),mr(a,"sentry.sdk.version",m);const h=e.getIntegrationByName("Replay"),g=null==h?void 0:h.getReplayId(!0);return mr(a,"sentry.replay_id",g),g&&"buffer"===(null==h?void 0:h.getRecordingMode())&&mr(a,"sentry._internal.replay_is_buffering",!0),u(c({},t),{attributes:a})}function _r(t,e){var n,r,o,s;const i=null!=(n=null==e?void 0:e.scope)?n:Ft(),a=null!=(r=null==e?void 0:e.captureSerializedMetric)?r:hr,c=null!=(o=null==i?void 0:i.getClient())?o:Jt();if(!c)return void(_&&A.warn("No client available to capture metric."));const{_experiments:u,enableMetrics:l,beforeSendMetric:p}=c.getOptions();if(!(null==(s=null!=l?l:null==u?void 0:u.enableMetrics)||s))return void(_&&A.warn("metrics option not enabled, metric will not be captured."));const d=gr(t,c,i);c.emit("processMetric",d);const f=p||(null==u?void 0:u.beforeSendMetric),m=f?f(d):d;if(!m)return void(_&&A.log("`beforeSendMetric` returned `null`, will not send metric."));const h=function(t,e,n){const r={};for(const c in t.attributes)void 0!==t.attributes[c]&&(r[c]=fr(t.attributes[c]));const[,o]=sr(e,n),s=Ct(n),i=s?s.spanContext().traceId:null==o?void 0:o.trace_id,a=s?s.spanContext().spanId:void 0;return{timestamp:wt(),trace_id:null!=i?i:"",span_id:a,name:t.name,type:t.type,unit:t.unit,value:t.value,attributes:r}}(m,c,i);_&&A.log("[Metric]",h),a(c,h),c.emit("afterCaptureMetric",m)}function yr(t,e){var n;const r=null!=(n=null!=e?e:vr(t))?n:[];if(0===r.length)return;const o=t.getOptions(),s=function(t,e,n,r){const o={};return(null==e?void 0:e.sdk)&&(o.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(o.dsn=fe(r)),Ze(o,[(s=t,[{type:"trace_metric",item_count:s.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:s}])]);var s}(r,o._metadata,o.tunnel,t.getDsn());br().set(t,[]),t.emit("flushMetrics"),t.sendEnvelope(s)}function vr(t){return br().get(t)}function br(){return k("clientToMetricBufferMap",(()=>/* @__PURE__ */new WeakMap))}const Sr=Symbol.for("SentryBufferFullError");function kr(t=100){const e=/* @__PURE__ */new Set;function n(t){e.delete(t)}return{get $(){return Array.from(e)},add:function(r){if(!(e.size<t))return $n(Sr);const o=r();return e.add(o),o.then((()=>n(o)),(()=>n(o))),o},drain:function(t){if(!e.size)return An(!0);const n=Promise.allSettled(Array.from(e)).then((()=>!0));if(!t)return n;const r=[n,new Promise((e=>setTimeout((()=>e(!1)),t)))];return Promise.race(r)}}}function xr(t,{statusCode:e,headers:n},r=Date.now()){const o=c({},t),s=null==n?void 0:n["x-sentry-rate-limits"],i=null==n?void 0:n["retry-after"];if(s)for(const a of s.trim().split(",")){const[t,e,,,n]=a.split(":",5),s=parseInt(t,10),i=1e3*(isNaN(s)?60:s);if(e)for(const a of e.split(";"))"metric_bucket"===a&&n&&!n.split(";").includes("custom")||(o[a]=r+i);else o.all=r+i}else i?o.all=r+function(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return 1e3*n;const r=Date.parse(`${t}`);return isNaN(r)?6e4:r-e}(i,r):429===e&&(o.all=r+6e4);return o}function wr(t,e,n=kr(t.bufferSize||64)){let r={};return{send:function(o){const s=[];if(Qe(o,((e,n)=>{const o=sn(n);!function(t,e,n=Date.now()){return function(t,e){return t[e]||t.all||0}(t,e)>n}(r,o)?s.push(e):t.recordDroppedEvent("ratelimit_backoff",o)})),0===s.length)return Promise.resolve({});const i=Ze(o[0],s),a=e=>{Qe(i,((n,r)=>{t.recordDroppedEvent(e,sn(r))}))};return n.add((()=>e({body:en(i)}).then((t=>(void 0!==t.statusCode&&(t.statusCode<200||t.statusCode>=300)&&_&&A.warn(`Sentry responded with status code ${t.statusCode} to sent event.`),r=xr(r,t),t)),(t=>{throw a("network_error"),_&&A.error("Encountered error running transport request:",t),t})))).then((t=>t),(t=>{if(t===Sr)return _&&A.error("Skipped sending event because buffer is full."),a("queue_overflow"),Promise.resolve({});throw t}))},flush:t=>n.drain(t)}}function Er(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];(null==n?void 0:n.value)&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch(n){}return e}const Tr="Not capturing exception because it's already been captured.",Ir="Discarded session because of missing or non-string release",Or=Symbol.for("SentryInternalError"),Ar=Symbol.for("SentryDoNotSendEventError");function $r(t){return{message:t,[Or]:!0}}function Cr(t){return{message:t,[Ar]:!0}}function jr(t){return!!t&&"object"==typeof t&&Or in t}function Mr(t){return!!t&&"object"==typeof t&&Ar in t}function Pr(t,e,n,r,o){let s,i=0,a=!1;t.on(n,(()=>{i=0,clearTimeout(s),a=!1})),t.on(e,(e=>{i+=r(e),i>=8e5?o(t):a||(a=!0,s=setTimeout((()=>{o(t)}),5e3))})),t.on("flush",(()=>{o(t)}))}class Nr{constructor(t){var e,n,r,o,s,i,a;if(this._options=t,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=kr(null!=(n=null==(e=t.transportOptions)?void 0:e.bufferSize)?n:64),t.dsn?this._dsn=_e(t.dsn):_&&A.warn("No DSN provided, client will not send events."),this._dsn){const e=er(this._dsn,t.tunnel,t._metadata?t._metadata.sdk:void 0);this._transport=t.transport(u(c({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this)},t.transportOptions),{url:e}))}this._options.enableLogs=null!=(o=this._options.enableLogs)?o:null==(r=this._options._experiments)?void 0:r.enableLogs,this._options.enableLogs&&Pr(this,"afterCaptureLog","flushLogs",Ur,lr);(null==(a=null!=(i=this._options.enableMetrics)?i:null==(s=this._options._experiments)?void 0:s.enableMetrics)||a)&&Pr(this,"afterCaptureMetric","flushMetrics",Fr,yr)}captureException(t,e,n){const r=gt();if(St(t))return _&&A.log(Tr),r;const o=c({event_id:r},e);return this._process((()=>this.eventFromException(t,o).then((t=>this._captureEvent(t,o,n))).then((t=>t))),"error"),o.event_id}captureMessage(t,e,n,r){const o=c({event_id:gt()},n),s=G(t)?t:String(t),i=K(t),a=i?this.eventFromMessage(s,e,o):this.eventFromException(t,o);return this._process((()=>a.then((t=>this._captureEvent(t,o,r)))),i?"unknown":"error"),o.event_id}captureEvent(t,e,n){const r=gt();if((null==e?void 0:e.originalException)&&St(e.originalException))return _&&A.log(Tr),r;const o=c({event_id:r},e),s=t.sdkProcessingMetadata||{},i=s.capturedSpanScope,a=s.capturedSpanIsolationScope,u=Rr(t.type);return this._process((()=>this._captureEvent(t,o,i||n,a)),u),o.event_id}captureSession(t){this.sendSession(t),Et(t,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){return p(this,null,(function*(){const e=this._transport;if(!e)return!0;this.emit("flush");const n=yield this._isClientDoneProcessing(t),r=yield e.flush(t);return n&&r}))}close(t){return p(this,null,(function*(){const e=yield this.flush(t);return this.getOptions().enabled=!1,this.emit("close"),e}))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}init(){(this._isEnabled()||this._options.integrations.some((({name:t})=>t.startsWith("Spotlight"))))&&this._setupIntegrations()}getIntegrationByName(t){return this._integrations[t]}addIntegration(t){const e=this._integrations[t.name];or(this,t,this._integrations),e||rr(this,[t])}sendEvent(t,e={}){this.emit("beforeSendEvent",t,e);let n=cn(t,this._dsn,this._options._metadata,this._options.tunnel);for(const r of e.attachments||[])n=Xe(n,rn(r));this.sendEnvelope(n).then((e=>this.emit("afterSendEvent",t,e)))}sendSession(t){const{release:e,environment:n=qe}=this._options;if("aggregates"in t){const r=t.attrs||{};if(!r.release&&!e)return void(_&&A.warn(Ir));r.release=r.release||e,r.environment=r.environment||n,t.attrs=r}else{if(!t.release&&!e)return void(_&&A.warn(Ir));t.release=t.release||e,t.environment=t.environment||n}this.emit("beforeSendSession",t);const r=function(t,e,n,r){const o=an(n);return Ze(c(c({sent_at:/* @__PURE__ */(new Date).toISOString()},o&&{sdk:o}),!!r&&e&&{dsn:fe(e)}),["aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()]])}(t,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(t,e,n=1){if(this._options.sendClientReports){const r=`${t}:${e}`;_&&A.log(`Recording outcome: "${r}"${n>1?` (${n} times)`:""}`),this._outcomes[r]=(this._outcomes[r]||0)+n}}on(t,e){const n=this._hooks[t]=this._hooks[t]||/* @__PURE__ */new Set,r=(...t)=>e(...t);return n.add(r),()=>{n.delete(r)}}emit(t,...e){const n=this._hooks[t];n&&n.forEach((t=>t(...e)))}sendEnvelope(t){return p(this,null,(function*(){if(this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport)try{return yield this._transport.send(t)}catch(e){return _&&A.error("Error while sending envelope:",e),{}}return _&&A.error("Transport disabled"),{}}))}_setupIntegrations(){const{integrations:t}=this._options;this._integrations=function(t,e){const n={};return e.forEach((e=>{e&&or(t,e,n)})),n}(this,t),rr(this,t)}_updateSessionFromEvent(t,e){var n,r;let o="fatal"===e.level,s=!1;const i=null==(n=e.exception)?void 0:n.values;if(i){s=!0,o=!1;for(const t of i)if(!1===(null==(r=t.mechanism)?void 0:r.handled)){o=!0;break}}const a="ok"===t.status;(a&&0===t.errors||a&&o)&&(Et(t,u(c({},o&&{status:"crashed"}),{errors:t.errors||Number(s||o)})),this.captureSession(t))}_isClientDoneProcessing(t){return p(this,null,(function*(){let e=0;for(;!t||e<t;){if(yield new Promise((t=>setTimeout(t,1))),!this._numProcessing)return!0;e++}return!1}))}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(t,e,n,r){const o=this.getOptions(),s=Object.keys(this._integrations);return!e.integrations&&(null==s?void 0:s.length)&&(e.integrations=s),this.emit("preprocessEvent",t,e),t.type||r.setLastEventId(t.event_id||e.event_id),qn(o,t,e,n,this,r).then((t=>{if(null===t)return t;this.emit("postprocessEvent",t,e),t.contexts=c({trace:Ht(n)},t.contexts);const r=We(this,n);return t.sdkProcessingMetadata=c({dynamicSamplingContext:r},t.sdkProcessingMetadata),t}))}_captureEvent(t,e={},n=Ft(),r=Ut()){return _&&Dr(t)&&A.log(`Captured error event \`${Er(t)[0]||"<unknown>"}\``),this._processEvent(t,e,n,r).then((t=>t.event_id),(t=>{_&&(Mr(t)?A.log(t.message):jr(t)?A.warn(t.message):A.warn(t))}))}_processEvent(t,e,n,r){const o=this.getOptions(),{sampleRate:s}=o,i=Lr(t),a=Dr(t),l=`before send for type \`${t.type||"error"}\``,p=void 0===s?void 0:ye(s);if(a&&"number"==typeof p&&Math.random()>p)return this.recordDroppedEvent("sample_rate","error"),$n(Cr(`Discarding event because it's not included in the random sample (sampling rate = ${s})`));const d=Rr(t.type);return this._prepareEvent(t,e,n,r).then((t=>{if(null===t)throw this.recordDroppedEvent("event_processor",d),Cr("An event processor returned `null`, will not send event.");if(e.data&&!0===e.data.__sentry__)return t;const n=function(t,e,n,r){const{beforeSend:o,beforeSendTransaction:s,beforeSendSpan:i,ignoreSpans:a}=e;let l=n;if(Dr(l)&&o)return o(l,r);if(Lr(l)){if(i||a){const e=function(t){var e,n,r;const{trace_id:o,parent_span_id:s,span_id:i,status:a,origin:c,data:u,op:l}=null!=(n=null==(e=t.contexts)?void 0:e.trace)?n:{};return{data:null!=u?u:{},description:t.transaction,op:l,parent_span_id:s,span_id:null!=i?i:"",start_timestamp:null!=(r=t.start_timestamp)?r:0,status:a,timestamp:t.timestamp,trace_id:null!=o?o:"",origin:c,profile_id:null==u?void 0:u[Qt],exclusive_time:null==u?void 0:u[te],measurements:t.measurements,is_segment:!0}}(l);if((null==a?void 0:a.length)&&Fe(e,a))return null;if(i){const t=i(e);t?l=Tt(n,{type:"transaction",timestamp:(p=t).timestamp,start_timestamp:p.start_timestamp,transaction:p.description,contexts:{trace:{trace_id:p.trace_id,span_id:p.span_id,parent_span_id:p.parent_span_id,op:p.op,status:p.status,origin:p.origin,data:c(c(c({},p.data),p.profile_id&&{[Qt]:p.profile_id}),p.exclusive_time&&{[te]:p.exclusive_time})}},measurements:p.measurements}):Pe()}if(l.spans){const e=[],n=l.spans;for(const t of n)if((null==a?void 0:a.length)&&Fe(t,a))Ue(n,t);else if(i){const n=i(t);n?e.push(n):(Pe(),e.push(t))}else e.push(t);const r=l.spans.length-e.length;r&&t.recordDroppedEvent("before_send","span",r),l.spans=e}}if(s){if(l.spans){const t=l.spans.length;l.sdkProcessingMetadata=u(c({},n.sdkProcessingMetadata),{spanCountBeforeProcessing:t})}return s(l,r)}}var p;return l}(this,o,t,e);return function(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Z(t))return t.then((t=>{if(!V(t)&&null!==t)throw $r(n);return t}),(t=>{throw $r(`${e} rejected with ${t}`)}));if(!V(t)&&null!==t)throw $r(n);return t}(n,l)})).then((o=>{var s;if(null===o){if(this.recordDroppedEvent("before_send",d),i){const e=1+(t.spans||[]).length;this.recordDroppedEvent("before_send","span",e)}throw Cr(`${l} returned \`null\`, will not send event.`)}const p=n.getSession()||r.getSession();if(a&&p&&this._updateSessionFromEvent(p,o),i){const t=((null==(s=o.sdkProcessingMetadata)?void 0:s.spanCountBeforeProcessing)||0)-(o.spans?o.spans.length:0);t>0&&this.recordDroppedEvent("before_send","span",t)}const f=o.transaction_info;if(i&&f&&o.transaction!==t.transaction){const t="custom";o.transaction_info=u(c({},f),{source:t})}return this.sendEvent(o,e),o})).then(null,(t=>{if(Mr(t)||jr(t))throw t;throw this.captureException(t,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:t}),$r(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ${t}`)}))}_process(t,e){this._numProcessing++,this._promiseBuffer.add(t).then((t=>(this._numProcessing--,t)),(t=>(this._numProcessing--,t===Sr&&this.recordDroppedEvent("queue_overflow",e),t)))}_clearOutcomes(){const t=this._outcomes;return this._outcomes={},Object.entries(t).map((([t,e])=>{const[n,r]=t.split(":");return{reason:n,category:r,quantity:e}}))}_flushOutcomes(){_&&A.log("Flushing outcomes...");const t=this._clearOutcomes();if(0===t.length)return void(_&&A.log("No outcomes to send"));if(!this._dsn)return void(_&&A.log("No dsn provided, will not send outcomes"));_&&A.log("Sending outcomes:",t);const e=(n=t,Ze((r=this._options.tunnel&&fe(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:kt(),discarded_events:n}]]));var n,r;this.sendEnvelope(e)}}function Rr(t){return"replay_event"===t?"replay":t||"error"}function Dr(t){return void 0===t.type}function Lr(t){return"transaction"===t.type}function Fr(t){let e=0;return t.name&&(e+=2*t.name.length),e+=8,e+qr(t.attributes)}function Ur(t){let e=0;return t.message&&(e+=2*t.message.length),e+qr(t.attributes)}function qr(t){if(!t)return 0;let e=0;return Object.values(t).forEach((t=>{Array.isArray(t)?e+=t.length*Br(t[0]):K(t)?e+=Br(t):e+=100})),e}function Br(t){return"string"==typeof t?2*t.length:"number"==typeof t?8:"boolean"==typeof t?4:0}function Jr(t,e){!0===e.debug&&(_?A.enable():E((()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})));Ft().update(e.initialScope);const n=new t(e);return function(t){Ft().setClient(t)}(n),n.init(),n}function Hr(t,e){let n;return Qe(t,((t,r)=>(e.includes(r)&&(n=Array.isArray(t)?t[1]:void 0),!!n))),n}function Wr(t,e){return n=>{const r=t(n),o=/* @__PURE__ */new Map;function s(e,r){const s=r?`${e}:${r}`:e;let i=o.get(s);if(!i){const a=me(e);if(!a)return;const l=er(a,n.tunnel);i=r?function(t,e){return n=>{const r=t(n);return u(c({},r),{send:t=>p(null,null,(function*(){const n=Hr(t,["event","transaction","profile","replay_event"]);return n&&(n.release=e),r.send(t)}))})}}(t,r)(u(c({},n),{url:l})):t(u(c({},n),{url:l})),o.set(s,i)}return[e,i]}return{send:function(t){return p(this,null,(function*(){const n=e({envelope:t,getEvent:function(e){const n=(null==e?void 0:e.length)?e:["event"];return Hr(t,n)}}).map((t=>"string"==typeof t?s(t,void 0):s(t.dsn,t.release))).filter((t=>!!t)),o=n.length?n:[["",r]],i=yield Promise.all(o.map((([e,n])=>n.send(function(t,e){return Ze(e?u(c({},t[0]),{dsn:e}):t[0],t[1])}(t,e)))));return i[0]}))},flush:function(t){return p(this,null,(function*(){const e=[...o.values(),r];return(yield Promise.all(e.map((e=>e.flush(t))))).every((t=>t))}))}}}}const zr=function(t,...e){const n=new String(String.raw(t,...e));return n.__sentry_template_string__=t.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=e,n};const Gr=100;function Kr(t,e){const n=Jt(),r=Ut();if(!n)return;const{beforeBreadcrumb:o=null,maxBreadcrumbs:s=Gr}=n.getOptions();if(s<=0)return;const i=kt(),a=c({timestamp:i},t),u=o?E((()=>o(a,e))):a;null!==u&&(n.emit&&n.emit("beforeAddBreadcrumb",u,e),r.addBreadcrumb(u,s))}let Vr;const Yr=/* @__PURE__ */new WeakMap,Zr=()=>({name:"FunctionToString",setupOnce(){Vr=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=it(this),n=Yr.has(Jt())&&void 0!==e?e:this;return Vr.apply(n,t)}}catch(t){}},setup(t){Yr.set(t,!0)}}),Xr=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Qr=(t={})=>{let e;return{name:"EventFilters",setup(n){const r=n.getOptions();e=eo(t,r)},processEvent(n,r,o){if(!e){const n=o.getOptions();e=eo(t,n)}return function(t,e){if(t.type){if("transaction"===t.type&&function(t,e){if(!(null==e?void 0:e.length))return!1;const n=t.transaction;return!!n&&mt(n,e)}(t,e.ignoreTransactions))return _&&A.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.\nEvent: ${yt(t)}`),!0}else{if(function(t,e){if(!(null==e?void 0:e.length))return!1;return Er(t).some((t=>mt(t,e)))}(t,e.ignoreErrors))return _&&A.warn(`Event dropped due to being matched by \`ignoreErrors\` option.\nEvent: ${yt(t)}`),!0;if(function(t){var e,n;if(!(null==(n=null==(e=t.exception)?void 0:e.values)?void 0:n.length))return!1;return!t.message&&!t.exception.values.some((t=>t.stacktrace||t.type&&"Error"!==t.type||t.value))}(t))return _&&A.warn(`Event dropped due to not having an error message, error type or stacktrace.\nEvent: ${yt(t)}`),!0;if(function(t,e){if(!(null==e?void 0:e.length))return!1;const n=no(t);return!!n&&mt(n,e)}(t,e.denyUrls))return _&&A.warn(`Event dropped due to being matched by \`denyUrls\` option.\nEvent: ${yt(t)}.\nUrl: ${no(t)}`),!0;if(!function(t,e){if(!(null==e?void 0:e.length))return!0;const n=no(t);return!n||mt(n,e)}(t,e.allowUrls))return _&&A.warn(`Event dropped due to not being matched by \`allowUrls\` option.\nEvent: ${yt(t)}.\nUrl: ${no(t)}`),!0}return!1}(n,e)?null:n}}},to=(t={})=>u(c({},Qr(t)),{name:"InboundFilters"});function eo(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:Xr],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function no(t){var e,n,r;try{const o=[...null!=(n=null==(e=t.exception)?void 0:e.values)?n:[]].reverse().find((t=>{var e,n,r;return void 0===(null==(e=t.mechanism)?void 0:e.parent_id)&&(null==(r=null==(n=t.stacktrace)?void 0:n.frames)?void 0:r.length)})),s=null==(r=null==o?void 0:o.stacktrace)?void 0:r.frames;return s?function(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(s):null}catch(o){return _&&A.error(`Cannot extract url for event ${yt(t)}`),null}}const ro=/* @__PURE__ */new Map,oo=/* @__PURE__ */new Set;function so(t,e){return function(t){if(y._sentryModuleMetadata)for(const e of Object.keys(y._sentryModuleMetadata)){const n=y._sentryModuleMetadata[e];if(oo.has(e))continue;oo.add(e);const r=t(e);for(const t of r.reverse())if(t.filename){ro.set(t.filename,n);break}}}(t),ro.get(e)}function io(t,e){var n,r;null==(r=null==(n=e.exception)?void 0:n.values)||r.forEach((e=>{var n,r;null==(r=null==(n=e.stacktrace)?void 0:n.frames)||r.forEach((e=>{if(!e.filename||e.module_metadata)return;const n=so(t,e.filename);n&&(e.module_metadata=n)}))}))}function ao(t){var e,n;null==(n=null==(e=t.exception)?void 0:e.values)||n.forEach((t=>{var e,n;null==(n=null==(e=t.stacktrace)?void 0:e.frames)||n.forEach((t=>{delete t.module_metadata}))}))}const co=()=>({name:"ModuleMetadata",setup(t){t.on("beforeEnvelope",(t=>{Qe(t,((t,e)=>{if("event"===e){const e=Array.isArray(t)?t[1]:void 0;e&&(ao(e),t[1]=e)}}))})),t.on("applyFrameMetadata",(e=>{if(e.type)return;io(t.getOptions().stackParser,e)}))}});function uo(t){const e="console";N(e,t),R(e,lo)}function lo(){"console"in y&&x.forEach((function(t){t in y.console&&rt(y.console,t,(function(e){return w[t]=e,function(...e){D("console",{args:e,level:t});const n=w[t];null==n||n.apply(y.console,e)}}))}))}function po(t){return"warn"===t?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const fo=(t={})=>{var e;const n=t.levels||x,r=null==(e=t.handled)||e;return{name:"CaptureConsole",setup(t){"console"in y&&uo((({args:e,level:o})=>{Jt()===t&&n.includes(o)&&function(t,e,n){const r=po(e),o=new Error,s={level:po(e),extra:{arguments:t}};Bt((i=>{if(i.addEventProcessor((t=>(t.logger="console",bt(t,{handled:n,type:"auto.core.capture_console"}),t))),"assert"===e){if(!t[0]){const e=`Assertion failed: ${dt(t.slice(1)," ")||"console.assert"}`;i.setExtra("arguments",t.slice(1)),i.captureMessage(e,r,{captureContext:s,syntheticException:o})}return}const a=t.find((t=>t instanceof Error));if(a)return void Hn(a,s);const c=dt(t," ");i.captureMessage(c,r,{captureContext:s,syntheticException:o})}))}(e,o,r)}))}}};const mo=(t={})=>{const{depth:e=3,captureErrorCause:n=!0}=t;return{name:"ExtraErrorData",processEvent(t,r,o){const{maxValueLength:s}=o.getOptions();return function(t,e={},n,r,o){if(!e.originalException||!J(e.originalException))return t;const s=e.originalException.name||e.originalException.constructor.name,i=ho(e.originalException,r,o);if(i){const e=c({},t.contexts),r=Ke(i,n);return V(r)&&(ot(r,"__sentry_skip_normalization__",!0),e[s]=r),u(c({},t),{contexts:e})}return t}(t,r,e,n,s)}}};function ho(t,e,n){try{const r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],o={};for(const e of Object.keys(t)){if(-1!==r.indexOf(e))continue;const s=t[e];o[e]=J(s)||"string"==typeof s?n?pt(`${s}`,n):`${s}`:s}if(e&&void 0!==t.cause)if(J(t.cause)){const e=t.cause.name||t.cause.constructor.name;o.cause={[e]:ho(t.cause,!1,n)}}else o.cause=t.cause;if("function"==typeof t.toJSON){const e=t.toJSON();for(const t of Object.keys(e)){const n=e[t];o[t]=J(n)?n.toString():n}}return o}catch(r){_&&A.error("Unable to extract extra data from the Error object:",r)}return null}const go=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function _o(...t){let e="",n=!1;for(let r=t.length-1;r>=-1&&!n;r--){const o=r>=0?t[r]:"/";o&&(e=`${o}/${e}`,n="/"===o.charAt(0))}return e=function(t,e){let n=0;for(let r=t.length-1;r>=0;r--){const e=t[r];"."===e?t.splice(r,1):".."===e?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}(e.split("/").filter((t=>!!t)),!n).join("/"),(n?"/":"")+e||"."}function yo(t){let e=0;for(;e<t.length&&""===t[e];e++);let n=t.length-1;for(;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}function vo(t,e){return function(t){const e=t.length>1024?`<truncated>${t.slice(-1024)}`:t,n=go.exec(e);return n?n.slice(1):[]}(t)[2]||""}const bo=(t={})=>{const e=t.root,n=t.prefix||"app:///",r="window"in y&&!!y.window,o=t.iteratee||function({isBrowser:t,root:e,prefix:n}){return r=>{if(!r.filename)return r;const o=/^[a-zA-Z]:\\/.test(r.filename)||r.filename.includes("\\")&&!r.filename.includes("/"),s=/^\//.test(r.filename);if(t){if(e){const t=r.filename;0===t.indexOf(e)&&(r.filename=t.replace(e,n))}}else if(o||s){const t=o?r.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):r.filename,s=e?function(t,e){t=_o(t).slice(1),e=_o(e).slice(1);const n=yo(t.split("/")),r=yo(e.split("/")),o=Math.min(n.length,r.length);let s=o;for(let a=0;a<o;a++)if(n[a]!==r[a]){s=a;break}let i=[];for(let a=s;a<n.length;a++)i.push("..");return i=i.concat(r.slice(s)),i.join("/")}(e,t):vo(t);r.filename=`${n}${s}`}return r}}({isBrowser:r,root:e,prefix:n});return{name:"RewriteFrames",processEvent(t){let e=t;return t.exception&&Array.isArray(t.exception.values)&&(e=function(t){try{return u(c({},t),{exception:u(c({},t.exception),{values:t.exception.values.map((t=>{return c(c({},t),t.stacktrace&&{stacktrace:(e=t.stacktrace,u(c({},e),{frames:null==(n=null==e?void 0:e.frames)?void 0:n.map((t=>o(t)))}))});var e,n}))})})}catch(e){return t}}(e)),e}}};const So=["reauthenticate","signInAnonymously","signInWithOAuth","signInWithIdToken","signInWithOtp","signInWithPassword","signInWithSSO","signOut","signUp","verifyOtp"],ko=["createUser","deleteUser","listUsers","getUserById","updateUserById","inviteUserByEmail"],xo={eq:"eq",neq:"neq",gt:"gt",gte:"gte",lt:"lt",lte:"lte",like:"like","like(all)":"likeAllOf","like(any)":"likeAnyOf",ilike:"ilike","ilike(all)":"ilikeAllOf","ilike(any)":"ilikeAnyOf",is:"is",in:"in",cs:"contains",cd:"containedBy",sr:"rangeGt",nxl:"rangeGte",sl:"rangeLt",nxr:"rangeLte",adj:"rangeAdjacent",ov:"overlaps",fts:"",plfts:"plain",phfts:"phrase",wfts:"websearch",not:"not"},wo=["select","insert","upsert","update","delete"];function Eo(t){try{t.__SENTRY_INSTRUMENTED__=!0}catch(e){}}function To(t){try{return t.__SENTRY_INSTRUMENTED__}catch(e){return!1}}function Io(t,e){if(""===e||"*"===e)return"select(*)";if("select"===t)return`select(${e})`;if("or"===t||t.endsWith(".or"))return`${t}${e}`;const[n,...r]=e.split(".");let o;return o=(null==n?void 0:n.startsWith("fts"))?"textSearch":(null==n?void 0:n.startsWith("plfts"))?"textSearch[plain]":(null==n?void 0:n.startsWith("phfts"))?"textSearch[phrase]":(null==n?void 0:n.startsWith("wfts"))?"textSearch[websearch]":n&&xo[n]||"filter",`${o}(${t}, ${r.join(".")})`}function Oo(t,e=!1){return new Proxy(t,{apply:(n,r,o)=>gn({name:`auth ${e?"(admin) ":""}${t.name}`,attributes:{[Kt]:"auto.db.supabase",[Gt]:"db","db.system":"postgresql","db.operation":`auth.${e?"admin.":""}${t.name}`}},(t=>Reflect.apply(n,r,o).then((e=>(e&&"object"==typeof e&&"error"in e&&e.error?(t.setStatus({code:2}),Hn(e.error,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}})):t.setStatus({code:1}),t.end(),e))).catch((e=>{throw t.setStatus({code:2}),t.end(),Hn(e,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}}),e})).then(...o)))})}function Ao(t){To(t.prototype.from)||(t.prototype.from=new Proxy(t.prototype.from,{apply(t,e,n){const r=Reflect.apply(t,e,n);return function(t){for(const e of wo)To(t.prototype[e])||(t.prototype[e]=new Proxy(t.prototype[e],{apply(t,n,r){const o=Reflect.apply(t,n,r),s=o.constructor;return _&&A.log(`Instrumenting ${e} operation's PostgRESTFilterBuilder`),$o(s),o}}),Eo(t.prototype[e]))}(r.constructor),r}}),Eo(t.prototype.from))}function $o(t){To(t.prototype.then)||(t.prototype.then=new Proxy(t.prototype.then,{apply(t,e,n){var r;const o=wo,s=e,i=function(t,e={}){var n;switch(t){case"GET":return"select";case"POST":return(null==(n=e.Prefer)?void 0:n.includes("resolution="))?"upsert":"insert";case"PATCH":return"update";case"DELETE":return"delete";default:return"<unknown-op>"}}(s.method,s.headers);if(!o.includes(i))return Reflect.apply(t,e,n);if(!(null==(r=null==s?void 0:s.url)?void 0:r.pathname)||"string"!=typeof s.url.pathname)return Reflect.apply(t,e,n);const a=s.url.pathname.split("/"),c=a.length>0?a[a.length-1]:"",u=[];for(const[f,m]of s.url.searchParams.entries())u.push(Io(f,m));const l=/* @__PURE__ */Object.create(null);if(V(s.body))for(const[f,m]of Object.entries(s.body))l[f]=m;const p=`${"select"===i?"":`${i}${l?"(...) ":""}`}${u.join(" ")} from(${c})`,d={"db.table":c,"db.schema":s.schema,"db.url":s.url.origin,"db.sdk":s.headers["X-Client-Info"],"db.system":"postgresql","db.operation":i,[Kt]:"auto.db.supabase",[Gt]:"db"};return u.length&&(d["db.query"]=u),Object.keys(l).length&&(d["db.body"]=l),gn({name:p,attributes:d},(r=>Reflect.apply(t,e,[]).then((t=>{if(r&&(t&&"object"==typeof t&&"status"in t&&ne(r,t.status||500),r.end()),t.error){const e=new Error(t.error.message);t.error.code&&(e.code=t.error.code),t.error.details&&(e.details=t.error.details);const n={};u.length&&(n.query=u),Object.keys(l).length&&(n.body=l),Hn(e,(t=>(t.addEventProcessor((t=>(bt(t,{handled:!1,type:"auto.db.supabase.postgres"}),t))),t.setContext("supabase",n),t)))}const e={type:"supabase",category:`db.${i}`,message:p},n={};return u.length&&(n.query=u),Object.keys(l).length&&(n.body=l),Object.keys(n).length&&(e.data=n),Kr(e),t}),(t=>{throw r&&(ne(r,500),r.end()),t})).then(...n)))}}),Eo(t.prototype.then))}const Co=t=>{if(!t)return void(_&&A.warn("Supabase integration was not installed because no Supabase client was provided."));Ao(t.constructor===Function?t:t.constructor),function(t){const e=t.auth;if(e&&!To(t.auth)){for(const n of So){const r=e[n];r&&"function"==typeof t.auth[n]&&(t.auth[n]=Oo(r))}for(const n of ko){const r=e.admin[n];r&&"function"==typeof t.auth.admin[n]&&(t.auth.admin[n]=Oo(r,!0))}Eo(t.auth)}}(t)},jo=t=>{return e=t.supabaseClient,{setupOnce(){Co(e)},name:"Supabase"};var e};function Mo(t){return u(c({},t),{path:"path"in t&&Array.isArray(t.path)?t.path.join("."):void 0,keys:"keys"in t?JSON.stringify(t.keys):void 0,unionErrors:"unionErrors"in t?JSON.stringify(t.unionErrors):void 0})}function Po(t){const e=/* @__PURE__ */new Set;for(const r of t.issues){const t=r.path.map((t=>"number"==typeof t?"<array>":t)).join(".");t.length>0&&e.add(t)}const n=Array.from(e);if(0===n.length){let e="variable";if(t.issues.length>0){const n=t.issues[0];void 0!==n&&"expected"in n&&"string"==typeof n.expected&&(e=n.expected)}return`Failed to validate ${e}`}return`Failed to validate keys: ${pt(n.join(", "),100)}`}function No(t,e=!1,n,r){var o,s;if(!((null==(o=n.exception)?void 0:o.values)&&r.originalException&&(s=r.originalException,J(s)&&"ZodError"===s.name&&Array.isArray(s.issues))&&0!==r.originalException.issues.length))return n;try{const o=(e?r.originalException.issues:r.originalException.issues.slice(0,t)).map(Mo);return e&&(Array.isArray(r.attachments)||(r.attachments=[]),r.attachments.push({filename:"zod_issues.json",data:JSON.stringify({issues:o})})),u(c({},n),{exception:u(c({},n.exception),{values:[u(c({},n.exception.values[0]),{value:Po(r.originalException)}),...n.exception.values.slice(1)]}),extra:u(c({},n.extra),{"zoderror.issues":o.slice(0,t)})})}catch(i){return u(c({},n),{extra:u(c({},n.extra),{"zoderrors sentry integration parse error":{message:"an exception was thrown while processing ZodError within applyZodErrorsToEvent()",error:i instanceof Error?`${i.name}: ${i.message}\n${i.stack}`:"unknown"}})})}}const Ro=(t={})=>{var e;const n=null!=(e=t.limit)?e:10;return{name:"ZodErrors",processEvent:(e,r)=>No(n,t.saveZodIssuesAsAttachment,e,r)}},Do=t=>({name:"ThirdPartyErrorsFilter",setup(t){t.on("beforeEnvelope",(t=>{Qe(t,((t,e)=>{if("event"===e){const e=Array.isArray(t)?t[1]:void 0;e&&(ao(e),t[1]=e)}}))})),t.on("applyFrameMetadata",(e=>{if(e.type)return;io(t.getOptions().stackParser,e)}))},processEvent(e){const n=function(t){const e=function(t){const e=t.exception;if(e){const t=[];try{return e.values.forEach((e=>{e.stacktrace.frames&&t.push(...e.stacktrace.frames)})),t}catch(n){return}}}(t);if(!e)return;return e.filter((t=>{var e;return!!t.filename&&null!=(null!=(e=t.lineno)?e:t.colno)})).map((t=>t.module_metadata?Object.keys(t.module_metadata).filter((t=>t.startsWith(Lo))).map((t=>t.slice(Lo.length))):[]))}(e);if(n){if(n["drop-error-if-contains-third-party-frames"===t.behaviour||"apply-tag-if-contains-third-party-frames"===t.behaviour?"some":"every"]((e=>!e.some((e=>t.filterKeys.includes(e)))))){if("drop-error-if-contains-third-party-frames"===t.behaviour||"drop-error-if-exclusively-contains-third-party-frames"===t.behaviour)return null;e.tags=u(c({},e.tags),{third_party_code:!0})}}return e}});const Lo="_sentryBundlerPluginAppKey:",Fo="flag.evaluation.";function Uo(t,e,n=100){const r=Ft().getScopeData().contexts;r.flags||(r.flags={values:[]});!function(t,e,n,r){if("boolean"!=typeof n)return;if(t.length>r)return void(_&&A.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${r}`));const o=t.findIndex((t=>t.flag===e));-1!==o&&t.splice(o,1);t.length===r&&t.shift();t.push({flag:e,result:n})}(r.flags.values,t,e,n)}const qo=()=>({name:"FeatureFlags",processEvent:(t,e,n)=>function(t){const e=Ft().getScopeData().contexts.flags,n=e?e.values:[];return n.length?(void 0===t.contexts&&(t.contexts={}),t.contexts.flags={values:[...n]},t):t}(t),addFeatureFlag(t,e){Uo(t,e),function(t,e,n=10){if("boolean"!=typeof e)return;const r=Me();if(!r)return;const o=Ee(r).data;if(`${Fo}${t}`in o)return void r.setAttribute(`${Fo}${t}`,e);Object.keys(o).filter((t=>t.startsWith(Fo))).length<n&&r.setAttribute(`${Fo}${t}`,e)}(t,e)}});function Bo(t,e,n,r,o){ur({level:t,message:e,attributes:n,severityNumber:o},r)}const Jo=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,debug:function(t,e,{scope:n}={}){Bo("debug",t,e,n)},error:function(t,e,{scope:n}={}){Bo("error",t,e,n)},fatal:function(t,e,{scope:n}={}){Bo("fatal",t,e,n)},fmt:zr,info:function(t,e,{scope:n}={}){Bo("info",t,e,n)},trace:function(t,e,{scope:n}={}){Bo("trace",t,e,n)},warn:function(t,e,{scope:n}={}){Bo("warn",t,e,n)}},Symbol.toStringTag,{value:"Module"}));function Ho(t,e,n){return"util"in y&&"function"==typeof y.util.format?y.util.format(...t):function(t,e,n){return t.map((t=>K(t)?String(t):JSON.stringify(Ke(t,e,n)))).join(" ")}(t,e,n)}const Wo={[Kt]:"auto.log.console"},zo=(t={})=>{const e=t.levels||x;return{name:"ConsoleLogs",setup(t){const{enableLogs:n,normalizeDepth:r=3,normalizeMaxBreadth:o=1e3}=t.getOptions();n?uo((({args:n,level:s})=>{if(Jt()!==t||!e.includes(s))return;const i=n[0],a=n.slice(1);if("assert"===s){if(!i){ur({level:"error",message:a.length>0?`Assertion failed: ${Ho(a,r,o)}`:"Assertion failed",attributes:Wo})}return}const u="log"===s,l=n.length>1&&"string"==typeof n[0]&&(p=n[0],!/%[sdifocO]/.test(p));var p;const d=c(c({},Wo),l?function(t,e){const n={},r=new Array(e.length).fill("{}").join(" ");return n["sentry.message.template"]=`${t} ${r}`,e.forEach(((t,e)=>{n[`sentry.message.parameter.${e}`]=t})),n}(i,a):{});ur({level:u?"info":s,message:Ho(n,r,o),severityNumber:u?10:void 0,attributes:d})})):_&&A.warn("`enableLogs` is not enabled, ConsoleLogs integration disabled")}}};function Go(t,e,n,r){_r({type:t,name:e,value:n,unit:null==r?void 0:r.unit,attributes:null==r?void 0:r.attributes},{scope:null==r?void 0:r.scope})}const Ko=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,count:function(t,e=1,n){Go("counter",t,e,n)},distribution:function(t,e,n){Go("distribution",t,e,n)},gauge:function(t,e,n){Go("gauge",t,e,n)}},Symbol.toStringTag,{value:"Module"})),Vo=["trace","debug","info","warn","error","fatal"];function Yo(t={}){var e;const n=new Set(null!=(e=t.levels)?e:Vo),r=t.client;return{log(t){const e=t,{type:o,level:s,message:i,args:a,tag:c,date:u}=e,p=l(e,["type","level","message","args","tag","date"]),d=r||Jt();if(!d)return;const f=function(t,e){if("verbose"===t)return"debug";if("silent"===t)return"trace";if(t){const e=Zo[t];if(e)return e}if("number"==typeof e){const t=Xo[e];if(t)return t}return"info"}(o,s);if(!n.has(f))return;const{normalizeDepth:m=3,normalizeMaxBreadth:h=1e3}=d.getOptions(),g=[];i&&g.push(i),a&&a.length>0&&g.push(Ho(a,m,h));const _=g.join(" ");p["sentry.origin"]="auto.log.consola",c&&(p["consola.tag"]=c),o&&(p["consola.type"]=o),null!=s&&"number"==typeof s&&(p["consola.level"]=s),ur({level:f,message:_,attributes:p})}}}const Zo={silent:"trace",fatal:"fatal",error:"error",warn:"warn",log:"info",info:"info",success:"info",fail:"error",ready:"info",start:"info",box:"info",debug:"debug",trace:"trace",verbose:"debug",critical:"fatal",notice:"info"},Xo={0:"fatal",1:"warn",2:"info",3:"info",4:"debug",5:"trace"};const Qo="gen_ai.prompt",ts="gen_ai.system",es="gen_ai.request.model",ns="gen_ai.request.stream",rs="gen_ai.request.temperature",os="gen_ai.request.max_tokens",ss="gen_ai.request.frequency_penalty",is="gen_ai.request.presence_penalty",as="gen_ai.request.top_p",cs="gen_ai.request.top_k",us="gen_ai.response.finish_reasons",ls="gen_ai.response.model",ps="gen_ai.response.id",ds="gen_ai.usage.input_tokens",fs="gen_ai.usage.output_tokens",ms="gen_ai.usage.total_tokens",hs="gen_ai.operation.name",gs="gen_ai.request.messages",_s="gen_ai.response.text",ys="gen_ai.request.available_tools",vs="gen_ai.response.streaming",bs="gen_ai.response.tool_calls",Ss="openai.response.id",ks="openai.response.model",xs="openai.response.timestamp",ws="openai.usage.completion_tokens",Es="openai.usage.prompt_tokens",Ts="chat",Is="responses",Os="embeddings",As="anthropic.response.timestamp",$s=t=>(new TextEncoder).encode(t).length,Cs=t=>$s(JSON.stringify(t));function js(t,e){if($s(t)<=e)return t;let n=0,r=t.length,o="";for(;n<=r;){const s=Math.floor((n+r)/2),i=t.slice(0,s);$s(i)<=e?(o=i,n=s+1):r=s-1}return o}function Ms(t){return"string"==typeof t?t:t.text}function Ps(t,e){return"string"==typeof t?e:u(c({},t),{text:e})}function Ns(t,e){return t&&"object"==typeof t?function(t){return null!==t&&"object"==typeof t&&"content"in t&&"string"==typeof t.content}(t)?function(t,e){const n=u(c({},t),{content:""}),r=e-Cs(n);if(r<=0)return[];const o=js(t.content,r);return[u(c({},t),{content:o})]}(t,e):function(t){return null!==t&&"object"==typeof t&&"parts"in t&&Array.isArray(t.parts)&&t.parts.length>0}(t)?function(t,e){const{parts:n}=t,r=n.map((t=>Ps(t,"")));let o=e-Cs(u(c({},t),{parts:r}));if(o<=0)return[];const s=[];for(const i of n){const t=Ms(i),e=$s(t);if(!(e<=o)){if(0===s.length){const e=js(t,o);e&&s.push(Ps(i,e));break}break}s.push(i),o-=e}return s.length>0?[u(c({},t),{parts:s})]:[]}(t,e):[]:[]}function Rs(t){return function(t,e){if(!Array.isArray(t)||0===t.length)return t;if(Cs(t)<=e)return t;const n=t.map(Cs);let r=0,o=t.length;for(let s=t.length-1;s>=0;s--){const t=n[s];if(t&&r+t>e)break;t&&(r+=t),o=s}if(o===t.length)return Ns(t[t.length-1],e);return t.slice(o)}(t,2e4)}function Ds(t){return t.includes("messages")?"messages":t.includes("completions")?"completions":t.includes("models")?"models":t.includes("chat")?"chat":t.split(".").pop()||"unknown"}function Ls(t){return`gen_ai.${Ds(t)}`}function Fs(t,e){return t?`${t}.${e}`:e}function Us(t,e,n,r,o){if(void 0!==e&&t.setAttributes({[ds]:e}),void 0!==n&&t.setAttributes({[fs]:n}),void 0!==e||void 0!==n||void 0!==r||void 0!==o){const s=(null!=e?e:0)+(null!=n?n:0)+(null!=r?r:0)+(null!=o?o:0);t.setAttributes({[ms]:s})}}function qs(t){if("string"==typeof t)return js(t,2e4);if(Array.isArray(t)){const e=Rs(t);return JSON.stringify(e)}return JSON.stringify(t)}const Bs=["responses.create","chat.completions.create","embeddings.create"],Js=["response.created","response.in_progress","response.failed","response.completed","response.incomplete","response.queued","response.output_text.delta","response.output_item.added","response.function_call_arguments.delta","response.function_call_arguments.done","response.output_item.done"];function Hs(t){return t.includes("chat.completions")?Ts:t.includes("responses")?Is:t.includes("embeddings")?Os:t.split(".").pop()||"unknown"}function Ws(t){return`gen_ai.${Hs(t)}`}function zs(t){return null!==t&&"object"==typeof t&&"type"in t&&"string"==typeof t.type&&t.type.startsWith("response.")}function Gs(t){return null!==t&&"object"==typeof t&&"object"in t&&"chat.completion.chunk"===t.object}function Ks(t,e,n,r){void 0!==e&&t.setAttributes({[Es]:e,[ds]:e}),void 0!==n&&t.setAttributes({[ws]:n,[fs]:n}),void 0!==r&&t.setAttributes({[ms]:r})}function Vs(t,e,n,r){t.setAttributes({[Ss]:e,[ps]:e}),t.setAttributes({[ks]:n,[ls]:n}),t.setAttributes({[xs]:new Date(1e3*r).toISOString()})}function Ys(t,e){for(const n of t){const t=n.index;if(void 0!==t&&n.function)if(t in e.chatCompletionToolCalls){const r=e.chatCompletionToolCalls[t];n.function.arguments&&(null==r?void 0:r.function)&&(r.function.arguments+=n.function.arguments)}else e.chatCompletionToolCalls[t]=u(c({},n),{function:{name:n.function.name,arguments:n.function.arguments||""}})}}function Zs(t,e,n){var r,o,s,i,a,c;e.responseId=null!=(r=t.id)?r:e.responseId,e.responseModel=null!=(o=t.model)?o:e.responseModel,e.responseTimestamp=null!=(s=t.created)?s:e.responseTimestamp,t.usage&&(e.promptTokens=t.usage.prompt_tokens,e.completionTokens=t.usage.completion_tokens,e.totalTokens=t.usage.total_tokens);for(const u of null!=(i=t.choices)?i:[])n&&((null==(a=u.delta)?void 0:a.content)&&e.responseTexts.push(u.delta.content),(null==(c=u.delta)?void 0:c.tool_calls)&&Ys(u.delta.tool_calls,e)),u.finish_reason&&e.finishReasons.push(u.finish_reason)}function Xs(t,e,n,r){var o,s,i;if(!t||"object"!=typeof t)return void e.eventTypes.push("unknown:non-object");if(t instanceof Error)return r.setStatus({code:2,message:"internal_error"}),void Hn(t,{mechanism:{handled:!1,type:"auto.ai.openai.stream-response"}});if(!("type"in t))return;const a=t;if(Js.includes(a.type)){if(n&&("response.output_item.done"===a.type&&"item"in a&&e.responsesApiToolCalls.push(a.item),"response.output_text.delta"===a.type&&"delta"in a&&a.delta))e.responseTexts.push(a.delta);else if("response"in a){const{response:t}=a;e.responseId=null!=(o=t.id)?o:e.responseId,e.responseModel=null!=(s=t.model)?s:e.responseModel,e.responseTimestamp=null!=(i=t.created_at)?i:e.responseTimestamp,t.usage&&(e.promptTokens=t.usage.input_tokens,e.completionTokens=t.usage.output_tokens,e.totalTokens=t.usage.total_tokens),t.status&&e.finishReasons.push(t.status),n&&t.output_text&&e.responseTexts.push(t.output_text)}}else e.eventTypes.push(a.type)}function Qs(t,e,n){var r;if(!e||"object"!=typeof e)return;const o=e;if(function(t){return null!==t&&"object"==typeof t&&"object"in t&&"chat.completion"===t.object}(o)){if(function(t,e,n){if(Vs(t,e.id,e.model,e.created),e.usage&&Ks(t,e.usage.prompt_tokens,e.usage.completion_tokens,e.usage.total_tokens),Array.isArray(e.choices)){const r=e.choices.map((t=>t.finish_reason)).filter((t=>null!==t));if(r.length>0&&t.setAttributes({[us]:JSON.stringify(r)}),n){const n=e.choices.map((t=>{var e;return null==(e=t.message)?void 0:e.tool_calls})).filter((t=>Array.isArray(t)&&t.length>0)).flat();n.length>0&&t.setAttributes({[bs]:JSON.stringify(n)})}}}(t,o,n),n&&(null==(r=o.choices)?void 0:r.length)){const e=o.choices.map((t=>{var e;return(null==(e=t.message)?void 0:e.content)||""}));t.setAttributes({[_s]:JSON.stringify(e)})}}else!function(t){return null!==t&&"object"==typeof t&&"object"in t&&"response"===t.object}(o)?function(t){if(null===t||"object"!=typeof t||!("object"in t))return!1;const e=t;return"list"===e.object&&"string"==typeof e.model&&e.model.toLowerCase().includes("embedding")}(o)&&function(t,e){t.setAttributes({[ks]:e.model,[ls]:e.model}),e.usage&&Ks(t,e.usage.prompt_tokens,void 0,e.usage.total_tokens)}(t,o):(!function(t,e,n){if(Vs(t,e.id,e.model,e.created_at),e.status&&t.setAttributes({[us]:JSON.stringify([e.status])}),e.usage&&Ks(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.total_tokens),n){const n=e;if(Array.isArray(n.output)&&n.output.length>0){const e=n.output.filter((t=>"object"==typeof t&&null!==t&&"function_call"===t.type));e.length>0&&t.setAttributes({[bs]:JSON.stringify(e)})}}}(t,o,n),n&&o.output_text&&t.setAttributes({[_s]:o.output_text}))}function ti(t,e){if("messages"in e){const n=qs(e.messages);t.setAttributes({[gs]:n})}if("input"in e){const n=qs(e.input);t.setAttributes({[gs]:n})}}function ei(t,e,n,r){return function(...o){return p(this,null,(function*(){const s=r||function(){var t,e,n,r;const o=Ft().getClient(),s=null==o?void 0:o.getIntegrationByName("OpenAI"),i=!!s&&Boolean(null==o?void 0:o.getOptions().sendDefaultPii);return{recordInputs:null!=(e=null==(t=null==s?void 0:s.options)?void 0:t.recordInputs)?e:i,recordOutputs:null!=(r=null==(n=null==s?void 0:s.options)?void 0:n.recordOutputs)?r:i}}(),i=function(t,e){var n;const r={[ts]:"openai",[hs]:Hs(e),[Kt]:"auto.ai.openai"};if(t.length>0&&"object"==typeof t[0]&&null!==t[0]){const e=t[0],n=[...Array.isArray(e.tools)?e.tools:[],...e.web_search_options&&"object"==typeof e.web_search_options?[c({type:"web_search_options"},e.web_search_options)]:[]];n.length>0&&(r[ys]=JSON.stringify(n))}if(t.length>0&&"object"==typeof t[0]&&null!==t[0]){const e=t[0];r[es]=null!=(n=e.model)?n:"unknown","temperature"in e&&(r[rs]=e.temperature),"top_p"in e&&(r[as]=e.top_p),"frequency_penalty"in e&&(r[ss]=e.frequency_penalty),"presence_penalty"in e&&(r[is]=e.presence_penalty),"stream"in e&&(r[ns]=e.stream),"encoding_format"in e&&(r["gen_ai.request.encoding_format"]=e.encoding_format),"dimensions"in e&&(r["gen_ai.request.dimensions"]=e.dimensions)}else r[es]="unknown";return r}(o,e),a=i[es]||"unknown",u=Hs(e),l=o[0];return l&&"object"==typeof l&&!0===l.stream?_n({name:`${u} ${a} stream-response`,op:Ws(e),attributes:i},(r=>p(null,null,(function*(){var i;try{s.recordInputs&&o[0]&&"object"==typeof o[0]&&ti(r,o[0]);return function(t,e,n){return f(this,null,(function*(){const r={eventTypes:[],responseTexts:[],finishReasons:[],responseId:"",responseModel:"",responseTimestamp:0,promptTokens:void 0,completionTokens:void 0,totalTokens:void 0,chatCompletionToolCalls:{},responsesApiToolCalls:[]};try{try{for(var o,s,i,a=m(t);o=!(s=yield new d(a.next())).done;o=!1){const t=s.value;Gs(t)?Zs(t,r,n):zs(t)&&Xs(t,r,n,e),yield t}}catch(s){i=[s]}finally{try{o&&(s=a.return)&&(yield new d(s.call(a)))}finally{if(i)throw i[0]}}}finally{Vs(e,r.responseId,r.responseModel,r.responseTimestamp),Ks(e,r.promptTokens,r.completionTokens,r.totalTokens),e.setAttributes({[vs]:!0}),r.finishReasons.length&&e.setAttributes({[us]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length&&e.setAttributes({[_s]:r.responseTexts.join("")});const t=[...Object.values(r.chatCompletionToolCalls),...r.responsesApiToolCalls];t.length>0&&e.setAttributes({[bs]:JSON.stringify(t)}),e.end()}}))}(yield t.apply(n,o),r,null!=(i=s.recordOutputs)&&i)}catch(a){throw r.setStatus({code:2,message:"internal_error"}),Hn(a,{mechanism:{handled:!1,type:"auto.ai.openai.stream",data:{function:e}}}),r.end(),a}})))):gn({name:`${u} ${a}`,op:Ws(e),attributes:i},(r=>p(null,null,(function*(){try{s.recordInputs&&o[0]&&"object"==typeof o[0]&&ti(r,o[0]);const e=yield t.apply(n,o);return Qs(r,e,s.recordOutputs),e}catch(i){throw Hn(i,{mechanism:{handled:!1,type:"auto.ai.openai",data:{function:e}}}),i}}))))}))}}function ni(t,e="",n){return new Proxy(t,{get(t,r){const o=t[r],s=function(t,e){return t?`${t}.${e}`:e}(e,String(r));return"function"==typeof o&&function(t){return Bs.includes(t)}(s)?ei(o,s,t,n):"function"==typeof o?o.bind(t):o&&"object"==typeof o?ni(o,s,n):o}})}function ri(t,e){return ni(t,"",e)}function oi(t,e,n,r){if(!t||"object"!=typeof t)return;const o=function(t,e){var n,r;return"type"in t&&"string"==typeof t.type&&"error"===t.type&&(e.setStatus({code:2,message:null!=(r=null==(n=t.error)?void 0:n.type)?r:"internal_error"}),Hn(t.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}),!0)}(t,r);o||(function(t,e){if("message_delta"===t.type&&t.usage&&"output_tokens"in t.usage&&"number"==typeof t.usage.output_tokens&&(e.completionTokens=t.usage.output_tokens),t.message){const n=t.message;n.id&&(e.responseId=n.id),n.model&&(e.responseModel=n.model),n.stop_reason&&e.finishReasons.push(n.stop_reason),n.usage&&("number"==typeof n.usage.input_tokens&&(e.promptTokens=n.usage.input_tokens),"number"==typeof n.usage.cache_creation_input_tokens&&(e.cacheCreationInputTokens=n.usage.cache_creation_input_tokens),"number"==typeof n.usage.cache_read_input_tokens&&(e.cacheReadInputTokens=n.usage.cache_read_input_tokens))}}(t,e),function(t,e){"content_block_start"===t.type&&"number"==typeof t.index&&t.content_block&&("tool_use"!==t.content_block.type&&"server_tool_use"!==t.content_block.type||(e.activeToolBlocks[t.index]={id:t.content_block.id,name:t.content_block.name,inputJsonParts:[]}))}(t,e),function(t,e,n){if("content_block_delta"===t.type&&t.delta){if("number"==typeof t.index&&"partial_json"in t.delta&&"string"==typeof t.delta.partial_json){const n=e.activeToolBlocks[t.index];n&&n.inputJsonParts.push(t.delta.partial_json)}n&&"string"==typeof t.delta.text&&e.responseTexts.push(t.delta.text)}}(t,e,n),function(t,e){if("content_block_stop"!==t.type||"number"!=typeof t.index)return;const n=e.activeToolBlocks[t.index];if(!n)return;const r=n.inputJsonParts.join("");let o;try{o=r?JSON.parse(r):{}}catch(s){o={__unparsed:r}}e.toolCalls.push({type:"tool_use",id:n.id,name:n.name,input:o}),delete e.activeToolBlocks[t.index]}(t,e))}function si(t,e,n){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};return t.on("streamEvent",(t=>{oi(t,r,n,e)})),t.on("message",(()=>{!function(t,e,n){e.isRecording()&&(t.responseId&&e.setAttributes({[ps]:t.responseId}),t.responseModel&&e.setAttributes({[ls]:t.responseModel}),Us(e,t.promptTokens,t.completionTokens,t.cacheCreationInputTokens,t.cacheReadInputTokens),e.setAttributes({[vs]:!0}),t.finishReasons.length>0&&e.setAttributes({[us]:JSON.stringify(t.finishReasons)}),n&&t.responseTexts.length>0&&e.setAttributes({[_s]:t.responseTexts.join("")}),n&&t.toolCalls.length>0&&e.setAttributes({[bs]:JSON.stringify(t.toolCalls)}),e.end())}(r,e,n)})),t.on("error",(t=>{Hn(t,{mechanism:{handled:!1,type:"auto.ai.anthropic.stream_error"}}),e.isRecording()&&(e.setStatus({code:2,message:"stream_error"}),e.end())})),t}const ii=["messages.create","messages.stream","messages.countTokens","models.get","completions.create","models.retrieve","beta.messages.create"];function ai(t,e){if("messages"in e){const n=qs(e.messages);t.setAttributes({[gs]:n})}if("input"in e){const n=qs(e.input);t.setAttributes({[gs]:n})}"prompt"in e&&t.setAttributes({[Qo]:JSON.stringify(e.prompt)})}function ci(t,e,n){e&&"object"==typeof e&&("type"in e&&"error"===e.type?function(t,e){e.error&&(t.setStatus({code:2,message:e.error.type||"internal_error"}),Hn(e.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}))}(t,e):(n&&function(t,e){if("content"in e&&Array.isArray(e.content)){t.setAttributes({[_s]:e.content.map((t=>t.text)).filter((t=>!!t)).join("")});const n=[];for(const t of e.content)"tool_use"!==t.type&&"server_tool_use"!==t.type||n.push(t);n.length>0&&t.setAttributes({[bs]:JSON.stringify(n)})}"completion"in e&&t.setAttributes({[_s]:e.completion}),"input_tokens"in e&&t.setAttributes({[_s]:JSON.stringify(e.input_tokens)})}(t,e),function(t,e){"id"in e&&"model"in e&&(t.setAttributes({[ps]:e.id,[ls]:e.model}),"created"in e&&"number"==typeof e.created&&t.setAttributes({[As]:new Date(1e3*e.created).toISOString()}),"created_at"in e&&"number"==typeof e.created_at&&t.setAttributes({[As]:new Date(1e3*e.created_at).toISOString()}),"usage"in e&&e.usage&&Us(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.cache_creation_input_tokens,e.usage.cache_read_input_tokens))}(t,e)))}function ui(t,e,n){throw Hn(t,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:n}}}),e.isRecording()&&(e.setStatus({code:2,message:"internal_error"}),e.end()),t}function li(t,e,n,r,o,s,i,a,c,u,l){var h;const g={name:`${s} ${null!=(h=o[es])?h:"unknown"} stream-response`,op:Ls(i),attributes:o};return _n(g,u&&!l?e=>p(null,null,(function*(){var o;try{c.recordInputs&&a&&ai(e,a);return function(t,e,n){return f(this,null,(function*(){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};try{try{for(var o,s,i,a=m(t);o=!(s=yield new d(a.next())).done;o=!1){const t=s.value;oi(t,r,n,e),yield t}}catch(s){i=[s]}finally{try{o&&(s=a.return)&&(yield new d(s.call(a)))}finally{if(i)throw i[0]}}}finally{r.responseId&&e.setAttributes({[ps]:r.responseId}),r.responseModel&&e.setAttributes({[ls]:r.responseModel}),Us(e,r.promptTokens,r.completionTokens,r.cacheCreationInputTokens,r.cacheReadInputTokens),e.setAttributes({[vs]:!0}),r.finishReasons.length>0&&e.setAttributes({[us]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length>0&&e.setAttributes({[_s]:r.responseTexts.join("")}),n&&r.toolCalls.length>0&&e.setAttributes({[bs]:JSON.stringify(r.toolCalls)}),e.end()}}))}(yield t.apply(n,r),e,null!=(o=c.recordOutputs)&&o)}catch(s){return ui(s,e,i)}})):t=>{var o;try{c.recordInputs&&a&&ai(t,a);return si(e.apply(n,r),t,null!=(o=c.recordOutputs)&&o)}catch(s){return ui(s,t,i)}})}function pi(t,e,n,r){return new Proxy(t,{apply(o,s,i){var a;const c=function(t,e){var n;const r={[ts]:"anthropic",[hs]:Ds(e),[Kt]:"auto.ai.anthropic"};if(t.length>0&&"object"==typeof t[0]&&null!==t[0]){const e=t[0];e.tools&&Array.isArray(e.tools)&&(r[ys]=JSON.stringify(e.tools)),r[es]=null!=(n=e.model)?n:"unknown","temperature"in e&&(r[rs]=e.temperature),"top_p"in e&&(r[as]=e.top_p),"stream"in e&&(r[ns]=e.stream),"top_k"in e&&(r[cs]=e.top_k),"frequency_penalty"in e&&(r[ss]=e.frequency_penalty),"max_tokens"in e&&(r[os]=e.max_tokens)}else r[es]="models.retrieve"===e||"models.get"===e?t[0]:"unknown";return r}(i,e),u=null!=(a=c[es])?a:"unknown",l=Ds(e),p="object"==typeof i[0]?i[0]:void 0,d=Boolean(null==p?void 0:p.stream),f="messages.stream"===e;return d||f?li(t,o,n,i,c,l,e,p,r,d,f):gn({name:`${l} ${u}`,op:Ls(e),attributes:c},(t=>(r.recordInputs&&p&&ai(t,p),mn((()=>o.apply(n,i)),(t=>{Hn(t,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:e}}})}),(()=>{}),(e=>ci(t,e,r.recordOutputs))))))}})}function di(t,e="",n){return new Proxy(t,{get(t,r){const o=t[r],s=Fs(e,String(r));return"function"==typeof o&&function(t){return ii.includes(t)}(s)?pi(o,s,t,n):"function"==typeof o?o.bind(t):o&&"object"==typeof o?di(o,s,n):o}})}function fi(t,e){var n;const r=Boolean(null==(n=Jt())?void 0:n.getOptions().sendDefaultPii);return di(t,"",c({recordInputs:r,recordOutputs:r},e))}const mi=["models.generateContent","models.generateContentStream","chats.create","sendMessage","sendMessageStream"],hi="chats.create";function gi(t,e,n,r){t&&!function(t,e){var n;const r=null==t?void 0:t.promptFeedback;if(null==r?void 0:r.blockReason){const t=null!=(n=r.blockReasonMessage)?n:r.blockReason;return e.setStatus({code:2,message:`Content blocked: ${t}`}),Hn(`Content blocked: ${t}`,{mechanism:{handled:!1,type:"auto.ai.google_genai"}}),!0}return!1}(t,r)&&(function(t,e){"string"==typeof t.responseId&&(e.responseId=t.responseId),"string"==typeof t.modelVersion&&(e.responseModel=t.modelVersion);const n=t.usageMetadata;n&&("number"==typeof n.promptTokenCount&&(e.promptTokens=n.promptTokenCount),"number"==typeof n.candidatesTokenCount&&(e.completionTokens=n.candidatesTokenCount),"number"==typeof n.totalTokenCount&&(e.totalTokens=n.totalTokenCount))}(t,e),function(t,e,n){var r,o,s;Array.isArray(t.functionCalls)&&e.toolCalls.push(...t.functionCalls);for(const i of null!=(r=t.candidates)?r:[]){(null==i?void 0:i.finishReason)&&!e.finishReasons.includes(i.finishReason)&&e.finishReasons.push(i.finishReason);for(const t of null!=(s=null==(o=null==i?void 0:i.content)?void 0:o.parts)?s:[])n&&t.text&&e.responseTexts.push(t.text),t.functionCall&&e.toolCalls.push({type:"function",id:t.functionCall.id,name:t.functionCall.name,arguments:t.functionCall.args})}}(t,e,n))}function _i(t,e){if("model"in t&&"string"==typeof t.model)return t.model;if(e&&"object"==typeof e){const t=e;if("model"in t&&"string"==typeof t.model)return t.model;if("modelVersion"in t&&"string"==typeof t.modelVersion)return t.modelVersion}return"unknown"}function yi(t,e,n){const r={[ts]:"google_genai",[hs]:Ds(t),[Kt]:"auto.ai.google_genai"};if(e){if(r[es]=_i(e,n),"config"in e&&"object"==typeof e.config&&e.config){const t=e.config;if(Object.assign(r,function(t){const e={};return"temperature"in t&&"number"==typeof t.temperature&&(e[rs]=t.temperature),"topP"in t&&"number"==typeof t.topP&&(e[as]=t.topP),"topK"in t&&"number"==typeof t.topK&&(e[cs]=t.topK),"maxOutputTokens"in t&&"number"==typeof t.maxOutputTokens&&(e[os]=t.maxOutputTokens),"frequencyPenalty"in t&&"number"==typeof t.frequencyPenalty&&(e[ss]=t.frequencyPenalty),"presencePenalty"in t&&"number"==typeof t.presencePenalty&&(e[is]=t.presencePenalty),e}(t)),"tools"in t&&Array.isArray(t.tools)){const e=t.tools.flatMap((t=>t.functionDeclarations));r[ys]=JSON.stringify(e)}}}else r[es]=_i({},n);return r}function vi(t,e){if("contents"in e){const n=qs(e.contents);t.setAttributes({[gs]:n})}if("message"in e){const n=qs(e.message);t.setAttributes({[gs]:n})}if("history"in e){const n=qs(e.history);t.setAttributes({[gs]:n})}}function bi(t,e,n,r){const o=e===hi;return new Proxy(t,{apply(t,s,i){var a;const c=i[0],u=yi(e,c,n),l=null!=(a=u[es])?a:"unknown",h=Ds(e);return function(t){return t.includes("Stream")||t.endsWith("generateContentStream")||t.endsWith("sendMessageStream")}(e)?_n({name:`${h} ${l} stream-response`,op:Ls(e),attributes:u},(o=>p(null,null,(function*(){try{r.recordInputs&&c&&vi(o,c);return function(t,e,n){return f(this,null,(function*(){const r={responseTexts:[],finishReasons:[],toolCalls:[]};try{try{for(var o,s,i,a=m(t);o=!(s=yield new d(a.next())).done;o=!1){const t=s.value;gi(t,r,n,e),yield t}}catch(s){i=[s]}finally{try{o&&(s=a.return)&&(yield new d(s.call(a)))}finally{if(i)throw i[0]}}}finally{const t={[vs]:!0};r.responseId&&(t[ps]=r.responseId),r.responseModel&&(t[ls]=r.responseModel),void 0!==r.promptTokens&&(t[ds]=r.promptTokens),void 0!==r.completionTokens&&(t[fs]=r.completionTokens),void 0!==r.totalTokens&&(t[ms]=r.totalTokens),r.finishReasons.length&&(t[us]=JSON.stringify(r.finishReasons)),n&&r.responseTexts.length&&(t[_s]=r.responseTexts.join("")),n&&r.toolCalls.length&&(t[bs]=JSON.stringify(r.toolCalls)),e.setAttributes(t),e.end()}}))}(yield t.apply(n,i),o,Boolean(r.recordOutputs))}catch(s){throw o.setStatus({code:2,message:"internal_error"}),Hn(s,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}}),o.end(),s}})))):gn({name:o?`${h} ${l} create`:`${h} ${l}`,op:Ls(e),attributes:u},(s=>(r.recordInputs&&c&&vi(s,c),mn((()=>t.apply(n,i)),(t=>{Hn(t,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}})}),(()=>{}),(t=>{o||function(t,e,n){if(e&&"object"==typeof e){if(e.usageMetadata&&"object"==typeof e.usageMetadata){const n=e.usageMetadata;"number"==typeof n.promptTokenCount&&t.setAttributes({[ds]:n.promptTokenCount}),"number"==typeof n.candidatesTokenCount&&t.setAttributes({[fs]:n.candidatesTokenCount}),"number"==typeof n.totalTokenCount&&t.setAttributes({[ms]:n.totalTokenCount})}if(n&&Array.isArray(e.candidates)&&e.candidates.length>0){const n=e.candidates.map((t=>{var e;return(null==(e=t.content)?void 0:e.parts)&&Array.isArray(t.content.parts)?t.content.parts.map((t=>"string"==typeof t.text?t.text:"")).filter((t=>t.length>0)).join(""):""})).filter((t=>t.length>0));n.length>0&&t.setAttributes({[_s]:n.join("")})}if(n&&e.functionCalls){const n=e.functionCalls;Array.isArray(n)&&n.length>0&&t.setAttributes({[bs]:JSON.stringify(n)})}}}(s,t,r.recordOutputs)})))))}})}function Si(t,e="",n){return new Proxy(t,{get:(t,r,o)=>{const s=Reflect.get(t,r,o),i=Fs(e,String(r));if("function"==typeof s&&function(t){if(mi.includes(t))return!0;const e=t.split(".").pop();return mi.includes(e)}(i)){if(i===hi){const e=bi(s,i,t,n);return function(...t){const r=e(...t);return r&&"object"==typeof r?Si(r,"chat",n):r}}return bi(s,i,t,n)}return"function"==typeof s?s.bind(t):s&&"object"==typeof s?Si(s,i,n):s}})}function ki(t,e){var n;const r=Boolean(null==(n=Jt())?void 0:n.getOptions().sendDefaultPii);return Si(t,"",c({recordInputs:r,recordOutputs:r},e))}function xi(t){t(Ft())}const wi="sentry.javascript.miniapp",Ei="10.27.0-rc.1",Ti="?",Ii=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Oi=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,Ai=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,$i=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ci=/\((\S*)(?::(\d+))(?::(\d+))\)/,ji=/^\s*at (.*?) ?\((\S*):(\d+):(\d+)\)/i;function Mi(t){let e=null;const n=t&&t.framesToPop;try{if(e=function(t){if(!t||!t.stacktrace)return null;const e=t.stacktrace,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,o=e.split("\n"),s=[];let i;for(let a=0;a<o.length;a+=2){let t=null;(i=n.exec(o[a]))?t={url:i[2],func:i[3],args:[],line:+i[1],column:null}:(i=r.exec(o[a]))&&(t={url:i[6],func:i[3]||i[4],args:i[5]?i[5].split(","):[],line:+i[1],column:+i[2]}),t&&(!t.func&&t.line&&(t.func=Ti),s.push(t))}if(!s.length)return null;return{message:Ni(t),name:t.name,stack:s}}(t),e)return Pi(e,n)}catch(r){}try{if(e=function(t){if(!t||!t.stack)return null;const e=[],n=t.stack.split("\n");let r,o,s,i;for(let a=0;a<n.length;++a){if(s=Ii.exec(n[a])){const t=s[2]&&0===s[2].indexOf("native");r=s[2]&&0===s[2].indexOf("eval"),r&&(o=Ci.exec(s[2]))&&(s[2]=o[1],s[3]=o[2],s[4]=o[3]),i={url:s[2],func:s[1]||Ti,args:t?[s[2]]:[],line:s[3]?+s[3]:null,column:s[4]?+s[4]:null}}else if(s=Ai.exec(n[a]))i={url:s[2],func:s[1]||Ti,args:[],line:+s[3],column:s[4]?+s[4]:null};else if(s=Oi.exec(n[a]))r=s[3]&&s[3].indexOf(" > eval")>-1,r&&(o=$i.exec(s[3]))?(s[1]=s[1]||"eval",s[3]=o[1],s[4]=o[2],s[5]=""):0!==a||s[5]||void 0===t.columnNumber||(e[0].column=t.columnNumber+1),i={url:s[3],func:s[1]||Ti,args:s[2]?s[2].split(","):[],line:s[4]?+s[4]:null,column:s[5]?+s[5]:null};else{if(!(s=ji.exec(n[a])))continue;i={url:s[2],func:s[1]||Ti,args:[],line:s[3]?+s[3]:null,column:s[4]?+s[4]:null}}!i.func&&i.line&&(i.func=Ti),e.push(i)}if(!e.length)return null;return{message:Ni(t),name:t.name,stack:e}}(t),e)return Pi(e,n)}catch(r){}return{message:Ni(t),name:t&&t.name,stack:[],failed:!0}}function Pi(t,e){try{return u(c({},t),{stack:t.stack.slice(e)})}catch(n){return t}}function Ni(t){const e=t&&t.message;return e?e.error&&"string"==typeof e.error.message?e.error.message:e:"No error message"}function Ri(t){const e=Li(t.stack),n={type:t.name,value:t.message};return e&&e.length&&(n.stacktrace={frames:e}),void 0===n.type&&""===n.value&&(n.value="Unrecoverable error caught"),n}function Di(t){return{exception:{values:[Ri(t)]}}}function Li(t){if(!t||!t.length)return[];let e=t;const n=e[0].func||"",r=e[e.length-1].func||"";return-1===n.indexOf("captureMessage")&&-1===n.indexOf("captureException")||(e=e.slice(1)),-1!==r.indexOf("sentryWrapped")&&(e=e.slice(0,-1)),e.map((t=>({colno:null===t.column?void 0:t.column,filename:t.url||e[0].url,function:t.func||"?",in_app:!0,lineno:null===t.line?void 0:t.line}))).slice(0,100).reverse()}function Fi(t,e,n={}){let r;if(H(t,"ErrorEvent")&&t.error){return r=Di(Mi(t=t.error)),r}if(W(t)||function(t){return H(t,"DOMException")}(t)){const o=t,s=o.name||(W(o)?"DOMError":"DOMException"),i=o.message?`${s}: ${o.message}`:s;return r=Ui(i,e,n),vt(r,i),r}if(J(t))return r=Di(Mi(t)),r;if(V(t)||Y(t)){return r=function(t,e,n){const r={exception:{values:[{type:Y(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:`Non-Error ${n?"promise rejection":"exception"} captured with keys: ${lt(t)}`}]},extra:{__serialized__:Ve(t)}};if(e){const t=Li(Mi(e).stack);r.stacktrace={frames:t}}return r}(t,e,n.rejection),bt(r,{synthetic:!0}),r}return r=Ui(t,e,n),vt(r,`${t}`),bt(r,{synthetic:!0}),r}function Ui(t,e,n={}){const r={message:t};if(n.attachStacktrace&&e){const t=Li(Mi(e).stack);r.stacktrace={frames:t}}return r}const qi=(()=>{let t={request:()=>{},httpRequest:()=>{},getSystemInfoSync:()=>{},getPerformance:()=>({}),onAppHide:function(t){},canIUse:function(t){return!1}};if("object"==typeof wx)t=wx;else if("object"==typeof my)t=my;else if("object"==typeof tt)t=tt;else if("object"==typeof dd)t=dd;else if("object"==typeof qq)t=qq;else{if("object"!=typeof swan)throw new Error("sentry-miniapp ");t=swan}return t})(),Bi=(()=>{let t="unknown";return"object"==typeof wx?t="wechat":"object"==typeof my?t="alipay":"object"==typeof tt?t="bytedance":"object"==typeof dd?t="dingtalk":"object"==typeof qq?t="qq":"object"==typeof swan&&(t="swan"),t})();function Ji(t){return wr(t,(function(e){return new Cn(((n,r)=>{const o=qi.request||qi.httpRequest;"function"==typeof o?o({url:t.url,method:"POST",data:e.body,header:{"content-type":"application/json"},success(t){var e,r,o,s;n({statusCode:null==t?void 0:t.statusCode,headers:{"x-sentry-rate-limits":null!=(r=null==(e=null==t?void 0:t.headers)?void 0:e["X-Sentry-Rate-Limits"])?r:null,"retry-after":null!=(s=null==(o=null==t?void 0:t.headers)?void 0:o["Retry-After"])?s:null}})},fail(t){r(t)}}):r(new Error("Miniapp request function is not available"))}))}))}const Hi=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,makeMiniappTransport:Ji},Symbol.toStringTag,{value:"Module"})),Wi=()=>[];class zi extends Nr{constructor(t={}){const e=t.transport||Ji,n=t.stackParser||Wi,r=t.integrations||t.defaultIntegrations||[],o=u(c({},t),{transport:e,stackParser:n,integrations:r,dsn:t.dsn,tracesSampleRate:t.tracesSampleRate});!function(t,e,n=[e],r="npm"){const o=t._metadata||{};o.sdk||(o.sdk={name:`sentry.javascript.${e}`,packages:n.map((t=>({name:`${r}:@sentry/${t}`,version:v}))),version:v}),t._metadata=o}(o,"miniapp",["miniapp"]),super(o)}_prepareEvent(t,e,n,r){return t.platform=t.platform||"javascript",t.sdk=u(c({},t.sdk),{name:wi,packages:[...t.sdk&&t.sdk.packages||[],{name:"npm:@sentry/miniapp",version:Ei}],version:Ei}),super._prepareEvent(t,e,n,r)}showReportDialog(t={}){console.log("sentry-miniapp ",t)}eventFromException(t,e){const n=Fi(t,e&&e.syntheticException?e.syntheticException:void 0,{attachStacktrace:this._options.attachStacktrace});return e&&e.event_id&&(n.event_id=e.event_id),Promise.resolve(n)}eventFromMessage(t,e="info",n){const r=n&&n.syntheticException?n.syntheticException:void 0,o=Ui(String(t),r,{attachStacktrace:this._options.attachStacktrace});return o.level=e,n&&n.event_id&&(o.event_id=n.event_id),Promise.resolve(o)}}function Gi(t,e={},n){if("function"!=typeof t)return t;try{const e=t.__sentry_wrapped__;if(e)return e;if(it(t))return t}catch(o){return t}const r=function(...n){try{const r=n.map((t=>Gi(t,e)));return t.handleEvent?t.handleEvent.apply(this,r):t.apply(this,r)}catch(r){throw setTimeout((()=>{})),Bt((t=>{t.addEventProcessor((t=>{const r=c({},t);return e.mechanism&&(vt(r,void 0),bt(r,e.mechanism)),r.extra=u(c({},r.extra),{arguments:Ke(n,3)}),r})),Hn(r)})),r}};try{for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}catch(o){}st(r,t),ot(t,"__sentry_wrapped__",r);try{const e=Object.getOwnPropertyDescriptor(r,"name");(null==e?void 0:e.configurable)&&Object.defineProperty(r,"name",{get:()=>t.name})}catch(o){}return r}const Ki=class t{constructor(e){this.name=t.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._onPageNotFoundHandlerInstalled=!1,this._onMemoryWarningHandlerInstalled=!1,this._options=c({onerror:!0,onunhandledrejection:!0,onpagenotfound:!0,onmemorywarning:!0},e)}setupOnce(){Error.stackTraceLimit=50,this._options.onerror&&(A.log("Global Handler attached: onError"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(A.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler()),this._options.onpagenotfound&&(A.log("Global Handler attached: onPageNotFound"),this._installGlobalOnPageNotFoundHandler()),this._options.onmemorywarning&&(A.log("Global Handler attached: onMemoryWarning"),this._installGlobalOnMemoryWarningHandler())}_installGlobalOnErrorHandler(){this._onErrorHandlerInstalled||(qi.onError&&qi.onError((t=>{Hn("string"==typeof t?new Error(t):t)})),this._onErrorHandlerInstalled=!0)}_installGlobalOnUnhandledRejectionHandler(){this._onUnhandledRejectionHandlerInstalled||(qi.onUnhandledRejection&&qi.onUnhandledRejection((({reason:t,promise:e})=>{Hn("string"==typeof t?new Error(t):t,{data:e})})),this._onUnhandledRejectionHandlerInstalled=!0)}_installGlobalOnPageNotFoundHandler(){this._onPageNotFoundHandlerInstalled||(qi.onPageNotFound&&qi.onPageNotFound((t=>{const e=t.path.split("?")[0];Zn("pagenotfound",e),Vn("message",JSON.stringify(t)),Wn(`: ${e}`)})),this._onPageNotFoundHandlerInstalled=!0)}_installGlobalOnMemoryWarningHandler(){this._onMemoryWarningHandlerInstalled||(qi.onMemoryWarning&&qi.onMemoryWarning((({level:t=-1})=>{let e="";switch(t){case 5:e="TRIM_MEMORY_RUNNING_MODERATE";break;case 10:e="TRIM_MEMORY_RUNNING_LOW";break;case 15:e="TRIM_MEMORY_RUNNING_CRITICAL";break;default:return}Zn("memory-warning",String(t)),Vn("message",e),Wn("")})),this._onMemoryWarningHandlerInstalled=!0)}};Ki.id="GlobalHandlers";let Vi=Ki;const Yi=class t{constructor(){this._ignoreOnError=0,this.name=t.id}_wrapTimeFunction(t){return function(...e){const n=e[0];return e[0]=Gi(n,{mechanism:{data:{function:Xi(t)},handled:!0,type:"instrument"}}),t.apply(this,e)}}_wrapRAF(t){return function(e){return t(Gi(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Xi(t)},handled:!0,type:"instrument"}}))}}_wrapEventTarget(t){const e=y,n=e[t]&&e[t].prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(rt(n,"addEventListener",(function(e){return function(n,r,o){try{"function"==typeof r.handleEvent&&(r.handleEvent=Gi(r.handleEvent.bind(r),{mechanism:{data:{function:"handleEvent",handler:Xi(r),target:t},handled:!0,type:"instrument"}}))}catch(s){}return e.call(this,n,Gi(r,{mechanism:{data:{function:"addEventListener",handler:Xi(r),target:t},handled:!0,type:"instrument"}}),o)}})),rt(n,"removeEventListener",(function(t){return function(e,n,r){let o=n;try{o=o&&(o.__sentry_wrapped__||o)}catch(s){}return t.call(this,e,o,r)}})))}setupOnce(){this._ignoreOnError=this._ignoreOnError;const t=y;rt(t,"setTimeout",this._wrapTimeFunction.bind(this)),rt(t,"setInterval",this._wrapTimeFunction.bind(this)),rt(t,"requestAnimationFrame",this._wrapRAF.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))}};Yi.id="TryCatch";let Zi=Yi;function Xi(t){try{return t&&t.name||"<anonymous>"}catch(e){return"<anonymous>"}}const Qi=class t{constructor(e={}){this.name=t.id,this._key=e.key||"cause",this._limit=e.limit||5}setupOnce(){tr(((e,n)=>{const r=Jt(),o=r&&r.getIntegrationByName(t.id);return o?o._handler(e,n):e}))}_handler(t,e){if(!(t.exception&&t.exception.values&&e&&e.originalException instanceof Error))return t;const n=this._walkErrorTree(e.originalException,this._key);return t.exception.values=[...n,...t.exception.values],t}_walkErrorTree(t,e,n=[]){if(!(t[e]instanceof Error)||n.length+1>=this._limit)return n;const r=Ri(Mi(t[e]));return this._walkErrorTree(t[e],e,[r,...n])}};Qi.id="LinkedErrors";let ta=Qi;const ea=class t{constructor(){this.name=t.id}setupOnce(){tr((e=>{const n=Jt();if(n&&n.getIntegrationByName(t.id))try{const t=qi.getSystemInfoSync(),{SDKVersion:n="0.0.0",batteryLevel:r,currentBattery:o,battery:s,brand:i,language:a,model:l,pixelRatio:p,platform:d,screenHeight:f,screenWidth:m,system:h,version:g,app:_,appName:y}=t,[v,b]=h.split(" "),S=u(c({},e.tags),{SDKVersion:n}),k=_||y||Bi||"app";return u(c({},e),{tags:S,contexts:u(c({},e.contexts),{device:{brand:i,battery_level:r||o||s,model:l,language:a,platform:d,screen_dpi:p,screen_height:f,screen_width:m},os:{name:v||h,version:b||h},browser:{name:k,version:g}})})}catch(r){console.warn(`sentry-miniapp get system info fail: ${r}`)}return e}))}};ea.id="System";let na=ea;const ra=class t{constructor(e){this.name=t.id,this._options=c({enable:!0},e)}setupOnce(){tr((e=>{const n=Jt();if(n&&n.getIntegrationByName(t.id)&&this._options.enable)try{const t=getCurrentPages().map((t=>({route:t.route,options:t.options})));return u(c({},e),{extra:u(c({},e.extra),{routers:t})})}catch(r){console.warn(`sentry-miniapp get router info fail: ${r}`)}return e}))}};ra.id="Router";let oa=ra;const sa=class t{constructor(){this.name=t.id}setupOnce(){tr((e=>{const n=Jt();if(n&&n.getIntegrationByName(t.id)&&"wechat"===Bi&&qi.getLaunchOptionsSync){if(1129===qi.getLaunchOptionsSync().scene)return null}return e}))}};sa.id="IgnoreMpcrawlerErrors";let ia=sa;const aa=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,GlobalHandlers:Vi,IgnoreMpcrawlerErrors:ia,LinkedErrors:ta,Router:oa,System:na,TryCatch:Zi},Symbol.toStringTag,{value:"Module"})),ca=[to(),Zr(),new Zi,new Vi,new ta,new na,new oa,new ia];function ua(t={}){void 0===t.defaultIntegrations&&(t.defaultIntegrations=ca),t.normalizeDepth=t.normalizeDepth||5;const e=c({integrations:t.integrations||t.defaultIntegrations||[],stackParser:t.stackParser||(()=>[]),transport:t.transport||Ji},t);Jr(zi,e)}function la(t={}){t.eventId||(t.eventId=Qn());const e=Jt();e&&e.showReportDialog(t)}function pa(){return Qn()}function da(t){const e=Jt();return e?e.flush(t):An(!1)}function fa(t){const e=Jt();return e?e.close(t):An(!1)}function ma(t){return Gi(t)()}function ha(t){return t/1e3}class ga{constructor(t=!1){this._reportAllChanges=t,this._measurements={}}addPerformanceEntriesFromSpan(t){const e=this._getPerformance();if(!e)return;const n=Ee(t).start_timestamp;this._timeOrigin=this._getTimeOrigin(e,n),this._stopObserver(),this._applyMeasurementsToSpan()}startObserving(t){var e;const n=this._getPerformance();if(!n)return;const r=Ee(t);this._timeOrigin=this._getTimeOrigin(n,r.start_timestamp),this._measurements={},this._observer=null==(e=n.createObserver)?void 0:e.call(n,(e=>{var n;const r=(null==(n=null==e?void 0:e.getEntries)?void 0:n.call(e))||[],o=Ee(t);void 0===o.timestamp?r.forEach((e=>this._handleEntry(t,e,o.start_timestamp))):this._stopObserver()})),this._observer&&this._observer.observe({entryTypes:["navigation","render","script","loadPackage","resource"]})}_getPerformance(){if(!qi.getPerformance)return;const t=qi.getPerformance();return t&&"function"==typeof t.createObserver?t:void 0}_getTimeOrigin(t,e){if("number"==typeof t.timeOrigin)return ha(t.timeOrigin);const n="function"==typeof t.now?t.now():void 0;return"number"==typeof n?ha(Date.now()-n):e}_handleEntry(t,e,n){const r=this._toTimestamp(e.startTime,n),o=this._toTimestamp(e.startTime+e.duration,n),s=yn({name:this._getDescription(e)||e.entryType,op:this._mapOp(e),startTime:r,attributes:this._buildSpanAttributes(e)});s&&s.end(o),this._recordMeasurements(e,n,r)}_mapOp(t){switch(t.entryType){case"navigation":return"navigation";case"render":return"ui.render";case"script":return"script";case"loadPackage":return"resource.package";case"resource":return"resource";default:return t.entryType||"custom"}}_getDescription(t){return t.path||t.moduleName||t.name}_buildSpanAttributes(t){const e={"performance.entry_type":t.entryType};return t.moduleName&&(e["performance.module_name"]=t.moduleName),t.path&&(e["performance.path"]=t.path),"number"==typeof t.duration&&(e["performance.duration_ms"]=t.duration),e}_recordMeasurements(t,e,n){const r=(t.name||"").toLowerCase(),o=t.duration,s=Math.max(1e3*(n-e),0);if("first-paint"===r||"firstpaint"===r?this._measurements.fp={value:s,unit:"millisecond"}:"first-contentful-paint"===r||"firstcontentfulpaint"===r?this._measurements.fcp={value:s,unit:"millisecond"}:"largest-contentful-paint"===r||"largestcontentfulpaint"===r||"lcp"===r?this._measurements.lcp={value:s,unit:"millisecond"}:"first-input-delay"!==r&&"firstinputdelay"!==r&&"fid"!==r||"number"!=typeof o?"navigation"!==t.entryType||"number"!=typeof o||this._measurements.navigation||(this._measurements.navigation={value:o,unit:"millisecond"}):this._measurements.fid={value:o,unit:"millisecond"},this._reportAllChanges&&"number"==typeof o){const e=this._measurementKey(t);e&&!this._measurements[e]&&(this._measurements[e]={value:o,unit:"millisecond"})}}_measurementKey(t){const e=t.name||t.entryType;if(e)return e.replace(/\s+/g,"_").toLowerCase()}_toTimestamp(t,e){var n;if(t>1e12)return ha(t);return(null!=(n=this._timeOrigin)?n:e)+ha(t)}_applyMeasurementsToSpan(){for(const[t,e]of Object.entries(this._measurements))un(t,e.value,e.unit)}_stopObserver(){var t;null==(t=this._observer)||t.disconnect(),this._observer=void 0}}const _a="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function ya(){const t=Me(),e=t&&je(t);if(!e)return;const n=Ee(e).op;return"navigation"===n||"pageload"===n?e:void 0}function va(t){return{name:t.path||"unknown",source:"url"}}function ba(t,e){const n={[Kt]:e};return t.openType&&(n["miniapp.open_type"]=t.openType),void 0!==t.scene&&(n["miniapp.scene"]=t.scene),void 0!==t.isTabBar&&(n["miniapp.is_tabbar"]=t.isTabBar),void 0!==t.webviewId&&(n["miniapp.webview_id"]=t.webviewId),t.query&&(n["miniapp.query"]=t.query),n}function Sa(t,e){const{instrumentPageLoad:n=!0,instrumentNavigation:r=!0}=t,o=y,s=o.wx||o.my;if(!s)return void(_a&&A.warn("[MiniAppTracing] No miniapp global object found"));const i=qi.onAppRoute||s.onAppRoute,a=qi.onAppRouteDone||s.onAppRouteDone,c=qi.onBeforePageLoad||s.onBeforePageLoad,u=qi.onAfterPageLoad||s.onAfterPageLoad;if("function"!=typeof i)return void(_a&&A.warn("[MiniAppTracing] onAppRoute not available"));let l=!0,p=!1;if(n&&"function"==typeof o.getCurrentPages){const t=o.getCurrentPages()||[],n=t[t.length-1];if(null==n?void 0:n.route){p=!0,l=!1;ka({path:n.route,openType:"appLaunch"},e)}}i((t=>{const o=function(t){return{path:(null==t?void 0:t.path)||(null==t?void 0:t.route)||(null==t?void 0:t.url)||"unknown-route",query:null==t?void 0:t.query,scene:null==t?void 0:t.scene,openType:null==t?void 0:t.openType,isTabBar:null==t?void 0:t.isTabBar,webviewId:null==t?void 0:t.webviewId}}(t),s=!p&&function(t,e=!1){return"appLaunch"===t||!!e}(o.openType,l);if(l&&(l=!1),s&&n)return p=!0,void ka(o,e);r&&p&&function(t,e){const{name:n,source:r}=va(t),o=ba(t,"auto.navigation.miniapp");o[Wt]=r,Ft().setTransactionName(n),e({name:n,op:"navigation",attributes:o}),_a&&A.log(`[MiniAppTracing] Created navigation span: ${n}`)}(o,e)})),"function"==typeof a&&a((t=>{_a&&A.log("[MiniAppTracing] Route done:",null==t?void 0:t.path)})),"function"==typeof c&&c((t=>{_a&&A.log("[MiniAppTracing] Before page load:",null==t?void 0:t.path)})),"function"==typeof u&&u((t=>{_a&&A.log("[MiniAppTracing] After page load:",null==t?void 0:t.path)}))}function ka(t,e){const{name:n,source:r}=va(t),o=ba(t,"auto.pageload.miniapp");o[Wt]=r;const s=ya();if(s){"custom"!==(Ee(s).data||{})[Wt]&&(s.updateName(n),s.setAttribute(Wt,r)),s.setAttributes(o),_a&&A.log(`[MiniAppTracing] Updated pageload span: ${n}`)}else Ft().setTransactionName(n),e({name:n,op:"pageload",attributes:o}),_a&&A.log(`[MiniAppTracing] Created pageload span: ${n}`)}function xa(){return ya()}let wa,Ea;function Ta(){return wa||(wa={traceId:It(),spanId:Ot(),sampleRand:Math.random()}),wa}const Ia="_sentry_miniapp_idleSpan";function Oa(t){return t[Ia]}function Aa(t,e){ot(t,Ia,e)}const $a=c({idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3,instrumentPageLoad:!0,instrumentNavigation:!0,traceContinuityMode:"link",consistentTraceSampling:!1},{traceRequest:!0});function Ca(t={}){const e=c(c({},$a),t),{idleTimeout:n,finalTimeout:r,childSpanTimeout:o,instrumentPageLoad:s,instrumentNavigation:i,traceContinuityMode:a,consistentTraceSampling:u,beforeStartSpan:l,_metricOptions:p}=e;let d,f,m;return{name:"MiniAppTracing",setupOnce(){d=new ga(null==p?void 0:p._reportAllChanges)},setup(t){var e;null==(e=qi.onAppHide)||e.call(qi,(()=>{const e=Oa(t);e&&!Ee(e).timestamp&&(_a&&A.log("[MiniAppTracing] App hiding, finishing active span"),e.setAttribute(Vt,"appHide"),e.end())}))},afterAllSetup(t){Sa({instrumentPageLoad:s,instrumentNavigation:i},(e=>{ja(t,e,{idleTimeout:n,finalTimeout:r,childSpanTimeout:o,traceContinuityMode:a,consistentTraceSampling:u,beforeStartSpan:l,metricsInstrumentation:d,latestRoute:{get name(){return f},set name(t){f=t},get source(){return m},set source(t){m=t}}})}))}}}function ja(t,e,n){const{idleTimeout:r,finalTimeout:o,childSpanTimeout:s,traceContinuityMode:i,consistentTraceSampling:a,beforeStartSpan:l,metricsInstrumentation:p,latestRoute:d}=n;!function(t){const e=Oa(t);e&&!Ee(e).timestamp&&(_a&&A.log(`[MiniAppTracing] Finishing current active span with op: ${Ee(e).op}`),e.setAttribute(Vt,"navigationStart"),e.end())}(t);const f=function(t,e){var n;if("off"===t){return void Ft().setPropagationContext({traceId:It(),sampleRand:Math.random()})}const r=Ea,o=!!Ea&&Date.now()/1e3-Ea.startTimestamp<=3600;if("session"===t){const t=Ta();return Ft().setPropagationContext(c({traceId:t.traceId,sampleRand:t.sampleRand},e&&o&&r&&{sampled:1===r.spanContext.traceFlags})),void(_a&&A.log(`[MiniAppTracing] Session mode: reusing traceId=${t.traceId}`))}if("link"===t){const t=function(t=!1){return wa={traceId:t&&wa?wa.traceId:It(),spanId:Ot(),sampleRand:Math.random()},wa}(!1);if(Ft().setPropagationContext(c({traceId:t.traceId,sampleRand:t.sampleRand},e&&o&&r&&{sampled:1===r.spanContext.traceFlags})),o&&r)return _a&&A.log(`[MiniAppTracing] Link mode: new traceId=${t.traceId}, linked from ${r.spanContext.traceId}`),[{context:{traceId:r.spanContext.traceId,spanId:r.spanContext.spanId,traceFlags:null!=(n=r.spanContext.traceFlags)?n:0},attributes:{"sentry.link.type":"previous_trace"}}]}return}(i,a),m=l?l(e):e;f&&f.length>0&&(m.links=[...m.links||[],...f]);const h=m.attributes||{};d.name=m.name,d.source=h[Wt];const g=On(m,{idleTimeout:r,finalTimeout:o,childSpanTimeout:s,beforeSpanEnd:e=>{var n;null==p||p.addPerformanceEntriesFromSpan(e),Aa(t,void 0);const r=Ft(),o=r.getPropagationContext();r.setPropagationContext(u(c({},o),{traceId:e.spanContext().traceId,sampled:Te(e),dsc:ze(e)}));const s=Ee(e);var i,a,l,d,f,m;i=e.spanContext().traceId,a=e.spanContext().spanId,l=Te(e),d=s.start_timestamp,f=1,m=null!=(n=o.sampleRand)?n:Math.random(),Ea={spanContext:{traceId:i,spanId:a,traceFlags:l?1:0},startTimestamp:d,sampleRate:f,sampleRand:m},_a&&A.log(`[MiniAppTracing] Span ended: ${s.op} - ${s.description}, traceId=${e.spanContext().traceId}`)}});return g.setAttribute("miniapp.trace_continuity_mode",i),Aa(t,g),_a&&A.log(`[MiniAppTracing] Started ${e.op} span: ${e.name}, traceId=${g.spanContext().traceId}`),g}function Ma(){const t=Jt();return t?Oa(t):void 0}export{aa as Integrations,zi as MiniappClient,wi as SDK_NAME,Ei as SDK_VERSION,Hi as Transports,Kr as addBreadcrumb,tr as addEventProcessor,fo as captureConsoleIntegration,zn as captureEvent,Hn as captureException,Wn as captureMessage,fa as close,xi as configureScope,zo as consoleLoggingIntegration,Yo as createConsolaReporter,ca as defaultIntegrations,mo as extraErrorDataIntegration,qo as featureFlagsIntegration,da as flush,xa as getActiveMiniAppRootSpan,Ma as getActiveMiniAppSpan,Me as getActiveSpan,Ft as getCurrentScope,je as getRootSpan,Ce as getSpanDescendants,ee as getSpanStatusFromHttpCode,ua as init,fi as instrumentAnthropicAiClient,ki as instrumentGoogleGenAIClient,Sa as instrumentMiniAppRouter,ri as instrumentOpenAiClient,Co as instrumentSupabaseClient,pa as lastEventId,Jo as logger,Wr as makeMultiplexedTransport,Ko as metrics,Ca as miniappTracingIntegration,co as moduleMetadataIntegration,Re as registerSpanErrorInstrumentation,bo as rewriteFramesIntegration,Gn as setContext,Vn as setExtra,Kn as setExtras,ne as setHttpStatus,un as setMeasurement,Zn as setTag,Yn as setTags,Xn as setUser,la as showReportDialog,yn as startInactiveSpan,ja as startMiniAppTracingNavigationSpan,bn as startNewTrace,gn as startSpan,_n as startSpanManual,jo as supabaseIntegration,Do as thirdPartyErrorFilterIntegration,vn as withActiveSpan,Bt as withScope,ma as wrap,Ro as zodErrorsIntegration};
