"use strict";var so=Object.defineProperty,io=Object.defineProperties;var oo=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var Or=Object.prototype.hasOwnProperty,Mr=Object.prototype.propertyIsEnumerable;var pn=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t);var vr=(t,e,n)=>e in t?so(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))Or.call(e,n)&&vr(t,n,e[n]);if(ye)for(var n of ye(e))Mr.call(e,n)&&vr(t,n,e[n]);return t},b=(t,e)=>io(t,oo(e));var dn=(t,e)=>{var n={};for(var r in t)Or.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ye)for(var r of ye(t))e.indexOf(r)<0&&Mr.call(t,r)&&(n[r]=t[r]);return n};var F=(t,e,n)=>new Promise((r,s)=>{var i=c=>{try{a(n.next(c))}catch(u){s(u)}},o=c=>{try{a(n.throw(c))}catch(u){s(u)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,o);a((n=n.apply(t,e)).next())}),it=function(t,e){this[0]=t,this[1]=e},Se=(t,e,n)=>{var r=(o,a,c,u)=>{try{var f=n[o](a),d=(a=f.value)instanceof it,m=f.done;Promise.resolve(d?a[0]:a).then(l=>d?r(o==="return"?o:"next",a[1]?{done:l.done,value:l.value}:l,c,u):c({value:l,done:m})).catch(l=>r("throw",l,c,u))}catch(l){u(l)}},s=o=>i[o]=a=>new Promise((c,u)=>r(o,a,c,u)),i={};return n=n.apply(t,e),i[pn("asyncIterator")]=()=>i,s("next"),s("throw"),s("return"),i};var Ee=(t,e,n)=>(e=t[pn("asyncIterator")])?e.call(t):(t=t[pn("iterator")](),e={},n=(r,s)=>(s=t[r])&&(e[r]=i=>new Promise((o,a,c)=>(i=s.call(t,i),c=i.done,Promise.resolve(i.value).then(u=>o({value:u,done:c}),a)))),n("next"),n("return"),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const wr=typeof globalThis!="undefined"&&globalThis||typeof self!="undefined"&&self||typeof window!="undefined"&&window||typeof global!="undefined"&&global||{};class ao{constructor(e){if(this._entries=[],!!e){if(typeof e=="string"){const n=e.startsWith("?")?e.slice(1):e;n.length>0&&n.split("&").forEach(r=>{if(!r)return;const[s,i=""]=r.split("=");this.append(decodeURIComponent(s),decodeURIComponent(i))});return}if(Array.isArray(e)){e.forEach(([n,r])=>this.append(n,r));return}Object.keys(e).forEach(n=>{const r=e[n];r!=null&&this.append(n,String(r))})}}append(e,n){this._entries.push([e,n])}toString(){return this._entries.map(([e,n])=>`${encodeURIComponent(e)}=${encodeURIComponent(n)}`).join("&")}}wr.URLSearchParams||(wr.URLSearchParams=ao);const S=typeof __SENTRY_DEBUG__=="undefined"||__SENTRY_DEBUG__,I=globalThis,dt="10.27.0";function Dt(){return Ve(I),I}function Ve(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||dt,e[dt]=e[dt]||{}}function $t(t,e,n=I){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[dt]=r[dt]||{};return s[t]||(s[t]=e())}const Hn=["debug","info","warn","error","log","assert","trace"],co="Sentry Logger ",Me={};function Lt(t){if(!("console"in I))return t();const e=I.console,n={},r=Object.keys(Me);r.forEach(s=>{const i=Me[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function uo(){qn().enabled=!0}function lo(){qn().enabled=!1}function xs(){return qn().enabled}function fo(...t){zn("log",...t)}function po(...t){zn("warn",...t)}function mo(...t){zn("error",...t)}function zn(t,...e){S&&xs()&&Lt(()=>{I.console[t](`${co}[${t}]:`,...e)})}function qn(){return S?$t("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const g={enable:uo,disable:lo,isEnabled:xs,log:fo,warn:po,error:mo},mn="<anonymous>";function Ds(t){try{return!t||typeof t!="function"?mn:t.name||mn}catch(e){return mn}}function _o(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch(r){return}}}function $s(t){return"__v_isVNode"in t&&t.__v_isVNode?"[VueVNode]":"[VueViewModel]"}const Re={},Cr={};function Wn(t,e){Re[t]=Re[t]||[],Re[t].push(e)}function Jn(t,e){if(!Cr[t]){Cr[t]=!0;try{e()}catch(n){S&&g.error(`Error while instrumenting ${t}`,n)}}}function Vn(t,e){const n=t&&Re[t];if(n)for(const r of n)try{r(e)}catch(s){S&&g.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Ds(r)}
Error:`,s)}}let _n=null;function go(t){const e="error";Wn(e,t),Jn(e,ho)}function ho(){_n=I.onerror,I.onerror=function(t,e,n,r,s){return Vn("error",{column:r,error:s,line:n,msg:t,url:e}),_n?_n.apply(this,arguments):!1},I.onerror.__SENTRY_INSTRUMENTED__=!0}let gn=null;function yo(t){const e="unhandledrejection";Wn(e,t),Jn(e,So)}function So(){gn=I.onunhandledrejection,I.onunhandledrejection=function(t){return Vn("unhandledrejection",t),gn?gn.apply(this,arguments):!0},I.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Ls=Object.prototype.toString;function mt(t){switch(Ls.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Xe(t,Error)}}function Ft(t,e){return Ls.call(t)===`[object ${e}]`}function Fs(t){return Ft(t,"ErrorEvent")}function Pr(t){return Ft(t,"DOMError")}function Eo(t){return Ft(t,"DOMException")}function we(t){return Ft(t,"String")}function Ye(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Yn(t){return t===null||Ye(t)||typeof t!="object"&&typeof t!="function"}function St(t){return Ft(t,"Object")}function Ke(t){return typeof Event!="undefined"&&Xe(t,Event)}function bo(t){return typeof Element!="undefined"&&Xe(t,Element)}function To(t){return Ft(t,"RegExp")}function Ut(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function Io(t){return St(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Xe(t,e){try{return t instanceof e}catch(n){return!1}}function Us(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue||t.__v_isVNode))}const Ao=I,Ro=80;function No(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const f=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||Ro;for(;n&&i++<r&&(u=ko(n,f),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch(n){return"<unknown>"}}function ko(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(Ao.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&we(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function kt(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&js(s,r);try{t[e]=s}catch(i){S&&g.log(`Failed to replace method "${e}" in object`,t)}}function W(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch(r){S&&g.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function js(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,W(t,"__sentry_original__",e)}catch(n){}}function Bs(t){return t.__sentry_original__}function Gs(t){if(mt(t))return p({message:t.message,name:t.name,stack:t.stack},Dr(t));if(Ke(t)){const e=p({type:t.type,target:xr(t.target),currentTarget:xr(t.currentTarget)},Dr(t));return typeof CustomEvent!="undefined"&&Xe(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function xr(t){try{return bo(t)?No(t):Object.prototype.toString.call(t)}catch(e){return"<unknown>"}}function Dr(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function vo(t){const e=Object.keys(Gs(t));return e.sort(),e[0]?e.join(", "):"[object has no keys]"}function ne(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function $r(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{Us(s)?n.push($s(s)):n.push(String(s))}catch(i){n.push("[value cannot be serialized]")}}return n.join(e)}function Ne(t,e,n=!1){return we(t)?To(e)?e.test(t):we(e)?n?t===e:t.includes(e):!1:!1}function Ze(t,e=[],n=!1){return e.some(r=>Ne(t,r,n))}function Oo(){const t=I;return t.crypto||t.msCrypto}let hn;function Mo(){return Math.random()*16}function V(t=Oo()){try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"")}catch(e){}return hn||(hn="10000000100040008000"+1e11),hn.replace(/[018]/g,e=>(e^(Mo()&15)>>e/4).toString(16))}function Hs(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}function vt(t){const{message:e,event_id:n}=t;if(e)return e;const r=Hs(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Rn(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function ct(t,e){const n=Hs(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism=p(p(p({},r),s),e),e&&"data"in e){const i=p(p({},s==null?void 0:s.data),e.data);n.mechanism.data=i}}function Lr(t){if(wo(t))return!0;try{W(t,"__sentry_captured__",!0)}catch(e){}return!1}function wo(t){try{return t.__sentry_captured__}catch(e){}}const zs=1e3;function ae(){return Date.now()/zs}function Co(){const{performance:t}=I;if(!(t!=null&&t.now)||!t.timeOrigin)return ae;const e=t.timeOrigin;return()=>(e+t.now())/zs}let be;function z(){return(be!=null?be:be=Co())()}function Nn(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||z(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:V()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function ce(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r=p({},t);for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=ce(r[s],e[s],n-1));return r}function ut(){return V()}function jt(){return V().substring(16)}const kn="_sentrySpan";function Et(t,e){e?W(t,kn,e):delete t[kn]}function wt(t){return t[kn]}const Po=100;class K{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:ut(),sampleRand:Math.random()}}clone(){const e=new K;return e._breadcrumbs=[...this._breadcrumbs],e._tags=p({},this._tags),e._attributes=p({},this._attributes),e._extra=p({},this._extra),e._contexts=p({},this._contexts),this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata=p({},this._sdkProcessingMetadata),e._propagationContext=p({},this._propagationContext),e._client=this._client,e._lastEventId=this._lastEventId,Et(e,wt(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Nn(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags=p(p({},this._tags),e),this._notifyScopeListeners(),this}setTag(e,n){return this.setTags({[e]:n})}setAttributes(e){return this._attributes=p(p({},this._attributes),e),this._notifyScopeListeners(),this}setAttribute(e,n){return this.setAttributes({[e]:n})}removeAttribute(e){return e in this._attributes&&(delete this._attributes[e],this._notifyScopeListeners()),this}setExtras(e){return this._extra=p(p({},this._extra),e),this._notifyScopeListeners(),this}setExtra(e,n){return this._extra=b(p({},this._extra),{[e]:n}),this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof K?n.getScopeData():St(n)?e:void 0,{tags:s,attributes:i,extra:o,user:a,contexts:c,level:u,fingerprint:f=[],propagationContext:d}=r||{};return this._tags=p(p({},this._tags),s),this._attributes=p(p({},this._attributes),i),this._extra=p(p({},this._extra),o),this._contexts=p(p({},this._contexts),c),a&&Object.keys(a).length&&(this._user=a),u&&(this._level=u),f.length&&(this._fingerprint=f),d&&(this._propagationContext=d),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Et(this,void 0),this._attachments=[],this.setPropagationContext({traceId:ut(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:Po;if(r<=0)return this;const s=b(p({timestamp:ae()},e),{message:e.message?ne(e.message,2048):e.message});return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:wt(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=ce(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||V();if(!this._client)return S&&g.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,b(p({originalException:e,syntheticException:s},n),{event_id:r}),this),r}captureMessage(e,n,r){var o;const s=(r==null?void 0:r.event_id)||V();if(!this._client)return S&&g.warn("No client configured on scope - will not capture message!"),s;const i=(o=r==null?void 0:r.syntheticException)!=null?o:new Error(e);return this._client.captureMessage(e,n,b(p({originalException:e,syntheticException:i},r),{event_id:s}),this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||V();return this._client?(this._client.captureEvent(e,b(p({},n),{event_id:r}),this),r):(S&&g.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function xo(){return $t("defaultCurrentScope",()=>new K)}function Do(){return $t("defaultIsolationScope",()=>new K)}class $o{constructor(e,n){let r;e?r=e:r=new K;let s;n?s=n:s=new K,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Ut(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Ct(){const t=Dt(),e=Ve(t);return e.stack=e.stack||new $o(xo(),Do())}function Lo(t){return Ct().withScope(t)}function Fo(t,e){const n=Ct();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function Fr(t){return Ct().withScope(()=>t(Ct().getIsolationScope()))}function Uo(){return{withIsolationScope:Fr,withScope:Lo,withSetScope:Fo,withSetIsolationScope:(t,e)=>Fr(e),getCurrentScope:()=>Ct().getScope(),getIsolationScope:()=>Ct().getIsolationScope()}}function ue(t){const e=Ve(t);return e.acs?e.acs:Uo()}function O(){const t=Dt();return ue(t).getCurrentScope()}function j(){const t=Dt();return ue(t).getIsolationScope()}function Kn(){return $t("globalScope",()=>new K)}function rt(...t){const e=Dt(),n=ue(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function M(){return O().getClient()}function qs(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,i={trace_id:n,span_id:s||jt()};return r&&(i.parent_span_id=r),i}const nt="sentry.source",Ws="sentry.sample_rate",jo="sentry.previous_trace_sample_rate",re="sentry.op",L="sentry.origin",se="sentry.idle_span_finish_reason",Js="sentry.measurement_unit",Vs="sentry.measurement_value",Ur="sentry.custom_span_name",Xn="sentry.profile_id",Zn="sentry.exclusive_time",Bo=0,Qe=1,v=2;function Ys(t){if(t<400&&t>=100)return{code:Qe};if(t>=400&&t<500)switch(t){case 401:return{code:v,message:"unauthenticated"};case 403:return{code:v,message:"permission_denied"};case 404:return{code:v,message:"not_found"};case 409:return{code:v,message:"already_exists"};case 413:return{code:v,message:"failed_precondition"};case 429:return{code:v,message:"resource_exhausted"};case 499:return{code:v,message:"cancelled"};default:return{code:v,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:v,message:"unimplemented"};case 503:return{code:v,message:"unavailable"};case 504:return{code:v,message:"deadline_exceeded"};default:return{code:v,message:"internal_error"}}return{code:v,message:"internal_error"}}function vn(t,e){t.setAttribute("http.response.status_code",e);const n=Ys(e);n.message!=="unknown_error"&&t.setStatus(n)}const Ks="_sentryScope",Xs="_sentryIsolationScope";function Go(t){try{const e=I.WeakRef;if(typeof e=="function")return new e(t)}catch(e){}return t}function Ho(t){if(t){if(typeof t=="object"&&"deref"in t&&typeof t.deref=="function")try{return t.deref()}catch(e){return}return t}}function zo(t,e,n){t&&(W(t,Xs,Go(n)),W(t,Ks,e))}function Ce(t){const e=t;return{scope:e[Ks],isolationScope:Ho(e[Xs])}}const qo="sentry-",Wo=/^sentry-/;function Jo(t){const e=Vo(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(Wo)){const o=s.slice(qo.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function Vo(t){if(!(!t||!we(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=jr(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):jr(t)}function jr(t){return t.split(",").map(e=>{const n=e.indexOf("=");if(n===-1)return[];const r=e.slice(0,n),s=e.slice(n+1);return[r,s].map(i=>{try{return decodeURIComponent(i.trim())}catch(o){return}})}).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}const Yo=/^o(\d+)\./,Ko=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Xo(t){return t==="http"||t==="https"}function Bt(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function Zs(t){const e=Ko.exec(t);if(!e){Lt(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",o="",a=""]=e.slice(1);let c="",u=a;const f=u.split("/");if(f.length>1&&(c=f.slice(0,-1).join("/"),u=f.pop()),u){const d=u.match(/^\d+/);d&&(u=d[0])}return Qs({host:i,pass:s,path:c,projectId:u,port:o,protocol:n,publicKey:r})}function Qs(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Zo(t){if(!S)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(g.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Xo(r)?e&&isNaN(parseInt(e,10))?(g.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(g.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(g.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Qo(t){const e=t.match(Yo);return e==null?void 0:e[1]}function ta(t){const e=t.getOptions(),{host:n}=t.getDsn()||{};let r;return e.orgId?r=String(e.orgId):n&&(r=Qo(n)),r}function ea(t){const e=typeof t=="string"?Zs(t):Qs(t);if(!(!e||!Zo(e)))return e}function Qn(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const ti=0,tr=1;let Br=!1;function na(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=N(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function ei(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:N(t).parent_span_id,i=Ce(t).scope,o=r?(i==null?void 0:i.getPropagationContext().propagationSpanId)||jt():e;return{parent_span_id:s,span_id:o,trace_id:n}}function ni(t){if(t&&t.length>0)return t.map(o=>{var a=o,{context:c}=a,u=c,{spanId:e,traceId:n,traceFlags:r}=u,s=dn(u,["spanId","traceId","traceFlags"]),{attributes:i}=a;return p({span_id:e,trace_id:n,sampled:r===tr,attributes:i},s)})}function _t(t){return typeof t=="number"?Gr(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Gr(t.getTime()):z()}function Gr(t){return t>9999999999?t/1e3:t}function N(t){var r;if(sa(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(ra(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,f="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:f,start_timestamp:_t(i),timestamp:_t(a)||void 0,status:ri(c),op:s[re],origin:s[L],links:ni(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function ra(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function sa(t){return typeof t.getSpanJSON=="function"}function bt(t){const{traceFlags:e}=t.spanContext();return e===tr}function ri(t){if(!(!t||t.code===Bo))return t.code===Qe?"ok":t.message||"internal_error"}const gt="_sentryChildSpans",On="_sentryRootSpan";function si(t,e){const n=t[On]||t;W(e,On,n),t[gt]?t[gt].add(e):W(t,gt,new Set([e]))}function ia(t,e){t[gt]&&t[gt].delete(e)}function Xt(t){const e=new Set;function n(r){if(!e.has(r)&&bt(r)){e.add(r);const s=r[gt]?Array.from(r[gt]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function H(t){return t[On]||t}function It(){const t=Dt(),e=ue(t);return e.getActiveSpan?e.getActiveSpan():wt(O())}function Mn(){Br||(Lt(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")}),Br=!0)}let Hr=!1;function oa(){if(Hr)return;function t(){const e=It(),n=e&&H(e);if(n){const r="internal_error";S&&g.log(`[Tracing] Root span: ${r} -> Global error occurred`),n.setStatus({code:v,message:r})}}t.tag="sentry_tracingErrorCallback",Hr=!0,go(t),yo(t)}function tn(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=M())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}function zr(t){g.log(`Ignoring span ${t.op} - ${t.description} because it matches \`ignoreSpans\`.`)}function Pe(t,e){if(!(e!=null&&e.length)||!t.description)return!1;for(const n of e){if(ca(n)){if(Ne(t.description,n))return S&&zr(t),!0;continue}if(!n.name&&!n.op)continue;const r=n.name?Ne(t.description,n.name):!0,s=n.op?t.op&&Ne(t.op,n.op):!0;if(r&&s)return S&&zr(t),!0}return!1}function aa(t,e){const n=e.parent_span_id,r=e.span_id;if(n)for(const s of t)s.parent_span_id===r&&(s.parent_span_id=n)}function ca(t){return typeof t=="string"||t instanceof RegExp}const er="production",ii="_frozenDsc";function ke(t,e){W(t,ii,e)}function oi(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},s={environment:n.environment||er,release:n.release,public_key:r,trace_id:t,org_id:ta(e)};return e.emit("createDsc",s),s}function ai(t,e){const n=e.getPropagationContext();return n.dsc||oi(n.traceId,t)}function lt(t){var h,y,_,E;const e=M();if(!e)return{};const n=H(t),r=N(n),s=r.data,i=n.spanContext().traceState,o=(y=(h=i==null?void 0:i.get("sentry.sample_rate"))!=null?h:s[Ws])!=null?y:s[jo];function a(T){return(typeof o=="number"||typeof o=="string")&&(T.sample_rate=`${o}`),T}const c=n[ii];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),f=u&&Jo(u);if(f)return a(f);const d=oi(t.spanContext().traceId,e),m=s[nt],l=r.description;return m!=="url"&&l&&(d.transaction=l),tn()&&(d.sampled=String(bt(n)),d.sample_rand=(E=i==null?void 0:i.get("sentry.sample_rand"))!=null?E:(_=Ce(n).scope)==null?void 0:_.getPropagationContext().sampleRand.toString()),a(d),e.emit("createDsc",d,n),d}class Tt{constructor(e={}){this._traceId=e.traceId||ut(),this._spanId=e.spanId||jt()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:ti}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}function G(t,e=100,n=1/0){try{return wn("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function ci(t,e=3,n=100*1024){const r=G(t,e);return pa(r)>n?ci(t,e-1,n):r}function wn(t,e,n=1/0,r=1/0,s=da()){const[i,o]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=ua(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const u=e;if(u&&typeof u.toJSON=="function")try{const l=u.toJSON();return wn("",l,c-1,r,s)}catch(l){}const f=Array.isArray(e)?[]:{};let d=0;const m=Gs(e);for(const l in m){if(!Object.prototype.hasOwnProperty.call(m,l))continue;if(d>=r){f[l]="[MaxProperties ~]";break}const h=m[l];f[l]=wn(l,h,c-1,r,s),d++}return o(e),f}function ua(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global!="undefined"&&e===global)return"[Global]";if(typeof window!="undefined"&&e===window)return"[Window]";if(typeof document!="undefined"&&e===document)return"[Document]";if(Us(e))return $s(e);if(Io(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Ds(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=la(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function la(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function fa(t){return~-encodeURI(t).split(/%..|./).length}function pa(t){return fa(JSON.stringify(t))}function da(){const t=new WeakSet;function e(r){return t.has(r)?!0:(t.add(r),!1)}function n(r){t.delete(r)}return[e,n]}function ft(t,e=[]){return[t,e]}function ma(t,e){const[n,r]=t;return[n,[...r,e]]}function ie(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function Cn(t){const e=Ve(I);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function _a(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[Cn(r),i]:r.push(typeof i=="string"?Cn(i):i)}for(const i of n){const[o,a]=i;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let c;try{c=JSON.stringify(a)}catch(u){c=JSON.stringify(G(a))}s(c)}}return typeof r=="string"?r:ga(r)}function ga(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function ha(t){return[{type:"span"},t]}function ya(t){const e=typeof t.data=="string"?Cn(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const Sa={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function qr(t){return Sa[t]}function ui(t){if(!(t!=null&&t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function Ea(t,e,n,r){var i;const s=(i=t.sdkProcessingMetadata)==null?void 0:i.dynamicSamplingContext;return p(p(p({event_id:t.event_id,sent_at:new Date().toISOString()},e&&{sdk:e}),!!n&&r&&{dsn:Bt(r)}),s&&{trace:s})}function ba(t,e){var r,s,i,o;if(!e)return t;const n=t.sdk||{};return t.sdk=b(p({},n),{name:n.name||e.name,version:n.version||e.version,integrations:[...((r=t.sdk)==null?void 0:r.integrations)||[],...e.integrations||[]],packages:[...((s=t.sdk)==null?void 0:s.packages)||[],...e.packages||[]],settings:(i=t.sdk)!=null&&i.settings||e.settings?p(p({},(o=t.sdk)==null?void 0:o.settings),e.settings):void 0}),t}function Ta(t,e,n,r){const s=ui(n),i=p(p({sent_at:new Date().toISOString()},s&&{sdk:s}),!!r&&e&&{dsn:Bt(e)}),o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return ft(i,[o])}function Ia(t,e,n,r){const s=ui(n),i=t.type&&t.type!=="replay_event"?t.type:"event";ba(t,n==null?void 0:n.sdk);const o=Ea(t,s,r,e);return delete t.sdkProcessingMetadata,ft(o,[[{type:i},t]])}function Aa(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=lt(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o=p(p({sent_at:new Date().toISOString()},n(r)&&{trace:r}),!!i&&s&&{dsn:Bt(s)}),{beforeSendSpan:a,ignoreSpans:c}=(e==null?void 0:e.getOptions())||{},u=c!=null&&c.length?t.filter(l=>!Pe(N(l),c)):t,f=t.length-u.length;f&&(e==null||e.recordDroppedEvent("before_send","span",f));const d=a?l=>{const h=N(l),y=a(h);return y||(Mn(),h)}:N,m=[];for(const l of u){const h=d(l);h&&m.push(ha(h))}return ft(o,m)}function Ra(t){if(!S)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=N(t),{spanId:s}=t.spanContext(),i=bt(t),o=H(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:f,description:d}=N(o);u.push(`root ID: ${o.spanContext().spanId}`),f&&u.push(`root op: ${f}`),d&&u.push(`root description: ${d}`)}g.log(`${c}
  ${u.join(`
  `)}`)}function Na(t){if(!S)return;const{description:e="< unknown name >",op:n="< unknown op >"}=N(t),{spanId:r}=t.spanContext(),i=H(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;g.log(o)}function li(t,e,n,r=It()){const s=r&&H(r);s&&(S&&g.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[Vs]:e,[Js]:n}))}function Wr(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[Js],i=r[Vs];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const Jr=1e3;class en{constructor(e={}){this._traceId=e.traceId||ut(),this._spanId=e.spanId||jt(),this._startTime=e.startTimestamp||z(),this._links=e.links,this._attributes={},this.setAttributes(p({[L]:"manual",[re]:e.op},e.attributes)),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?tr:ti}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=_t(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(nt,"custom"),this}end(e){this._endTime||(this._endTime=_t(e),Na(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[re],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:ri(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[L],profile_id:this._attributes[Xn],exclusive_time:this._attributes[Zn],measurements:Wr(this._events),is_segment:this._isStandaloneSpan&&H(this)===this||void 0,segment_id:this._isStandaloneSpan?H(this).spanContext().spanId:void 0,links:ni(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){S&&g.log("[Tracing] Adding an event to span:",e);const s=Vr(n)?n:r||z(),i=Vr(n)?{}:n||{},o={name:e,time:_t(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=M();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===H(this)))return;if(this._isStandaloneSpan){this._sampled?va(Aa([this],e)):(S&&g.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(Ce(this).scope||O()).captureEvent(r)}_convertSpanToTransaction(){var f;if(!Yr(N(this)))return;this._name||(S&&g.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=Ce(this),r=(f=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:f.normalizedRequest;if(this._sampled!==!0)return;const i=Xt(this).filter(d=>d!==this&&!ka(d)).map(d=>N(d)).filter(Yr),o=this._attributes[nt];delete this._attributes[Ur],i.forEach(d=>{delete d.data[Ur]});const a=p({contexts:{trace:na(this)},spans:i.length>Jr?i.sort((d,m)=>d.start_timestamp-m.start_timestamp).slice(0,Jr):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:lt(this)},request:r},o&&{transaction_info:{source:o}}),c=Wr(this._events);return c&&Object.keys(c).length&&(S&&g.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}}function Vr(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function Yr(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function ka(t){return t instanceof en&&t.isStandaloneSpan()}function va(t){const e=M();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}function nn(t,e,n=()=>{},r=()=>{}){let s;try{s=t()}catch(i){throw e(i),n(),i}return Oa(s,e,n,r)}function Oa(t,e,n,r){return Ut(t)?t.then(s=>(n(),r(s),s),s=>{throw e(s),n(),s}):(n(),r(t),t)}function Ma(t,e,n){if(!tn(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler(b(p({},e),{inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a})),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate!="undefined"&&(s=t.tracesSampleRate,r=!0);const i=Qn(s);if(i===void 0)return S&&g.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return S&&g.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||S&&g.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}const fi="__SENTRY_SUPPRESS_TRACING__";function Gt(t,e){const n=rn();if(n.startSpan)return n.startSpan(t,e);const r=sr(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return rt(a,()=>pi(i)(()=>{const u=O(),f=ir(u,i),m=t.onlyIfParent&&!f?new Tt:rr({parentSpan:f,spanArguments:r,forceTransaction:s,scope:u});return Et(u,m),nn(()=>e(m),()=>{const{status:l}=N(m);m.isRecording()&&(!l||l==="ok")&&m.setStatus({code:v,message:"internal_error"})},()=>{m.end()})}))}function oe(t,e){const n=rn();if(n.startSpanManual)return n.startSpanManual(t,e);const r=sr(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return rt(a,()=>pi(i)(()=>{const u=O(),f=ir(u,i),m=t.onlyIfParent&&!f?new Tt:rr({parentSpan:f,spanArguments:r,forceTransaction:s,scope:u});return Et(u,m),nn(()=>e(m,()=>m.end()),()=>{const{status:l}=N(m);m.isRecording()&&(!l||l==="ok")&&m.setStatus({code:v,message:"internal_error"})})}))}function nr(t){const e=rn();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=sr(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>rt(t.scope,o):s!==void 0?o=>le(s,o):o=>o())(()=>{const o=O(),a=ir(o,s);return t.onlyIfParent&&!a?new Tt:rr({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function le(t,e){const n=rn();return n.withActiveSpan?n.withActiveSpan(t,e):rt(r=>(Et(r,t||void 0),e(r)))}function wa(t){return rt(e=>(e.setPropagationContext({traceId:ut(),sampleRand:Math.random()}),S&&g.log(`Starting a new trace with id ${e.getPropagationContext().traceId}`),le(null,t)))}function rr({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!tn()){const o=new Tt;if(n||!t){const a=p({sampled:"false",sample_rate:"0",transaction:e.name},lt(o));ke(o,a)}return o}const s=j();let i;if(t&&!n)i=Ca(t,r,e),si(t,i);else if(t){const o=lt(t),{traceId:a,spanId:c}=t.spanContext(),u=bt(t);i=Kr(p({traceId:a,parentSpanId:c},e),r,u),ke(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}=p(p({},s.getPropagationContext()),r.getPropagationContext());i=Kr(p({traceId:o,parentSpanId:c},e),r,u),a&&ke(i,a)}return Ra(i),zo(i,r,s),i}function sr(t){const e=t.experimental||{},n=p({isStandalone:e.standalone},t);if(t.startTime){const r=p({},n);return r.startTimestamp=_t(t.startTime),delete r.startTime,r}return n}function rn(){const t=Dt();return ue(t)}function Kr(t,e,n){var h,y;const r=M(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:p({},t.attributes),spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=(h=o.parentSampled)!=null?h:n,c=o.spanAttributes,u=e.getPropagationContext(),[f,d,m]=e.getScopeData().sdkProcessingMetadata[fi]?[!1]:Ma(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:Qn((y=u.dsc)==null?void 0:y.sample_rate)},u.sampleRand),l=new en(b(p({},t),{attributes:p({[nt]:"custom",[Ws]:d!==void 0&&m?d:void 0},c),sampled:f}));return!f&&r&&(S&&g.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",l),l}function Ca(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[fi]?!1:bt(t),o=i?new en(b(p({},n),{parentSpanId:r,traceId:s,sampled:i})):new Tt({traceId:s});si(t,o);const a=M();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function ir(t,e){if(e)return e;if(e===null)return;const n=wt(t);if(!n)return;const r=M();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?H(n):n}function pi(t){return t!==void 0?e=>le(t,e):e=>e()}const yn={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},Pa="heartbeatFailed",xa="idleTimeout",Da="finalTimeout",$a="externalFinish";function La(t,e={}){const n=new Map;let r=!1,s,i=$a,o=!e.disableAutoFinish;const a=[],{idleTimeout:c=yn.idleTimeout,finalTimeout:u=yn.finalTimeout,childSpanTimeout:f=yn.childSpanTimeout,beforeSpanEnd:d,trimIdleSpanEndTimestamp:m=!0}=e,l=M();if(!l||!tn()){const R=new Tt,x=p({sample_rate:"0",sampled:"false"},lt(R));return ke(R,x),R}const h=O(),y=It(),_=Fa(t);_.end=new Proxy(_.end,{apply(R,x,Jt){if(d&&d(_),x instanceof Tt)return;const[Vt,...st]=Jt,At=Vt||z(),B=_t(At),C=Xt(_).filter(Z=>Z!==_),Yt=N(_);if(!C.length||!m)return X(B),Reflect.apply(R,x,[B,...st]);const Rt=l.getOptions().ignoreSpans,me=C==null?void 0:C.reduce((Z,ge)=>{const he=N(ge);return!he.timestamp||Rt&&Pe(he,Rt)?Z:Z?Math.max(Z,he.timestamp):he.timestamp},void 0),Nt=Yt.start_timestamp,_e=Math.min(Nt?Nt+u/1e3:1/0,Math.max(Nt||-1/0,Math.min(B,me||1/0)));return X(_e),Reflect.apply(R,x,[_e,...st])}});function E(){s&&(clearTimeout(s),s=void 0)}function T(R){E(),s=setTimeout(()=>{!r&&n.size===0&&o&&(i=xa,_.end(R))},c)}function k(R){s=setTimeout(()=>{!r&&o&&(i=Pa,_.end(R))},f)}function A(R){E(),n.set(R,!0);const x=z();k(x+f/1e3)}function $(R){if(n.has(R)&&n.delete(R),n.size===0){const x=z();T(x+c/1e3)}}function X(R){r=!0,n.clear(),a.forEach(C=>C()),Et(h,y);const x=N(_),{start_timestamp:Jt}=x;if(!Jt)return;x.data[se]||_.setAttribute(se,i);const st=x.status;(!st||st==="unknown")&&_.setStatus({code:Qe}),g.log(`[Tracing] Idle span "${x.op}" finished`);const At=Xt(_).filter(C=>C!==_);let B=0;At.forEach(C=>{C.isRecording()&&(C.setStatus({code:v,message:"cancelled"}),C.end(R),S&&g.log("[Tracing] Cancelling span since span ended early",JSON.stringify(C,void 0,2)));const Yt=N(C),{timestamp:Rt=0,start_timestamp:me=0}=Yt,Nt=me<=R,_e=(u+c)/1e3,Z=Rt-me<=_e;if(S){const ge=JSON.stringify(C,void 0,2);Nt?Z||g.log("[Tracing] Discarding span since it finished after idle span final timeout",ge):g.log("[Tracing] Discarding span since it happened after idle span was finished",ge)}(!Z||!Nt)&&(ia(_,C),B++)}),B>0&&_.setAttribute("sentry.idle_span_discarded_spans",B)}return a.push(l.on("spanStart",R=>{if(r||R===_||N(R).timestamp||R instanceof en&&R.isStandaloneSpan())return;Xt(_).includes(R)&&A(R.spanContext().spanId)})),a.push(l.on("spanEnd",R=>{r||$(R.spanContext().spanId)})),a.push(l.on("idleSpanEnableAutoFinish",R=>{R===_&&(o=!0,T(),n.size&&k())})),e.disableAutoFinish||T(),setTimeout(()=>{r||(_.setStatus({code:v,message:"deadline_exceeded"}),i=Da,_.end())},u),_}function Fa(t){const e=nr(t);return Et(O(),e),S&&g.log("[Tracing] Started span is an idle span"),e}const Sn=0,Xr=1,Zr=2;function Ht(t){return new Pt(e=>{e(t)})}function or(t){return new Pt((e,n)=>{n(t)})}class Pt{constructor(e){this._state=Sn,this._handlers=[],this._runExecutor(e)}then(e,n){return new Pt((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Pt((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}_executeHandlers(){if(this._state===Sn)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Xr&&n[1](this._value),this._state===Zr&&n[2](this._value),n[0]=!0)})}_runExecutor(e){const n=(i,o)=>{if(this._state===Sn){if(Ut(o)){o.then(r,s);return}this._state=i,this._value=o,this._executeHandlers()}},r=i=>{n(Xr,i)},s=i=>{n(Zr,i)};try{e(r,s)}catch(i){s(i)}}}function Ua(t,e,n,r=0){try{const s=Pn(e,n,t,r);return Ut(s)?s:Ht(s)}catch(s){return or(s)}}function Pn(t,e,n,r){const s=n[r];if(!t||!s)return t;const i=s(p({},t),e);return S&&i===null&&g.log(`Event processor "${s.id||"?"}" dropped event`),Ut(i)?i.then(o=>Pn(o,e,n,r+1)):Pn(i,e,n,r+1)}function ja(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;Ba(t,e),r&&za(t,r),qa(t,n),Ga(t,s),Ha(t,i)}function xt(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:f,attachments:d,propagationContext:m,transactionName:l,span:h}=e;Te(t,"extra",n),Te(t,"tags",r),Te(t,"user",s),Te(t,"contexts",i),t.sdkProcessingMetadata=ce(t.sdkProcessingMetadata,a,2),o&&(t.level=o),l&&(t.transactionName=l),h&&(t.span=h),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),f.length&&(t.eventProcessors=[...t.eventProcessors,...f]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext=p(p({},t.propagationContext),m)}function Te(t,e,n){t[e]=ce(t[e],n,1)}function Ba(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e;Object.keys(n).length&&(t.extra=p(p({},n),t.extra)),Object.keys(r).length&&(t.tags=p(p({},r),t.tags)),Object.keys(s).length&&(t.user=p(p({},s),t.user)),Object.keys(i).length&&(t.contexts=p(p({},i),t.contexts)),o&&(t.level=o),a&&t.type!=="transaction"&&(t.transaction=a)}function Ga(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function Ha(t,e){t.sdkProcessingMetadata=p(p({},t.sdkProcessingMetadata),e)}function za(t,e){t.contexts=p({trace:ei(e)},t.contexts),t.sdkProcessingMetadata=p({dynamicSamplingContext:lt(e)},t.sdkProcessingMetadata);const n=H(e),r=N(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function qa(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}let Q,Qr,ts,ot;function Wa(t){const e=I._sentryDebugIds,n=I._debugIds;if(!e&&!n)return{};const r=e?Object.keys(e):[],s=n?Object.keys(n):[];if(ot&&r.length===Qr&&s.length===ts)return ot;Qr=r.length,ts=s.length,ot={},Q||(Q={});const i=(o,a)=>{for(const c of o){const u=a[c],f=Q==null?void 0:Q[c];if(f&&ot&&u)ot[f[0]]=u,Q&&(Q[c]=[f[0],u]);else if(u){const d=t(c);for(let m=d.length-1;m>=0;m--){const l=d[m],h=l==null?void 0:l.filename;if(h&&ot&&Q){ot[h]=u,Q[c]=[h,u];break}}}}};return e&&i(r,e),n&&i(s,n),ot}function Ja(t,e,n,r,s,i){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c=b(p({},e),{event_id:e.event_id||n.event_id||V(),timestamp:e.timestamp||ae()}),u=n.integrations||t.integrations.map(_=>_.name);Va(c,t),Xa(c,u),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&Ya(c,t.stackParser);const f=Qa(r,n.captureContext);n.mechanism&&ct(c,n.mechanism);const d=s?s.getEventProcessors():[],m=Kn().getScopeData();if(i){const _=i.getScopeData();xt(m,_)}if(f){const _=f.getScopeData();xt(m,_)}const l=[...n.attachments||[],...m.attachments];l.length&&(n.attachments=l),ja(c,m);const h=[...d,...m.eventProcessors];return Ua(h,c,n).then(_=>(_&&Ka(_),typeof o=="number"&&o>0?Za(_,o,a):_))}function Va(t,e){var a,c;const{environment:n,release:r,dist:s,maxValueLength:i}=e;t.environment=t.environment||n||er,!t.release&&r&&(t.release=r),!t.dist&&s&&(t.dist=s);const o=t.request;o!=null&&o.url&&i&&(o.url=ne(o.url,i)),i&&((c=(a=t.exception)==null?void 0:a.values)==null||c.forEach(u=>{u.value&&(u.value=ne(u.value,i))}))}function Ya(t,e){var r,s;const n=Wa(e);(s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function Ka(t){var r,s;const e={};if((s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([i,o])=>{n.push({type:"sourcemap",code_file:i,debug_id:o})})}function Xa(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function Za(t,e,n){var s,i;if(!t)return null;const r=p(p(p(p(p({},t),t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(o=>p(p({},o),o.data&&{data:G(o.data,e,n)}))}),t.user&&{user:G(t.user,e,n)}),t.contexts&&{contexts:G(t.contexts,e,n)}),t.extra&&{extra:G(t.extra,e,n)});return(s=t.contexts)!=null&&s.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=G(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(o=>p(p({},o),o.data&&{data:G(o.data,e,n)}))),(i=t.contexts)!=null&&i.flags&&r.contexts&&(r.contexts.flags=G(t.contexts.flags,3,n)),r}function Qa(t,e){if(!e)return t;const n=t?t.clone():new K;return n.update(e),n}function tc(t){if(t)return ec(t)?{captureContext:t}:rc(t)?{captureContext:t}:t}function ec(t){return t instanceof K||typeof t=="function"}const nc=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function rc(t){return Object.keys(t).some(e=>nc.includes(e))}function D(t,e){return O().captureException(t,tc(e))}function xn(t,e){const n=typeof e=="string"?e:void 0,r=typeof e!="string"?{captureContext:e}:void 0;return O().captureMessage(t,n,r)}function sc(t,e){return O().captureEvent(t,e)}function ic(t,e){j().setContext(t,e)}function oc(t){j().setExtras(t)}function Dn(t,e){j().setExtra(t,e)}function ac(t){j().setTags(t)}function $n(t,e){j().setTag(t,e)}function cc(t){j().setUser(t)}function di(){return j().lastEventId()}function fe(t){j().addEventProcessor(t)}const uc="7";function lc(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function fc(t){return`${lc(t)}${t.projectId}/envelope/`}function pc(t,e){const n={sentry_version:uc};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}function mi(t,e,n){return e||`${fc(t)}?${pc(t,n)}`}const es=[];function dc(t,e){const n={};return e.forEach(r=>{r&&_i(t,r,n)}),n}function ns(t,e){for(const n of e)n!=null&&n.afterAllSetup&&n.afterAllSetup(t)}function _i(t,e,n){if(n[e.name]){S&&g.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,!es.includes(e.name)&&typeof e.setupOnce=="function"&&(e.setupOnce(),es.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}S&&g.log(`Integration installed: ${e.name}`)}function gi(t,e){return e?rt(e,()=>{const n=It(),r=n?ei(n):qs(e);return[n?lt(n):ai(t,e),r]}):[void 0,void 0]}const mc={trace:1,debug:5,info:9,warn:13,error:17,fatal:21};function _c(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function gc(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=Bt(r)),ft(s,[_c(t)])}const hc=100;function yc(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let n="";try{n=(e=JSON.stringify(t))!=null?e:""}catch(r){}return{value:n,type:"string"}}}}function J(t,e,n,r=!0){n&&(!t[e]||r)&&(t[e]=n)}function Sc(t,e){const n=ar(),r=yi(t);r===void 0?n.set(t,[e]):r.length>=hc?(hi(t,r),n.set(t,[e])):n.set(t,[...r,e])}function xe(t,e=O(),n=Sc){var Vt,st,At;const r=(Vt=e==null?void 0:e.getClient())!=null?Vt:M();if(!r){S&&g.warn("No client available to capture log.");return}const{release:s,environment:i,enableLogs:o=!1,beforeSendLog:a}=r.getOptions();if(!o){S&&g.warn("logging option not enabled, log will not be captured.");return}const[,c]=gi(r,e),u=p({},t.attributes),{user:{id:f,email:d,username:m}}=Ec(e);J(u,"user.id",f,!1),J(u,"user.email",d,!1),J(u,"user.name",m,!1),J(u,"sentry.release",s),J(u,"sentry.environment",i);const{name:l,version:h}=(At=(st=r.getSdkMetadata())==null?void 0:st.sdk)!=null?At:{};J(u,"sentry.sdk.name",l),J(u,"sentry.sdk.version",h);const y=r.getIntegrationByName("Replay"),_=y==null?void 0:y.getReplayId(!0);J(u,"sentry.replay_id",_),_&&(y==null?void 0:y.getRecordingMode())==="buffer"&&J(u,"sentry._internal.replay_is_buffering",!0);const E=t.message;if(Ye(E)){const{__sentry_template_string__:B,__sentry_template_values__:C=[]}=E;C!=null&&C.length&&(u["sentry.message.template"]=B),C.forEach((Yt,Rt)=>{u[`sentry.message.parameter.${Rt}`]=Yt})}const T=wt(e);J(u,"sentry.trace.parent_span_id",T==null?void 0:T.spanContext().spanId);const k=b(p({},t),{attributes:u});r.emit("beforeCaptureLog",k);const A=a?Lt(()=>a(k)):k;if(!A){r.recordDroppedEvent("before_send","log_item",1),S&&g.warn("beforeSendLog returned null, log will not be captured.");return}const{level:$,message:X,attributes:R={},severityNumber:x}=A,Jt={timestamp:z(),level:$,body:X,trace_id:c==null?void 0:c.trace_id,severity_number:x!=null?x:mc[$],attributes:Object.keys(R).reduce((B,C)=>(B[C]=yc(R[C]),B),{})};n(r,Jt),r.emit("afterCaptureLog",A)}function hi(t,e){var i;const n=(i=e!=null?e:yi(t))!=null?i:[];if(n.length===0)return;const r=t.getOptions(),s=gc(n,r._metadata,r.tunnel,t.getDsn());ar().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function yi(t){return ar().get(t)}function Ec(t){const e=Kn().getScopeData();return xt(e,j().getScopeData()),xt(e,t.getScopeData()),e}function ar(){return $t("clientToLogBufferMap",()=>new WeakMap)}function bc(t){return[{type:"trace_metric",item_count:t.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:t}]}function Tc(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=Bt(r)),ft(s,[bc(t)])}const Ic=1e3;function Ac(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let n="";try{n=(e=JSON.stringify(t))!=null?e:""}catch(r){}return{value:n,type:"string"}}}}function et(t,e,n,r=!0){n&&(r||!(e in t))&&(t[e]=n)}function Rc(t,e){const n=cr(),r=Ei(t);r===void 0?n.set(t,[e]):r.length>=Ic?(Si(t,r),n.set(t,[e])):n.set(t,[...r,e])}function Nc(t,e,n){var l,h;const{release:r,environment:s}=e.getOptions(),i=p({},t.attributes),{user:{id:o,email:a,username:c}}=Oc(n);et(i,"user.id",o,!1),et(i,"user.email",a,!1),et(i,"user.name",c,!1),et(i,"sentry.release",r),et(i,"sentry.environment",s);const{name:u,version:f}=(h=(l=e.getSdkMetadata())==null?void 0:l.sdk)!=null?h:{};et(i,"sentry.sdk.name",u),et(i,"sentry.sdk.version",f);const d=e.getIntegrationByName("Replay"),m=d==null?void 0:d.getReplayId(!0);return et(i,"sentry.replay_id",m),m&&(d==null?void 0:d.getRecordingMode())==="buffer"&&et(i,"sentry._internal.replay_is_buffering",!0),b(p({},t),{attributes:i})}function kc(t,e,n){const r={};for(const c in t.attributes)t.attributes[c]!==void 0&&(r[c]=Ac(t.attributes[c]));const[,s]=gi(e,n),i=wt(n),o=i?i.spanContext().traceId:s==null?void 0:s.trace_id,a=i?i.spanContext().spanId:void 0;return{timestamp:z(),trace_id:o!=null?o:"",span_id:a,name:t.name,type:t.type,unit:t.unit,value:t.value,attributes:r}}function vc(t,e){var l,h,y,_;const n=(l=e==null?void 0:e.scope)!=null?l:O(),r=(h=e==null?void 0:e.captureSerializedMetric)!=null?h:Rc,s=(y=n==null?void 0:n.getClient())!=null?y:M();if(!s){S&&g.warn("No client available to capture metric.");return}const{_experiments:i,enableMetrics:o,beforeSendMetric:a}=s.getOptions();if(!((_=o!=null?o:i==null?void 0:i.enableMetrics)!=null?_:!0)){S&&g.warn("metrics option not enabled, metric will not be captured.");return}const u=Nc(t,s,n);s.emit("processMetric",u);const f=a||(i==null?void 0:i.beforeSendMetric),d=f?f(u):u;if(!d){S&&g.log("`beforeSendMetric` returned `null`, will not send metric.");return}const m=kc(d,s,n);S&&g.log("[Metric]",m),r(s,m),s.emit("afterCaptureMetric",d)}function Si(t,e){var i;const n=(i=e!=null?e:Ei(t))!=null?i:[];if(n.length===0)return;const r=t.getOptions(),s=Tc(n,r._metadata,r.tunnel,t.getDsn());cr().set(t,[]),t.emit("flushMetrics"),t.sendEnvelope(s)}function Ei(t){return cr().get(t)}function Oc(t){const e=Kn().getScopeData();return xt(e,j().getScopeData()),xt(e,t.getScopeData()),e}function cr(){return $t("clientToMetricBufferMap",()=>new WeakMap)}const ur=Symbol.for("SentryBufferFullError");function bi(t=100){const e=new Set;function n(){return e.size<t}function r(o){e.delete(o)}function s(o){if(!n())return or(ur);const a=o();return e.add(a),a.then(()=>r(a),()=>r(a)),a}function i(o){if(!e.size)return Ht(!0);const a=Promise.allSettled(Array.from(e)).then(()=>!0);if(!o)return a;const c=[a,new Promise(u=>setTimeout(()=>u(!1),o))];return Promise.race(c)}return{get $(){return Array.from(e)},add:s,drain:i}}const Mc=60*1e3;function wc(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?Mc:r-e}function Cc(t,e){return t[e]||t.all||0}function Pc(t,e,n=Date.now()){return Cc(t,e)>n}function xc(t,{statusCode:e,headers:n},r=Date.now()){const s=p({},t),i=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(i)for(const a of i.trim().split(",")){const[c,u,,,f]=a.split(":",5),d=parseInt(c,10),m=(isNaN(d)?60:d)*1e3;if(!u)s.all=r+m;else for(const l of u.split(";"))l==="metric_bucket"?(!f||f.split(";").includes("custom"))&&(s[l]=r+m):s[l]=r+m}else o?s.all=r+wc(o,r):e===429&&(s.all=r+60*1e3);return s}const Ti=64;function Dc(t,e,n=bi(t.bufferSize||Ti)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(ie(o,(d,m)=>{const l=qr(m);Pc(r,l)?t.recordDroppedEvent("ratelimit_backoff",l):a.push(d)}),a.length===0)return Promise.resolve({});const c=ft(o[0],a),u=d=>{ie(c,(m,l)=>{t.recordDroppedEvent(d,qr(l))})},f=()=>e({body:_a(c)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&S&&g.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=xc(r,d),d),d=>{throw u("network_error"),S&&g.error("Encountered error running transport request:",d),d});return n.add(f).then(d=>d,d=>{if(d===ur)return S&&g.error("Skipped sending event because buffer is full."),u("queue_overflow"),Promise.resolve({});throw d})}return{send:i,flush:s}}function $c(t,e,n){const r=[{type:"client_report"},{timestamp:ae(),discarded_events:t}];return ft(e?{dsn:e}:{},[r])}function Ii(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];n!=null&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch(n){}return e}function Lc(t){var c,u,f;const{trace_id:e,parent_span_id:n,span_id:r,status:s,origin:i,data:o,op:a}=(u=(c=t.contexts)==null?void 0:c.trace)!=null?u:{};return{data:o!=null?o:{},description:t.transaction,op:a,parent_span_id:n,span_id:r!=null?r:"",start_timestamp:(f=t.start_timestamp)!=null?f:0,status:s,timestamp:t.timestamp,trace_id:e!=null?e:"",origin:i,profile_id:o==null?void 0:o[Xn],exclusive_time:o==null?void 0:o[Zn],measurements:t.measurements,is_segment:!0}}function Fc(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:p(p(p({},t.data),t.profile_id&&{[Xn]:t.profile_id}),t.exclusive_time&&{[Zn]:t.exclusive_time})}},measurements:t.measurements}}const rs="Not capturing exception because it's already been captured.",ss="Discarded session because of missing or non-string release",Ai=Symbol.for("SentryInternalError"),Ri=Symbol.for("SentryDoNotSendEventError"),Uc=5e3;function ve(t){return{message:t,[Ai]:!0}}function En(t){return{message:t,[Ri]:!0}}function is(t){return!!t&&typeof t=="object"&&Ai in t}function os(t){return!!t&&typeof t=="object"&&Ri in t}function as(t,e,n,r,s){let i=0,o,a=!1;t.on(n,()=>{i=0,clearTimeout(o),a=!1}),t.on(e,c=>{i+=r(c),i>=8e5?s(t):a||(a=!0,o=setTimeout(()=>{s(t)},Uc))}),t.on("flush",()=>{s(t)})}class jc{constructor(e){var r,s,i,o,a,c,u;if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=bi((s=(r=e.transportOptions)==null?void 0:r.bufferSize)!=null?s:Ti),e.dsn?this._dsn=ea(e.dsn):S&&g.warn("No DSN provided, client will not send events."),this._dsn){const f=mi(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport(b(p({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this)},e.transportOptions),{url:f}))}this._options.enableLogs=(o=this._options.enableLogs)!=null?o:(i=this._options._experiments)==null?void 0:i.enableLogs,this._options.enableLogs&&as(this,"afterCaptureLog","flushLogs",zc,hi),((u=(c=this._options.enableMetrics)!=null?c:(a=this._options._experiments)==null?void 0:a.enableMetrics)!=null?u:!0)&&as(this,"afterCaptureMetric","flushMetrics",Hc,Si)}captureException(e,n,r){const s=V();if(Lr(e))return S&&g.log(rs),s;const i=p({event_id:s},n);return this._process(()=>this.eventFromException(e,i).then(o=>this._captureEvent(o,i,r)).then(o=>o),"error"),i.event_id}captureMessage(e,n,r,s){const i=p({event_id:V()},r),o=Ye(e)?e:String(e),a=Yn(e),c=a?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(()=>c.then(u=>this._captureEvent(u,i,s)),a?"unknown":"error"),i.event_id}captureEvent(e,n,r){const s=V();if(n!=null&&n.originalException&&Lr(n.originalException))return S&&g.log(rs),s;const i=p({event_id:s},n),o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope,u=cs(e.type);return this._process(()=>this._captureEvent(e,i,a||r,c),u),i.event_id}captureSession(e){this.sendSession(e),Nn(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){return F(this,null,function*(){const n=this._transport;if(!n)return!0;this.emit("flush");const r=yield this._isClientDoneProcessing(e),s=yield n.flush(e);return r&&s})}close(e){return F(this,null,function*(){const n=yield this.flush(e);return this.getOptions().enabled=!1,this.emit("close"),n})}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];_i(this,e,this._integrations),n||ns(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=Ia(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=ma(r,ya(s));this.sendEnvelope(r).then(s=>this.emit("afterSendEvent",e,s))}sendSession(e){const{release:n,environment:r=er}=this._options;if("aggregates"in e){const i=e.attrs||{};if(!i.release&&!n){S&&g.warn(ss);return}i.release=i.release||n,i.environment=i.environment||r,e.attrs=i}else{if(!e.release&&!n){S&&g.warn(ss);return}e.release=e.release||n,e.environment=e.environment||r}this.emit("beforeSendSession",e);const s=Ta(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,n,r=1){if(this._options.sendClientReports){const s=`${e}:${n}`;S&&g.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,n){const r=this._hooks[e]=this._hooks[e]||new Set,s=(...i)=>n(...i);return r.add(s),()=>{r.delete(s)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}sendEnvelope(e){return F(this,null,function*(){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)try{return yield this._transport.send(e)}catch(n){return S&&g.error("Error while sending envelope:",n),{}}return S&&g.error("Transport disabled"),{}})}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=dc(this,e),ns(this,e)}_updateSessionFromEvent(e,n){var c,u;let r=n.level==="fatal",s=!1;const i=(c=n.exception)==null?void 0:c.values;if(i){s=!0,r=!1;for(const f of i)if(((u=f.mechanism)==null?void 0:u.handled)===!1){r=!0;break}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(Nn(e,b(p({},r&&{status:"crashed"}),{errors:e.errors||Number(s||r)})),this.captureSession(e))}_isClientDoneProcessing(e){return F(this,null,function*(){let n=0;for(;!e||n<e;){if(yield new Promise(r=>setTimeout(r,1)),!this._numProcessing)return!0;n++}return!1})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s){const i=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),Ja(i,e,n,r,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts=p({trace:qs(r)},a.contexts);const c=ai(this,r);return a.sdkProcessingMetadata=p({dynamicSamplingContext:c},a.sdkProcessingMetadata),a})}_captureEvent(e,n={},r=O(),s=j()){return S&&Ln(e)&&g.log(`Captured error event \`${Ii(e)[0]||"<unknown>"}\``),this._processEvent(e,n,r,s).then(i=>i.event_id,i=>{S&&(os(i)?g.log(i.message):is(i)?g.warn(i.message):g.warn(i))})}_processEvent(e,n,r,s){const i=this.getOptions(),{sampleRate:o}=i,a=Ni(e),c=Ln(e),f=`before send for type \`${e.type||"error"}\``,d=typeof o=="undefined"?void 0:Qn(o);if(c&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error"),or(En(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const m=cs(e.type);return this._prepareEvent(e,n,r,s).then(l=>{if(l===null)throw this.recordDroppedEvent("event_processor",m),En("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return l;const y=Gc(this,i,l,n);return Bc(y,f)}).then(l=>{var _;if(l===null){if(this.recordDroppedEvent("before_send",m),a){const T=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",T)}throw En(`${f} returned \`null\`, will not send event.`)}const h=r.getSession()||s.getSession();if(c&&h&&this._updateSessionFromEvent(h,l),a){const E=((_=l.sdkProcessingMetadata)==null?void 0:_.spanCountBeforeProcessing)||0,T=l.spans?l.spans.length:0,k=E-T;k>0&&this.recordDroppedEvent("before_send","span",k)}const y=l.transaction_info;if(a&&y&&l.transaction!==e.transaction){const E="custom";l.transaction_info=b(p({},y),{source:E})}return this.sendEvent(l,n),l}).then(null,l=>{throw os(l)||is(l)?l:(this.captureException(l,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:l}),ve(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${l}`))})}_process(e,n){this._numProcessing++,this._promiseBuffer.add(e).then(r=>(this._numProcessing--,r),r=>(this._numProcessing--,r===ur&&this.recordDroppedEvent("queue_overflow",n),r))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){S&&g.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){S&&g.log("No outcomes to send");return}if(!this._dsn){S&&g.log("No dsn provided, will not send outcomes");return}S&&g.log("Sending outcomes:",e);const n=$c(e,this._options.tunnel&&Bt(this._dsn));this.sendEnvelope(n)}}function cs(t){return t==="replay_event"?"replay":t||"error"}function Bc(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Ut(t))return t.then(r=>{if(!St(r)&&r!==null)throw ve(n);return r},r=>{throw ve(`${e} rejected with ${r}`)});if(!St(t)&&t!==null)throw ve(n);return t}function Gc(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:o,ignoreSpans:a}=e;let c=n;if(Ln(c)&&s)return s(c,r);if(Ni(c)){if(o||a){const u=Lc(c);if(a!=null&&a.length&&Pe(u,a))return null;if(o){const f=o(u);f?c=ce(n,Fc(f)):Mn()}if(c.spans){const f=[],d=c.spans;for(const l of d){if(a!=null&&a.length&&Pe(l,a)){aa(d,l);continue}if(o){const h=o(l);h?f.push(h):(Mn(),f.push(l))}else f.push(l)}const m=c.spans.length-f.length;m&&t.recordDroppedEvent("before_send","span",m),c.spans=f}}if(i){if(c.spans){const u=c.spans.length;c.sdkProcessingMetadata=b(p({},n.sdkProcessingMetadata),{spanCountBeforeProcessing:u})}return i(c,r)}}return c}function Ln(t){return t.type===void 0}function Ni(t){return t.type==="transaction"}function Hc(t){let e=0;return t.name&&(e+=t.name.length*2),e+=8,e+ki(t.attributes)}function zc(t){let e=0;return t.message&&(e+=t.message.length*2),e+ki(t.attributes)}function ki(t){if(!t)return 0;let e=0;return Object.values(t).forEach(n=>{Array.isArray(n)?e+=n.length*us(n[0]):Yn(n)?e+=us(n):e+=100}),e}function us(t){return typeof t=="string"?t.length*2:typeof t=="number"?8:typeof t=="boolean"?4:0}function qc(t,e){e.debug===!0&&(S?g.enable():Lt(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),O().update(e.initialScope);const r=new t(e);return Wc(r),r.init(),r}function Wc(t){O().setClient(t)}function vi(t,e){let n;return ie(t,(r,s)=>(e.includes(s)&&(n=Array.isArray(r)?r[1]:void 0),!!n)),n}function Jc(t,e){return n=>{const r=t(n);return b(p({},r),{send:s=>F(null,null,function*(){const i=vi(s,["event","transaction","profile","replay_event"]);return i&&(i.release=e),r.send(s)})})}}function Vc(t,e){return ft(e?b(p({},t[0]),{dsn:e}):t[0],t[1])}function Yc(t,e){return n=>{const r=t(n),s=new Map;function i(c,u){const f=u?`${c}:${u}`:c;let d=s.get(f);if(!d){const m=Zs(c);if(!m)return;const l=mi(m,n.tunnel);d=u?Jc(t,u)(b(p({},n),{url:l})):t(b(p({},n),{url:l})),s.set(f,d)}return[c,d]}function o(c){return F(this,null,function*(){function u(l){const h=l!=null&&l.length?l:["event"];return vi(c,h)}const f=e({envelope:c,getEvent:u}).map(l=>typeof l=="string"?i(l,void 0):i(l.dsn,l.release)).filter(l=>!!l),d=f.length?f:[["",r]];return(yield Promise.all(d.map(([l,h])=>h.send(Vc(c,l)))))[0]})}function a(c){return F(this,null,function*(){const u=[...s.values(),r];return(yield Promise.all(u.map(d=>d.flush(c)))).every(d=>d)})}return{send:o,flush:a}}}function Kc(t,...e){const n=new String(String.raw(t,...e));return n.__sentry_template_string__=t.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=e,n}const Xc=Kc;function Zc(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:dt})),version:dt}),t._metadata=s}const Qc=100;function Oi(t,e){const n=M(),r=j();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=Qc}=n.getOptions();if(i<=0)return;const o=ae(),a=p({timestamp:o},t),c=s?Lt(()=>s(a,e)):a;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let ls;const tu="FunctionToString",fs=new WeakMap,eu=(()=>({name:tu,setupOnce(){ls=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=Bs(this),n=fs.has(M())&&e!==void 0?e:this;return ls.apply(n,t)}}catch(t){}},setup(t){fs.set(t,!0)}})),nu=eu,ru=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],su="EventFilters",iu=(t={})=>{let e;return{name:su,setup(n){const r=n.getOptions();e=ps(t,r)},processEvent(n,r,s){if(!e){const i=s.getOptions();e=ps(t,i)}return ou(n,e)?null:n}}};function ps(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:ru],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function ou(t,e){if(t.type){if(t.type==="transaction"&&cu(t,e.ignoreTransactions))return S&&g.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${vt(t)}`),!0}else{if(au(t,e.ignoreErrors))return S&&g.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${vt(t)}`),!0;if(pu(t))return S&&g.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${vt(t)}`),!0;if(uu(t,e.denyUrls))return S&&g.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${vt(t)}.
Url: ${De(t)}`),!0;if(!lu(t,e.allowUrls))return S&&g.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${vt(t)}.
Url: ${De(t)}`),!0}return!1}function au(t,e){return e!=null&&e.length?Ii(t).some(n=>Ze(n,e)):!1}function cu(t,e){if(!(e!=null&&e.length))return!1;const n=t.transaction;return n?Ze(n,e):!1}function uu(t,e){if(!(e!=null&&e.length))return!1;const n=De(t);return n?Ze(n,e):!1}function lu(t,e){if(!(e!=null&&e.length))return!0;const n=De(t);return n?Ze(n,e):!0}function fu(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function De(t){var e,n,r;try{const s=[...(n=(e=t.exception)==null?void 0:e.values)!=null?n:[]].reverse().find(o=>{var a,c,u;return((a=o.mechanism)==null?void 0:a.parent_id)===void 0&&((u=(c=o.stacktrace)==null?void 0:c.frames)==null?void 0:u.length)}),i=(r=s==null?void 0:s.stacktrace)==null?void 0:r.frames;return i?fu(i):null}catch(s){return S&&g.error(`Cannot extract url for event ${vt(t)}`),null}}function pu(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)!=null&&n.length?!t.message&&!t.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}const Mi=new Map,ds=new Set;function du(t){if(I._sentryModuleMetadata)for(const e of Object.keys(I._sentryModuleMetadata)){const n=I._sentryModuleMetadata[e];if(ds.has(e))continue;ds.add(e);const r=t(e);for(const s of r.reverse())if(s.filename){Mi.set(s.filename,n);break}}}function mu(t,e){return du(t),Mi.get(e)}function wi(t,e){var n,r;(r=(n=e.exception)==null?void 0:n.values)==null||r.forEach(s=>{var i,o;(o=(i=s.stacktrace)==null?void 0:i.frames)==null||o.forEach(a=>{if(!a.filename||a.module_metadata)return;const c=mu(t,a.filename);c&&(a.module_metadata=c)})})}function Ci(t){var e,n;(n=(e=t.exception)==null?void 0:e.values)==null||n.forEach(r=>{var s,i;(i=(s=r.stacktrace)==null?void 0:s.frames)==null||i.forEach(o=>{delete o.module_metadata})})}const _u=()=>({name:"ModuleMetadata",setup(t){t.on("beforeEnvelope",e=>{ie(e,(n,r)=>{if(r==="event"){const s=Array.isArray(n)?n[1]:void 0;s&&(Ci(s),n[1]=s)}})}),t.on("applyFrameMetadata",e=>{if(e.type)return;const n=t.getOptions().stackParser;wi(n,e)})}});function Pi(t){const e="console";Wn(e,t),Jn(e,gu)}function gu(){"console"in I&&Hn.forEach(function(t){t in I.console&&kt(I.console,t,function(e){return Me[t]=e,function(...n){Vn("console",{args:n,level:t});const s=Me[t];s==null||s.apply(I.console,n)}})})}function ms(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const hu="CaptureConsole",yu=((t={})=>{var r;const e=t.levels||Hn,n=(r=t.handled)!=null?r:!0;return{name:hu,setup(s){"console"in I&&Pi(({args:i,level:o})=>{M()!==s||!e.includes(o)||Eu(i,o,n)})}}}),Su=yu;function Eu(t,e,n){const r=ms(e),s=new Error,i={level:ms(e),extra:{arguments:t}};rt(o=>{if(o.addEventProcessor(u=>(u.logger="console",ct(u,{handled:n,type:"auto.core.capture_console"}),u)),e==="assert"){if(!t[0]){const u=`Assertion failed: ${$r(t.slice(1)," ")||"console.assert"}`;o.setExtra("arguments",t.slice(1)),o.captureMessage(u,r,{captureContext:i,syntheticException:s})}return}const a=t.find(u=>u instanceof Error);if(a){D(a,i);return}const c=$r(t," ");o.captureMessage(c,r,{captureContext:i,syntheticException:s})})}const bu="ExtraErrorData",Tu=((t={})=>{const{depth:e=3,captureErrorCause:n=!0}=t;return{name:bu,processEvent(r,s,i){const{maxValueLength:o}=i.getOptions();return Au(r,s,e,n,o)}}}),Iu=Tu;function Au(t,e={},n,r,s){if(!e.originalException||!mt(e.originalException))return t;const i=e.originalException.name||e.originalException.constructor.name,o=xi(e.originalException,r,s);if(o){const a=p({},t.contexts),c=G(o,n);return St(c)&&(W(c,"__sentry_skip_normalization__",!0),a[i]=c),b(p({},t),{contexts:a})}return t}function xi(t,e,n){try{const r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],s={};for(const i of Object.keys(t)){if(r.indexOf(i)!==-1)continue;const o=t[i];s[i]=mt(o)||typeof o=="string"?n?ne(`${o}`,n):`${o}`:o}if(e&&t.cause!==void 0)if(mt(t.cause)){const i=t.cause.name||t.cause.constructor.name;s.cause={[i]:xi(t.cause,!1,n)}}else s.cause=t.cause;if(typeof t.toJSON=="function"){const i=t.toJSON();for(const o of Object.keys(i)){const a=i[o];s[o]=mt(a)?a.toString():a}}return s}catch(r){S&&g.error("Unable to extract extra data from the Error object:",r)}return null}function Ru(t,e){let n=0;for(let r=t.length-1;r>=0;r--){const s=t[r];s==="."?t.splice(r,1):s===".."?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}const Nu=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function ku(t){const e=t.length>1024?`<truncated>${t.slice(-1024)}`:t,n=Nu.exec(e);return n?n.slice(1):[]}function _s(...t){let e="",n=!1;for(let r=t.length-1;r>=-1&&!n;r--){const s=r>=0?t[r]:"/";s&&(e=`${s}/${e}`,n=s.charAt(0)==="/")}return e=Ru(e.split("/").filter(r=>!!r),!n).join("/"),(n?"/":"")+e||"."}function gs(t){let e=0;for(;e<t.length&&t[e]==="";e++);let n=t.length-1;for(;n>=0&&t[n]==="";n--);return e>n?[]:t.slice(e,n-e+1)}function vu(t,e){t=_s(t).slice(1),e=_s(e).slice(1);const n=gs(t.split("/")),r=gs(e.split("/")),s=Math.min(n.length,r.length);let i=s;for(let a=0;a<s;a++)if(n[a]!==r[a]){i=a;break}let o=[];for(let a=i;a<n.length;a++)o.push("..");return o=o.concat(r.slice(i)),o.join("/")}function Ou(t,e){return ku(t)[2]||""}const Mu="RewriteFrames",wu=(t={})=>{const e=t.root,n=t.prefix||"app:///",r="window"in I&&!!I.window,s=t.iteratee||Cu({isBrowser:r,root:e,prefix:n});function i(a){try{return b(p({},a),{exception:b(p({},a.exception),{values:a.exception.values.map(c=>p(p({},c),c.stacktrace&&{stacktrace:o(c.stacktrace)}))})})}catch(c){return a}}function o(a){var c;return b(p({},a),{frames:(c=a==null?void 0:a.frames)==null?void 0:c.map(u=>s(u))})}return{name:Mu,processEvent(a){let c=a;return a.exception&&Array.isArray(a.exception.values)&&(c=i(c)),c}}};function Cu({isBrowser:t,root:e,prefix:n}){return r=>{if(!r.filename)return r;const s=/^[a-zA-Z]:\\/.test(r.filename)||r.filename.includes("\\")&&!r.filename.includes("/"),i=/^\//.test(r.filename);if(t){if(e){const o=r.filename;o.indexOf(e)===0&&(r.filename=o.replace(e,n))}}else if(s||i){const o=s?r.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):r.filename,a=e?vu(e,o):Ou(o);r.filename=`${n}${a}`}return r}}const Pu=["reauthenticate","signInAnonymously","signInWithOAuth","signInWithIdToken","signInWithOtp","signInWithPassword","signInWithSSO","signOut","signUp","verifyOtp"],xu=["createUser","deleteUser","listUsers","getUserById","updateUserById","inviteUserByEmail"],Du={eq:"eq",neq:"neq",gt:"gt",gte:"gte",lt:"lt",lte:"lte",like:"like","like(all)":"likeAllOf","like(any)":"likeAnyOf",ilike:"ilike","ilike(all)":"ilikeAllOf","ilike(any)":"ilikeAnyOf",is:"is",in:"in",cs:"contains",cd:"containedBy",sr:"rangeGt",nxl:"rangeGte",sl:"rangeLt",nxr:"rangeLte",adj:"rangeAdjacent",ov:"overlaps",fts:"",plfts:"plain",phfts:"phrase",wfts:"websearch",not:"not"},Di=["select","insert","upsert","update","delete"];function sn(t){try{t.__SENTRY_INSTRUMENTED__=!0}catch(e){}}function on(t){try{return t.__SENTRY_INSTRUMENTED__}catch(e){return!1}}function $u(t,e={}){var n;switch(t){case"GET":return"select";case"POST":return(n=e.Prefer)!=null&&n.includes("resolution=")?"upsert":"insert";case"PATCH":return"update";case"DELETE":return"delete";default:return"<unknown-op>"}}function Lu(t,e){if(e===""||e==="*")return"select(*)";if(t==="select")return`select(${e})`;if(t==="or"||t.endsWith(".or"))return`${t}${e}`;const[n,...r]=e.split(".");let s;return n!=null&&n.startsWith("fts")?s="textSearch":n!=null&&n.startsWith("plfts")?s="textSearch[plain]":n!=null&&n.startsWith("phfts")?s="textSearch[phrase]":n!=null&&n.startsWith("wfts")?s="textSearch[websearch]":s=n&&Du[n]||"filter",`${s}(${t}, ${r.join(".")})`}function hs(t,e=!1){return new Proxy(t,{apply(n,r,s){return Gt({name:`auth ${e?"(admin) ":""}${t.name}`,attributes:{[L]:"auto.db.supabase",[re]:"db","db.system":"postgresql","db.operation":`auth.${e?"admin.":""}${t.name}`}},i=>Reflect.apply(n,r,s).then(o=>(o&&typeof o=="object"&&"error"in o&&o.error?(i.setStatus({code:v}),D(o.error,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}})):i.setStatus({code:Qe}),i.end(),o)).catch(o=>{throw i.setStatus({code:v}),i.end(),D(o,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}}),o}).then(...s))}})}function Fu(t){const e=t.auth;if(!(!e||on(t.auth))){for(const n of Pu){const r=e[n];r&&typeof t.auth[n]=="function"&&(t.auth[n]=hs(r))}for(const n of xu){const r=e.admin[n];r&&typeof t.auth.admin[n]=="function"&&(t.auth.admin[n]=hs(r,!0))}sn(t.auth)}}function Uu(t){on(t.prototype.from)||(t.prototype.from=new Proxy(t.prototype.from,{apply(e,n,r){const s=Reflect.apply(e,n,r),i=s.constructor;return Bu(i),s}}),sn(t.prototype.from))}function ju(t){on(t.prototype.then)||(t.prototype.then=new Proxy(t.prototype.then,{apply(e,n,r){var l;const s=Di,i=n,o=$u(i.method,i.headers);if(!s.includes(o)||!((l=i==null?void 0:i.url)!=null&&l.pathname)||typeof i.url.pathname!="string")return Reflect.apply(e,n,r);const a=i.url.pathname.split("/"),c=a.length>0?a[a.length-1]:"",u=[];for(const[h,y]of i.url.searchParams.entries())u.push(Lu(h,y));const f=Object.create(null);if(St(i.body))for(const[h,y]of Object.entries(i.body))f[h]=y;const d=`${o==="select"?"":`${o}${f?"(...) ":""}`}${u.join(" ")} from(${c})`,m={"db.table":c,"db.schema":i.schema,"db.url":i.url.origin,"db.sdk":i.headers["X-Client-Info"],"db.system":"postgresql","db.operation":o,[L]:"auto.db.supabase",[re]:"db"};return u.length&&(m["db.query"]=u),Object.keys(f).length&&(m["db.body"]=f),Gt({name:d,attributes:m},h=>Reflect.apply(e,n,[]).then(y=>{if(h&&(y&&typeof y=="object"&&"status"in y&&vn(h,y.status||500),h.end()),y.error){const T=new Error(y.error.message);y.error.code&&(T.code=y.error.code),y.error.details&&(T.details=y.error.details);const k={};u.length&&(k.query=u),Object.keys(f).length&&(k.body=f),D(T,A=>(A.addEventProcessor($=>(ct($,{handled:!1,type:"auto.db.supabase.postgres"}),$)),A.setContext("supabase",k),A))}const _={type:"supabase",category:`db.${o}`,message:d},E={};return u.length&&(E.query=u),Object.keys(f).length&&(E.body=f),Object.keys(E).length&&(_.data=E),Oi(_),y},y=>{throw h&&(vn(h,500),h.end()),y}).then(...r))}}),sn(t.prototype.then))}function Bu(t){for(const e of Di)on(t.prototype[e])||(t.prototype[e]=new Proxy(t.prototype[e],{apply(n,r,s){const i=Reflect.apply(n,r,s),o=i.constructor;return S&&g.log(`Instrumenting ${e} operation's PostgRESTFilterBuilder`),ju(o),i}}),sn(t.prototype[e]))}const $i=t=>{if(!t){S&&g.warn("Supabase integration was not installed because no Supabase client was provided.");return}const e=t.constructor===Function?t:t.constructor;Uu(e),Fu(t)},Gu="Supabase",Hu=(t=>({setupOnce(){$i(t)},name:Gu})),zu=t=>Hu(t.supabaseClient),qu=10,Wu="ZodErrors";function Ju(t){return mt(t)&&t.name==="ZodError"&&Array.isArray(t.issues)}function Vu(t){return b(p({},t),{path:"path"in t&&Array.isArray(t.path)?t.path.join("."):void 0,keys:"keys"in t?JSON.stringify(t.keys):void 0,unionErrors:"unionErrors"in t?JSON.stringify(t.unionErrors):void 0})}function Yu(t){return t.map(e=>typeof e=="number"?"<array>":e).join(".")}function Ku(t){const e=new Set;for(const r of t.issues){const s=Yu(r.path);s.length>0&&e.add(s)}const n=Array.from(e);if(n.length===0){let r="variable";if(t.issues.length>0){const s=t.issues[0];s!==void 0&&"expected"in s&&typeof s.expected=="string"&&(r=s.expected)}return`Failed to validate ${r}`}return`Failed to validate keys: ${ne(n.join(", "),100)}`}function Xu(t,e=!1,n,r){var s;if(!((s=n.exception)!=null&&s.values)||!r.originalException||!Ju(r.originalException)||r.originalException.issues.length===0)return n;try{const o=(e?r.originalException.issues:r.originalException.issues.slice(0,t)).map(Vu);return e&&(Array.isArray(r.attachments)||(r.attachments=[]),r.attachments.push({filename:"zod_issues.json",data:JSON.stringify({issues:o})})),b(p({},n),{exception:b(p({},n.exception),{values:[b(p({},n.exception.values[0]),{value:Ku(r.originalException)}),...n.exception.values.slice(1)]}),extra:b(p({},n.extra),{"zoderror.issues":o.slice(0,t)})})}catch(i){return b(p({},n),{extra:b(p({},n.extra),{"zoderrors sentry integration parse error":{message:"an exception was thrown while processing ZodError within applyZodErrorsToEvent()",error:i instanceof Error?`${i.name}: ${i.message}
${i.stack}`:"unknown"}})})}}const Zu=((t={})=>{var n;const e=(n=t.limit)!=null?n:qu;return{name:Wu,processEvent(r,s){return Xu(e,t.saveZodIssuesAsAttachment,r,s)}}}),Qu=Zu,tl=t=>({name:"ThirdPartyErrorsFilter",setup(e){e.on("beforeEnvelope",n=>{ie(n,(r,s)=>{if(s==="event"){const i=Array.isArray(r)?r[1]:void 0;i&&(Ci(i),r[1]=i)}})}),e.on("applyFrameMetadata",n=>{if(n.type)return;const r=e.getOptions().stackParser;wi(r,n)})},processEvent(e){const n=el(e);if(n){const r=t.behaviour==="drop-error-if-contains-third-party-frames"||t.behaviour==="apply-tag-if-contains-third-party-frames"?"some":"every";if(n[r](i=>!i.some(o=>t.filterKeys.includes(o)))){if(t.behaviour==="drop-error-if-contains-third-party-frames"||t.behaviour==="drop-error-if-exclusively-contains-third-party-frames")return null;e.tags=b(p({},e.tags),{third_party_code:!0})}}return e}});function el(t){const e=_o(t);if(e)return e.filter(n=>{var r;return!!n.filename&&((r=n.lineno)!=null?r:n.colno)!=null}).map(n=>n.module_metadata?Object.keys(n.module_metadata).filter(r=>r.startsWith(ys)).map(r=>r.slice(ys.length)):[])}const ys="_sentryBundlerPluginAppKey:",nl=100,rl=10,Ie="flag.evaluation.";function sl(t){const n=O().getScopeData().contexts.flags,r=n?n.values:[];return r.length&&(t.contexts===void 0&&(t.contexts={}),t.contexts.flags={values:[...r]}),t}function il(t,e,n=nl){const r=O().getScopeData().contexts;r.flags||(r.flags={values:[]});const s=r.flags.values;ol(s,t,e,n)}function ol(t,e,n,r){if(typeof n!="boolean")return;if(t.length>r){S&&g.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${r}`);return}const s=t.findIndex(i=>i.flag===e);s!==-1&&t.splice(s,1),t.length===r&&t.shift(),t.push({flag:e,result:n})}function al(t,e,n=rl){if(typeof e!="boolean")return;const r=It();if(!r)return;const s=N(r).data;if(`${Ie}${t}`in s){r.setAttribute(`${Ie}${t}`,e);return}Object.keys(s).filter(o=>o.startsWith(Ie)).length<n&&r.setAttribute(`${Ie}${t}`,e)}const cl=()=>({name:"FeatureFlags",processEvent(t,e,n){return sl(t)},addFeatureFlag(t,e){il(t,e),al(t,e)}});function zt(t,e,n,r,s){xe({level:t,message:e,attributes:n,severityNumber:s},r)}function ul(t,e,{scope:n}={}){zt("trace",t,e,n)}function ll(t,e,{scope:n}={}){zt("debug",t,e,n)}function fl(t,e,{scope:n}={}){zt("info",t,e,n)}function pl(t,e,{scope:n}={}){zt("warn",t,e,n)}function dl(t,e,{scope:n}={}){zt("error",t,e,n)}function ml(t,e,{scope:n}={}){zt("fatal",t,e,n)}const _l=Object.freeze(Object.defineProperty({__proto__:null,debug:ll,error:dl,fatal:ml,fmt:Xc,info:fl,trace:ul,warn:pl},Symbol.toStringTag,{value:"Module"}));function Fn(t,e,n){return"util"in I&&typeof I.util.format=="function"?I.util.format(...t):gl(t,e,n)}function gl(t,e,n){return t.map(r=>Yn(r)?String(r):JSON.stringify(G(r,e,n))).join(" ")}function hl(t){return/%[sdifocO]/.test(t)}function yl(t,e){const n={},r=new Array(e.length).fill("{}").join(" ");return n["sentry.message.template"]=`${t} ${r}`,e.forEach((s,i)=>{n[`sentry.message.parameter.${i}`]=s}),n}const Sl="ConsoleLogs",Ss={[L]:"auto.log.console"},El=((t={})=>{const e=t.levels||Hn;return{name:Sl,setup(n){const{enableLogs:r,normalizeDepth:s=3,normalizeMaxBreadth:i=1e3}=n.getOptions();if(!r){S&&g.warn("`enableLogs` is not enabled, ConsoleLogs integration disabled");return}Pi(({args:o,level:a})=>{if(M()!==n||!e.includes(a))return;const c=o[0],u=o.slice(1);if(a==="assert"){if(!c){const l=u.length>0?`Assertion failed: ${Fn(u,s,i)}`:"Assertion failed";xe({level:"error",message:l,attributes:Ss})}return}const f=a==="log",d=o.length>1&&typeof o[0]=="string"&&!hl(o[0]),m=p(p({},Ss),d?yl(c,u):{});xe({level:f?"info":a,message:Fn(o,s,i),severityNumber:f?10:void 0,attributes:m})})}}}),bl=El;function lr(t,e,n,r){vc({type:t,name:e,value:n,unit:r==null?void 0:r.unit,attributes:r==null?void 0:r.attributes},{scope:r==null?void 0:r.scope})}function Tl(t,e=1,n){lr("counter",t,e,n)}function Il(t,e,n){lr("gauge",t,e,n)}function Al(t,e,n){lr("distribution",t,e,n)}const Rl=Object.freeze(Object.defineProperty({__proto__:null,count:Tl,distribution:Al,gauge:Il},Symbol.toStringTag,{value:"Module"})),Nl=["trace","debug","info","warn","error","fatal"];function kl(t={}){var r;const e=new Set((r=t.levels)!=null?r:Nl),n=t.client;return{log(s){const T=s,{type:i,level:o,message:a,args:c,tag:u,date:f}=T,d=dn(T,["type","level","message","args","tag","date"]),m=n||M();if(!m)return;const l=Ml(i,o);if(!e.has(l))return;const{normalizeDepth:h=3,normalizeMaxBreadth:y=1e3}=m.getOptions(),_=[];a&&_.push(a),c&&c.length>0&&_.push(Fn(c,h,y));const E=_.join(" ");d["sentry.origin"]="auto.log.consola",u&&(d["consola.tag"]=u),i&&(d["consola.type"]=i),o!=null&&typeof o=="number"&&(d["consola.level"]=o),xe({level:l,message:E,attributes:d})}}}const vl={silent:"trace",fatal:"fatal",error:"error",warn:"warn",log:"info",info:"info",success:"info",fail:"error",ready:"info",start:"info",box:"info",debug:"debug",trace:"trace",verbose:"debug",critical:"fatal",notice:"info"},Ol={0:"fatal",1:"warn",2:"info",3:"info",4:"debug",5:"trace"};function Ml(t,e){if(t==="verbose")return"debug";if(t==="silent")return"trace";if(t){const n=vl[t];if(n)return n}if(typeof e=="number"){const n=Ol[e];if(n)return n}return"info"}const wl="gen_ai.prompt",fr="gen_ai.system",q="gen_ai.request.model",Li="gen_ai.request.stream",pr="gen_ai.request.temperature",Fi="gen_ai.request.max_tokens",dr="gen_ai.request.frequency_penalty",Ui="gen_ai.request.presence_penalty",mr="gen_ai.request.top_p",ji="gen_ai.request.top_k",Cl="gen_ai.request.encoding_format",Pl="gen_ai.request.dimensions",qt="gen_ai.response.finish_reasons",Wt="gen_ai.response.model",pe="gen_ai.response.id",an="gen_ai.usage.input_tokens",cn="gen_ai.usage.output_tokens",un="gen_ai.usage.total_tokens",_r="gen_ai.operation.name",ht="gen_ai.request.messages",Y="gen_ai.response.text",gr="gen_ai.request.available_tools",ln="gen_ai.response.streaming",pt="gen_ai.response.tool_calls",xl="openai.response.id",Bi="openai.response.model",Dl="openai.response.timestamp",$l="openai.usage.completion_tokens",Ll="openai.usage.prompt_tokens",bn={CHAT:"chat",RESPONSES:"responses",EMBEDDINGS:"embeddings"},Es="anthropic.response.timestamp",Gi=2e4,$e=t=>new TextEncoder().encode(t).length,Le=t=>$e(JSON.stringify(t));function hr(t,e){if($e(t)<=e)return t;let n=0,r=t.length,s="";for(;n<=r;){const i=Math.floor((n+r)/2),o=t.slice(0,i);$e(o)<=e?(s=o,n=i+1):r=i-1}return s}function Fl(t){return typeof t=="string"?t:t.text}function bs(t,e){return typeof t=="string"?e:b(p({},t),{text:e})}function Ul(t){return t!==null&&typeof t=="object"&&"content"in t&&typeof t.content=="string"}function jl(t){return t!==null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)&&t.parts.length>0}function Bl(t,e){const n=b(p({},t),{content:""}),r=Le(n),s=e-r;if(s<=0)return[];const i=hr(t.content,s);return[b(p({},t),{content:i})]}function Gl(t,e){const{parts:n}=t,r=n.map(a=>bs(a,"")),s=Le(b(p({},t),{parts:r}));let i=e-s;if(i<=0)return[];const o=[];for(const a of n){const c=Fl(a),u=$e(c);if(u<=i)o.push(a),i-=u;else if(o.length===0){const f=hr(c,i);f&&o.push(bs(a,f));break}else break}return o.length>0?[b(p({},t),{parts:o})]:[]}function Hl(t,e){return!t||typeof t!="object"?[]:Ul(t)?Bl(t,e):jl(t)?Gl(t,e):[]}function zl(t,e){if(!Array.isArray(t)||t.length===0||Le(t)<=e)return t;const r=t.map(Le);let s=0,i=t.length;for(let o=t.length-1;o>=0;o--){const a=r[o];if(a&&s+a>e)break;a&&(s+=a),i=o}if(i===t.length){const o=t[t.length-1];return Hl(o,e)}return t.slice(i)}function ql(t){return zl(t,Gi)}function Wl(t){return hr(t,Gi)}function de(t){return t.includes("messages")?"messages":t.includes("completions")?"completions":t.includes("models")?"models":t.includes("chat")?"chat":t.split(".").pop()||"unknown"}function Fe(t){return`gen_ai.${de(t)}`}function Hi(t,e){return t?`${t}.${e}`:e}function yr(t,e,n,r,s){if(e!==void 0&&t.setAttributes({[an]:e}),n!==void 0&&t.setAttributes({[cn]:n}),e!==void 0||n!==void 0||r!==void 0||s!==void 0){const i=(e!=null?e:0)+(n!=null?n:0)+(r!=null?r:0)+(s!=null?s:0);t.setAttributes({[un]:i})}}function yt(t){if(typeof t=="string")return Wl(t);if(Array.isArray(t)){const e=ql(t);return JSON.stringify(e)}return JSON.stringify(t)}const Jl="OpenAI",Vl=["responses.create","chat.completions.create","embeddings.create"],Yl=["response.output_item.added","response.function_call_arguments.delta","response.function_call_arguments.done","response.output_item.done"],Kl=["response.created","response.in_progress","response.failed","response.completed","response.incomplete","response.queued","response.output_text.delta",...Yl];function Sr(t){return t.includes("chat.completions")?bn.CHAT:t.includes("responses")?bn.RESPONSES:t.includes("embeddings")?bn.EMBEDDINGS:t.split(".").pop()||"unknown"}function Ts(t){return`gen_ai.${Sr(t)}`}function Xl(t){return Vl.includes(t)}function Zl(t,e){return t?`${t}.${e}`:e}function Ql(t){return t!==null&&typeof t=="object"&&"object"in t&&t.object==="chat.completion"}function tf(t){return t!==null&&typeof t=="object"&&"object"in t&&t.object==="response"}function ef(t){if(t===null||typeof t!="object"||!("object"in t))return!1;const e=t;return e.object==="list"&&typeof e.model=="string"&&e.model.toLowerCase().includes("embedding")}function nf(t){return t!==null&&typeof t=="object"&&"type"in t&&typeof t.type=="string"&&t.type.startsWith("response.")}function rf(t){return t!==null&&typeof t=="object"&&"object"in t&&t.object==="chat.completion.chunk"}function sf(t,e,n){if(Er(t,e.id,e.model,e.created),e.usage&&fn(t,e.usage.prompt_tokens,e.usage.completion_tokens,e.usage.total_tokens),Array.isArray(e.choices)){const r=e.choices.map(s=>s.finish_reason).filter(s=>s!==null);if(r.length>0&&t.setAttributes({[qt]:JSON.stringify(r)}),n){const s=e.choices.map(i=>{var o;return(o=i.message)==null?void 0:o.tool_calls}).filter(i=>Array.isArray(i)&&i.length>0).flat();s.length>0&&t.setAttributes({[pt]:JSON.stringify(s)})}}}function of(t,e,n){if(Er(t,e.id,e.model,e.created_at),e.status&&t.setAttributes({[qt]:JSON.stringify([e.status])}),e.usage&&fn(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.total_tokens),n){const r=e;if(Array.isArray(r.output)&&r.output.length>0){const s=r.output.filter(i=>typeof i=="object"&&i!==null&&i.type==="function_call");s.length>0&&t.setAttributes({[pt]:JSON.stringify(s)})}}}function af(t,e){t.setAttributes({[Bi]:e.model,[Wt]:e.model}),e.usage&&fn(t,e.usage.prompt_tokens,void 0,e.usage.total_tokens)}function fn(t,e,n,r){e!==void 0&&t.setAttributes({[Ll]:e,[an]:e}),n!==void 0&&t.setAttributes({[$l]:n,[cn]:n}),r!==void 0&&t.setAttributes({[un]:r})}function Er(t,e,n,r){t.setAttributes({[xl]:e,[pe]:e}),t.setAttributes({[Bi]:n,[Wt]:n}),t.setAttributes({[Dl]:new Date(r*1e3).toISOString()})}function cf(t,e){for(const n of t){const r=n.index;if(!(r===void 0||!n.function))if(!(r in e.chatCompletionToolCalls))e.chatCompletionToolCalls[r]=b(p({},n),{function:{name:n.function.name,arguments:n.function.arguments||""}});else{const s=e.chatCompletionToolCalls[r];n.function.arguments&&(s!=null&&s.function)&&(s.function.arguments+=n.function.arguments)}}}function uf(t,e,n){var r,s,i,o,a,c;e.responseId=(r=t.id)!=null?r:e.responseId,e.responseModel=(s=t.model)!=null?s:e.responseModel,e.responseTimestamp=(i=t.created)!=null?i:e.responseTimestamp,t.usage&&(e.promptTokens=t.usage.prompt_tokens,e.completionTokens=t.usage.completion_tokens,e.totalTokens=t.usage.total_tokens);for(const u of(o=t.choices)!=null?o:[])n&&((a=u.delta)!=null&&a.content&&e.responseTexts.push(u.delta.content),(c=u.delta)!=null&&c.tool_calls&&cf(u.delta.tool_calls,e)),u.finish_reason&&e.finishReasons.push(u.finish_reason)}function lf(t,e,n,r){var i,o,a;if(!(t&&typeof t=="object")){e.eventTypes.push("unknown:non-object");return}if(t instanceof Error){r.setStatus({code:v,message:"internal_error"}),D(t,{mechanism:{handled:!1,type:"auto.ai.openai.stream-response"}});return}if(!("type"in t))return;const s=t;if(!Kl.includes(s.type)){e.eventTypes.push(s.type);return}if(n&&(s.type==="response.output_item.done"&&"item"in s&&e.responsesApiToolCalls.push(s.item),s.type==="response.output_text.delta"&&"delta"in s&&s.delta)){e.responseTexts.push(s.delta);return}if("response"in s){const{response:c}=s;e.responseId=(i=c.id)!=null?i:e.responseId,e.responseModel=(o=c.model)!=null?o:e.responseModel,e.responseTimestamp=(a=c.created_at)!=null?a:e.responseTimestamp,c.usage&&(e.promptTokens=c.usage.input_tokens,e.completionTokens=c.usage.output_tokens,e.totalTokens=c.usage.total_tokens),c.status&&e.finishReasons.push(c.status),n&&c.output_text&&e.responseTexts.push(c.output_text)}}function ff(t,e,n){return Se(this,null,function*(){const r={eventTypes:[],responseTexts:[],finishReasons:[],responseId:"",responseModel:"",responseTimestamp:0,promptTokens:void 0,completionTokens:void 0,totalTokens:void 0,chatCompletionToolCalls:{},responsesApiToolCalls:[]};try{try{for(var s=Ee(t),i,o,a;i=!(o=yield new it(s.next())).done;i=!1){const c=o.value;rf(c)?uf(c,r,n):nf(c)&&lf(c,r,n,e),yield c}}catch(o){a=[o]}finally{try{i&&(o=s.return)&&(yield new it(o.call(s)))}finally{if(a)throw a[0]}}}finally{Er(e,r.responseId,r.responseModel,r.responseTimestamp),fn(e,r.promptTokens,r.completionTokens,r.totalTokens),e.setAttributes({[ln]:!0}),r.finishReasons.length&&e.setAttributes({[qt]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length&&e.setAttributes({[Y]:r.responseTexts.join("")});const u=[...Object.values(r.chatCompletionToolCalls),...r.responsesApiToolCalls];u.length>0&&e.setAttributes({[pt]:JSON.stringify(u)}),e.end()}})}function pf(t,e){var r;const n={[fr]:"openai",[_r]:Sr(e),[L]:"auto.ai.openai"};if(t.length>0&&typeof t[0]=="object"&&t[0]!==null){const s=t[0],i=Array.isArray(s.tools)?s.tools:[],a=s.web_search_options&&typeof s.web_search_options=="object"?[p({type:"web_search_options"},s.web_search_options)]:[],c=[...i,...a];c.length>0&&(n[gr]=JSON.stringify(c))}if(t.length>0&&typeof t[0]=="object"&&t[0]!==null){const s=t[0];n[q]=(r=s.model)!=null?r:"unknown","temperature"in s&&(n[pr]=s.temperature),"top_p"in s&&(n[mr]=s.top_p),"frequency_penalty"in s&&(n[dr]=s.frequency_penalty),"presence_penalty"in s&&(n[Ui]=s.presence_penalty),"stream"in s&&(n[Li]=s.stream),"encoding_format"in s&&(n[Cl]=s.encoding_format),"dimensions"in s&&(n[Pl]=s.dimensions)}else n[q]="unknown";return n}function df(t,e,n){var s;if(!e||typeof e!="object")return;const r=e;if(Ql(r)){if(sf(t,r,n),n&&((s=r.choices)!=null&&s.length)){const i=r.choices.map(o=>{var a;return((a=o.message)==null?void 0:a.content)||""});t.setAttributes({[Y]:JSON.stringify(i)})}}else tf(r)?(of(t,r,n),n&&r.output_text&&t.setAttributes({[Y]:r.output_text})):ef(r)&&af(t,r)}function Is(t,e){if("messages"in e){const n=yt(e.messages);t.setAttributes({[ht]:n})}if("input"in e){const n=yt(e.input);t.setAttributes({[ht]:n})}}function mf(){var s,i,o,a;const e=O().getClient(),n=e==null?void 0:e.getIntegrationByName(Jl),r=n?!!(e!=null&&e.getOptions().sendDefaultPii):!1;return{recordInputs:(i=(s=n==null?void 0:n.options)==null?void 0:s.recordInputs)!=null?i:r,recordOutputs:(a=(o=n==null?void 0:n.options)==null?void 0:o.recordOutputs)!=null?a:r}}function _f(t,e,n,r){return function(...i){return F(this,null,function*(){const o=r||mf(),a=pf(i,e),c=a[q]||"unknown",u=Sr(e),f=i[0];return f&&typeof f=="object"&&f.stream===!0?oe({name:`${u} ${c} stream-response`,op:Ts(e),attributes:a},m=>F(null,null,function*(){var l;try{o.recordInputs&&i[0]&&typeof i[0]=="object"&&Is(m,i[0]);const h=yield t.apply(n,i);return ff(h,m,(l=o.recordOutputs)!=null?l:!1)}catch(h){throw m.setStatus({code:v,message:"internal_error"}),D(h,{mechanism:{handled:!1,type:"auto.ai.openai.stream",data:{function:e}}}),m.end(),h}})):Gt({name:`${u} ${c}`,op:Ts(e),attributes:a},m=>F(null,null,function*(){try{o.recordInputs&&i[0]&&typeof i[0]=="object"&&Is(m,i[0]);const l=yield t.apply(n,i);return df(m,l,o.recordOutputs),l}catch(l){throw D(l,{mechanism:{handled:!1,type:"auto.ai.openai",data:{function:e}}}),l}}))})}}function zi(t,e="",n){return new Proxy(t,{get(r,s){const i=r[s],o=Zl(e,String(s));return typeof i=="function"&&Xl(o)?_f(i,o,r,n):typeof i=="function"?i.bind(r):i&&typeof i=="object"?zi(i,o,n):i}})}function gf(t,e){return zi(t,"",e)}function hf(t,e){var n,r;return"type"in t&&typeof t.type=="string"&&t.type==="error"?(e.setStatus({code:v,message:(r=(n=t.error)==null?void 0:n.type)!=null?r:"internal_error"}),D(t.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}),!0):!1}function yf(t,e){if(t.type==="message_delta"&&t.usage&&"output_tokens"in t.usage&&typeof t.usage.output_tokens=="number"&&(e.completionTokens=t.usage.output_tokens),t.message){const n=t.message;n.id&&(e.responseId=n.id),n.model&&(e.responseModel=n.model),n.stop_reason&&e.finishReasons.push(n.stop_reason),n.usage&&(typeof n.usage.input_tokens=="number"&&(e.promptTokens=n.usage.input_tokens),typeof n.usage.cache_creation_input_tokens=="number"&&(e.cacheCreationInputTokens=n.usage.cache_creation_input_tokens),typeof n.usage.cache_read_input_tokens=="number"&&(e.cacheReadInputTokens=n.usage.cache_read_input_tokens))}}function Sf(t,e){t.type!=="content_block_start"||typeof t.index!="number"||!t.content_block||(t.content_block.type==="tool_use"||t.content_block.type==="server_tool_use")&&(e.activeToolBlocks[t.index]={id:t.content_block.id,name:t.content_block.name,inputJsonParts:[]})}function Ef(t,e,n){if(!(t.type!=="content_block_delta"||!t.delta)){if(typeof t.index=="number"&&"partial_json"in t.delta&&typeof t.delta.partial_json=="string"){const r=e.activeToolBlocks[t.index];r&&r.inputJsonParts.push(t.delta.partial_json)}n&&typeof t.delta.text=="string"&&e.responseTexts.push(t.delta.text)}}function bf(t,e){if(t.type!=="content_block_stop"||typeof t.index!="number")return;const n=e.activeToolBlocks[t.index];if(!n)return;const r=n.inputJsonParts.join("");let s;try{s=r?JSON.parse(r):{}}catch(i){s={__unparsed:r}}e.toolCalls.push({type:"tool_use",id:n.id,name:n.name,input:s}),delete e.activeToolBlocks[t.index]}function qi(t,e,n,r){!(t&&typeof t=="object")||hf(t,r)||(yf(t,e),Sf(t,e),Ef(t,e,n),bf(t,e))}function Tf(t,e,n){e.isRecording()&&(t.responseId&&e.setAttributes({[pe]:t.responseId}),t.responseModel&&e.setAttributes({[Wt]:t.responseModel}),yr(e,t.promptTokens,t.completionTokens,t.cacheCreationInputTokens,t.cacheReadInputTokens),e.setAttributes({[ln]:!0}),t.finishReasons.length>0&&e.setAttributes({[qt]:JSON.stringify(t.finishReasons)}),n&&t.responseTexts.length>0&&e.setAttributes({[Y]:t.responseTexts.join("")}),n&&t.toolCalls.length>0&&e.setAttributes({[pt]:JSON.stringify(t.toolCalls)}),e.end())}function If(t,e,n){return Se(this,null,function*(){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};try{try{for(var s=Ee(t),i,o,a;i=!(o=yield new it(s.next())).done;i=!1){const c=o.value;qi(c,r,n,e),yield c}}catch(o){a=[o]}finally{try{i&&(o=s.return)&&(yield new it(o.call(s)))}finally{if(a)throw a[0]}}}finally{r.responseId&&e.setAttributes({[pe]:r.responseId}),r.responseModel&&e.setAttributes({[Wt]:r.responseModel}),yr(e,r.promptTokens,r.completionTokens,r.cacheCreationInputTokens,r.cacheReadInputTokens),e.setAttributes({[ln]:!0}),r.finishReasons.length>0&&e.setAttributes({[qt]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length>0&&e.setAttributes({[Y]:r.responseTexts.join("")}),n&&r.toolCalls.length>0&&e.setAttributes({[pt]:JSON.stringify(r.toolCalls)}),e.end()}})}function Af(t,e,n){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};return t.on("streamEvent",s=>{qi(s,r,n,e)}),t.on("message",()=>{Tf(r,e,n)}),t.on("error",s=>{D(s,{mechanism:{handled:!1,type:"auto.ai.anthropic.stream_error"}}),e.isRecording()&&(e.setStatus({code:v,message:"stream_error"}),e.end())}),t}const Rf=["messages.create","messages.stream","messages.countTokens","models.get","completions.create","models.retrieve","beta.messages.create"];function Nf(t){return Rf.includes(t)}function kf(t,e){e.error&&(t.setStatus({code:v,message:e.error.type||"internal_error"}),D(e.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}))}function vf(t,e){var r;const n={[fr]:"anthropic",[_r]:de(e),[L]:"auto.ai.anthropic"};if(t.length>0&&typeof t[0]=="object"&&t[0]!==null){const s=t[0];s.tools&&Array.isArray(s.tools)&&(n[gr]=JSON.stringify(s.tools)),n[q]=(r=s.model)!=null?r:"unknown","temperature"in s&&(n[pr]=s.temperature),"top_p"in s&&(n[mr]=s.top_p),"stream"in s&&(n[Li]=s.stream),"top_k"in s&&(n[ji]=s.top_k),"frequency_penalty"in s&&(n[dr]=s.frequency_penalty),"max_tokens"in s&&(n[Fi]=s.max_tokens)}else e==="models.retrieve"||e==="models.get"?n[q]=t[0]:n[q]="unknown";return n}function Un(t,e){if("messages"in e){const n=yt(e.messages);t.setAttributes({[ht]:n})}if("input"in e){const n=yt(e.input);t.setAttributes({[ht]:n})}"prompt"in e&&t.setAttributes({[wl]:JSON.stringify(e.prompt)})}function Of(t,e){if("content"in e&&Array.isArray(e.content)){t.setAttributes({[Y]:e.content.map(r=>r.text).filter(r=>!!r).join("")});const n=[];for(const r of e.content)(r.type==="tool_use"||r.type==="server_tool_use")&&n.push(r);n.length>0&&t.setAttributes({[pt]:JSON.stringify(n)})}"completion"in e&&t.setAttributes({[Y]:e.completion}),"input_tokens"in e&&t.setAttributes({[Y]:JSON.stringify(e.input_tokens)})}function Mf(t,e){"id"in e&&"model"in e&&(t.setAttributes({[pe]:e.id,[Wt]:e.model}),"created"in e&&typeof e.created=="number"&&t.setAttributes({[Es]:new Date(e.created*1e3).toISOString()}),"created_at"in e&&typeof e.created_at=="number"&&t.setAttributes({[Es]:new Date(e.created_at*1e3).toISOString()}),"usage"in e&&e.usage&&yr(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.cache_creation_input_tokens,e.usage.cache_read_input_tokens))}function wf(t,e,n){if(!(!e||typeof e!="object")){if("type"in e&&e.type==="error"){kf(t,e);return}n&&Of(t,e),Mf(t,e)}}function As(t,e,n){throw D(t,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:n}}}),e.isRecording()&&(e.setStatus({code:v,message:"internal_error"}),e.end()),t}function Cf(t,e,n,r,s,i,o,a,c,u,f){var l;const d=(l=s[q])!=null?l:"unknown",m={name:`${i} ${d} stream-response`,op:Fe(o),attributes:s};return u&&!f?oe(m,h=>F(null,null,function*(){var y;try{c.recordInputs&&a&&Un(h,a);const _=yield t.apply(n,r);return If(_,h,(y=c.recordOutputs)!=null?y:!1)}catch(_){return As(_,h,o)}})):oe(m,h=>{var y;try{c.recordInputs&&a&&Un(h,a);const _=e.apply(n,r);return Af(_,h,(y=c.recordOutputs)!=null?y:!1)}catch(_){return As(_,h,o)}})}function Pf(t,e,n,r){return new Proxy(t,{apply(s,i,o){var l;const a=vf(o,e),c=(l=a[q])!=null?l:"unknown",u=de(e),f=typeof o[0]=="object"?o[0]:void 0,d=!!(f!=null&&f.stream),m=e==="messages.stream";return d||m?Cf(t,s,n,o,a,u,e,f,r,d,m):Gt({name:`${u} ${c}`,op:Fe(e),attributes:a},h=>(r.recordInputs&&f&&Un(h,f),nn(()=>s.apply(n,o),y=>{D(y,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:e}}})},()=>{},y=>wf(h,y,r.recordOutputs))))}})}function Wi(t,e="",n){return new Proxy(t,{get(r,s){const i=r[s],o=Hi(e,String(s));return typeof i=="function"&&Nf(o)?Pf(i,o,r,n):typeof i=="function"?i.bind(r):i&&typeof i=="object"?Wi(i,o,n):i}})}function xf(t,e){var s;const n=!!((s=M())!=null&&s.getOptions().sendDefaultPii),r=p({recordInputs:n,recordOutputs:n},e);return Wi(t,"",r)}const Rs=["models.generateContent","models.generateContentStream","chats.create","sendMessage","sendMessageStream"],Df="google_genai",Ji="chats.create",$f="chat";function Lf(t,e){var r;const n=t==null?void 0:t.promptFeedback;if(n!=null&&n.blockReason){const s=(r=n.blockReasonMessage)!=null?r:n.blockReason;return e.setStatus({code:v,message:`Content blocked: ${s}`}),D(`Content blocked: ${s}`,{mechanism:{handled:!1,type:"auto.ai.google_genai"}}),!0}return!1}function Ff(t,e){typeof t.responseId=="string"&&(e.responseId=t.responseId),typeof t.modelVersion=="string"&&(e.responseModel=t.modelVersion);const n=t.usageMetadata;n&&(typeof n.promptTokenCount=="number"&&(e.promptTokens=n.promptTokenCount),typeof n.candidatesTokenCount=="number"&&(e.completionTokens=n.candidatesTokenCount),typeof n.totalTokenCount=="number"&&(e.totalTokens=n.totalTokenCount))}function Uf(t,e,n){var r,s,i;Array.isArray(t.functionCalls)&&e.toolCalls.push(...t.functionCalls);for(const o of(r=t.candidates)!=null?r:[]){o!=null&&o.finishReason&&!e.finishReasons.includes(o.finishReason)&&e.finishReasons.push(o.finishReason);for(const a of(i=(s=o==null?void 0:o.content)==null?void 0:s.parts)!=null?i:[])n&&a.text&&e.responseTexts.push(a.text),a.functionCall&&e.toolCalls.push({type:"function",id:a.functionCall.id,name:a.functionCall.name,arguments:a.functionCall.args})}}function jf(t,e,n,r){!t||Lf(t,r)||(Ff(t,e),Uf(t,e,n))}function Bf(t,e,n){return Se(this,null,function*(){const r={responseTexts:[],finishReasons:[],toolCalls:[]};try{try{for(var s=Ee(t),i,o,a;i=!(o=yield new it(s.next())).done;i=!1){const c=o.value;jf(c,r,n,e),yield c}}catch(o){a=[o]}finally{try{i&&(o=s.return)&&(yield new it(o.call(s)))}finally{if(a)throw a[0]}}}finally{const c={[ln]:!0};r.responseId&&(c[pe]=r.responseId),r.responseModel&&(c[Wt]=r.responseModel),r.promptTokens!==void 0&&(c[an]=r.promptTokens),r.completionTokens!==void 0&&(c[cn]=r.completionTokens),r.totalTokens!==void 0&&(c[un]=r.totalTokens),r.finishReasons.length&&(c[qt]=JSON.stringify(r.finishReasons)),n&&r.responseTexts.length&&(c[Y]=r.responseTexts.join("")),n&&r.toolCalls.length&&(c[pt]=JSON.stringify(r.toolCalls)),e.setAttributes(c),e.end()}})}function Gf(t){if(Rs.includes(t))return!0;const e=t.split(".").pop();return Rs.includes(e)}function Hf(t){return t.includes("Stream")||t.endsWith("generateContentStream")||t.endsWith("sendMessageStream")}function Ns(t,e){if("model"in t&&typeof t.model=="string")return t.model;if(e&&typeof e=="object"){const n=e;if("model"in n&&typeof n.model=="string")return n.model;if("modelVersion"in n&&typeof n.modelVersion=="string")return n.modelVersion}return"unknown"}function zf(t){const e={};return"temperature"in t&&typeof t.temperature=="number"&&(e[pr]=t.temperature),"topP"in t&&typeof t.topP=="number"&&(e[mr]=t.topP),"topK"in t&&typeof t.topK=="number"&&(e[ji]=t.topK),"maxOutputTokens"in t&&typeof t.maxOutputTokens=="number"&&(e[Fi]=t.maxOutputTokens),"frequencyPenalty"in t&&typeof t.frequencyPenalty=="number"&&(e[dr]=t.frequencyPenalty),"presencePenalty"in t&&typeof t.presencePenalty=="number"&&(e[Ui]=t.presencePenalty),e}function qf(t,e,n){const r={[fr]:Df,[_r]:de(t),[L]:"auto.ai.google_genai"};if(e){if(r[q]=Ns(e,n),"config"in e&&typeof e.config=="object"&&e.config){const s=e.config;if(Object.assign(r,zf(s)),"tools"in s&&Array.isArray(s.tools)){const i=s.tools.flatMap(o=>o.functionDeclarations);r[gr]=JSON.stringify(i)}}}else r[q]=Ns({},n);return r}function ks(t,e){if("contents"in e){const n=e.contents,r=yt(n);t.setAttributes({[ht]:r})}if("message"in e){const n=e.message,r=yt(n);t.setAttributes({[ht]:r})}if("history"in e){const n=e.history,r=yt(n);t.setAttributes({[ht]:r})}}function Wf(t,e,n){if(!(!e||typeof e!="object")){if(e.usageMetadata&&typeof e.usageMetadata=="object"){const r=e.usageMetadata;typeof r.promptTokenCount=="number"&&t.setAttributes({[an]:r.promptTokenCount}),typeof r.candidatesTokenCount=="number"&&t.setAttributes({[cn]:r.candidatesTokenCount}),typeof r.totalTokenCount=="number"&&t.setAttributes({[un]:r.totalTokenCount})}if(n&&Array.isArray(e.candidates)&&e.candidates.length>0){const r=e.candidates.map(s=>{var i;return(i=s.content)!=null&&i.parts&&Array.isArray(s.content.parts)?s.content.parts.map(o=>typeof o.text=="string"?o.text:"").filter(o=>o.length>0).join(""):""}).filter(s=>s.length>0);r.length>0&&t.setAttributes({[Y]:r.join("")})}if(n&&e.functionCalls){const r=e.functionCalls;Array.isArray(r)&&r.length>0&&t.setAttributes({[pt]:JSON.stringify(r)})}}}function vs(t,e,n,r){const s=e===Ji;return new Proxy(t,{apply(i,o,a){var m;const c=a[0],u=qf(e,c,n),f=(m=u[q])!=null?m:"unknown",d=de(e);return Hf(e)?oe({name:`${d} ${f} stream-response`,op:Fe(e),attributes:u},l=>F(null,null,function*(){try{r.recordInputs&&c&&ks(l,c);const h=yield i.apply(n,a);return Bf(h,l,!!r.recordOutputs)}catch(h){throw l.setStatus({code:v,message:"internal_error"}),D(h,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}}),l.end(),h}})):Gt({name:s?`${d} ${f} create`:`${d} ${f}`,op:Fe(e),attributes:u},l=>(r.recordInputs&&c&&ks(l,c),nn(()=>i.apply(n,a),h=>{D(h,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}})},()=>{},h=>{s||Wf(l,h,r.recordOutputs)})))}})}function jn(t,e="",n){return new Proxy(t,{get:(r,s,i)=>{const o=Reflect.get(r,s,i),a=Hi(e,String(s));if(typeof o=="function"&&Gf(a)){if(a===Ji){const c=vs(o,a,r,n);return function(...f){const d=c(...f);return d&&typeof d=="object"?jn(d,$f,n):d}}return vs(o,a,r,n)}return typeof o=="function"?o.bind(r):o&&typeof o=="object"?jn(o,a,n):o}})}function Jf(t,e){var s;const n=!!((s=M())!=null&&s.getOptions().sendDefaultPii),r=p({recordInputs:n,recordOutputs:n},e);return jn(t,"",r)}const Vi="sentry.javascript.miniapp",Bn="10.27.0-rc.1",Oe="?",Vf=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Yf=/\((\S*)(?::(\d+))(?::(\d+))\)/,Kf=/^\s*at (.*?) ?\((\S*):(\d+):(\d+)\)/i;function br(t){let e=null;const n=t&&t.framesToPop;try{if(e=Zf(t),e)return Os(e,n)}catch(r){}try{if(e=Xf(t),e)return Os(e,n)}catch(r){}return{message:Tr(t),name:t&&t.name,stack:[],failed:!0}}function Xf(t){if(!t||!t.stack)return null;const e=[],n=t.stack.split(`
`);let r,s,i,o;for(let a=0;a<n.length;++a){if(i=Vf.exec(n[a])){const c=i[2]&&i[2].indexOf("native")===0;r=i[2]&&i[2].indexOf("eval")===0,r&&(s=Yf.exec(i[2]))&&(i[2]=s[1],i[3]=s[2],i[4]=s[3]),o={url:i[2],func:i[1]||Oe,args:c?[i[2]]:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null}}else if(i=Kf.exec(n[a]))o={url:i[2],func:i[1]||Oe,args:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null};else continue;!o.func&&o.line&&(o.func=Oe),e.push(o)}return e.length?{message:Tr(t),name:t.name,stack:e}:null}function Zf(t){if(!t||!t.stacktrace)return null;const e=t.stacktrace,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,s=e.split(`
`),i=[];let o;for(let a=0;a<s.length;a+=2){let c=null;(o=n.exec(s[a]))?c={url:o[2],func:o[3],args:[],line:+o[1],column:null}:(o=r.exec(s[a]))&&(c={url:o[6],func:o[3]||o[4],args:o[5]?o[5].split(","):[],line:+o[1],column:+o[2]}),c&&(!c.func&&c.line&&(c.func=Oe),i.push(c))}return i.length?{message:Tr(t),name:t.name,stack:i}:null}function Os(t,e){try{return b(p({},t),{stack:t.stack.slice(e)})}catch(n){return t}}function Tr(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}const Qf=100;function Ir(t){const e=br(t),n=Ar(e.stack),r={type:tp(t),value:ep(t)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function tp(t){const e=t==null?void 0:t.name;return!e&&Yi(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function ep(t){const e=t==null?void 0:t.message;return Yi(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function Yi(t){return typeof WebAssembly!="undefined"&&typeof WebAssembly.Exception!="undefined"?t instanceof WebAssembly.Exception:!1}function np(t,e,n){const r=M(),s=r==null?void 0:r.getOptions().normalizeDepth,i=cp(t),o={__serialized__:ci(t,s)};if(i)return{exception:{values:[Ir(i)]},extra:o};const a={exception:{values:[{type:Ke(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:op(t,{isUnhandledRejection:n})}]},extra:o};if(e){const c=br(e),u=Ar(c.stack);u.length&&(a.exception.values[0].stacktrace={frames:u})}return a}function Tn(t){return{exception:{values:[Ir(t)]}}}function rp(t,e,n){const r=(e==null?void 0:e.syntheticException)||void 0,s=ip(t,r,n);return ct(s),s.level="error",e!=null&&e.event_id&&(s.event_id=e.event_id),Ht(s)}function sp(t,e="info",n,r){const s=(n==null?void 0:n.syntheticException)||void 0,i=Gn(t,s,r);return i.level=e,n!=null&&n.event_id&&(i.event_id=n.event_id),Ht(i)}function ip(t,e,n,r){let s;if(Fs(t)&&t.error)return Tn(t.error);if(Pr(t)||Eo(t)){const i=t;if("stack"in t)s=Tn(t);else{const o=i.name||(Pr(i)?"DOMError":"DOMException"),a=i.message?`${o}: ${i.message}`:o;s=Gn(a,e,n),Rn(s,a)}return"code"in i&&(s.tags=b(p({},s.tags),{"DOMException.code":`${i.code}`})),s}return mt(t)?Tn(t):St(t)||Ke(t)?(s=np(t,e,r),ct(s,{synthetic:!0}),s):(s=Gn(t,e,n),Rn(s,`${t}`),ct(s,{synthetic:!0}),s)}function Gn(t,e,n){const r={};if(n&&e){const s=br(e),i=Ar(s.stack);i.length&&(r.exception={values:[{value:t,stacktrace:{frames:i}}]}),ct(r,{synthetic:!0})}if(Ye(t)){const{__sentry_template_string__:s,__sentry_template_values__:i}=t;return r.logentry={message:s,params:i},r}return r.message=t,r}function op(t,{isUnhandledRejection:e}){const n=vo(t),r="exception";return Fs(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Ke(t)?`Event \`${ap(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function ap(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch(e){}}function cp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}function Ar(t){if(!t||!t.length)return[];let e=t;const n=e[0].func||"",r=e[e.length-1].func||"";return(n.indexOf("captureMessage")!==-1||n.indexOf("captureException")!==-1)&&(e=e.slice(1)),r.indexOf("sentryWrapped")!==-1&&(e=e.slice(0,-1)),e.map(s=>({colno:s.column===null?void 0:s.column,filename:s.url||e[0].url,function:s.func||"?",in_app:!0,lineno:s.line===null?void 0:s.line})).slice(0,Qf).reverse()}const up=()=>{let t={request:()=>{},httpRequest:()=>{},getSystemInfoSync:()=>{},getPerformance:()=>({}),onAppHide:function(e){},canIUse:function(e){return!1}};if(typeof wx=="object")t=wx;else if(typeof my=="object")t=my;else if(typeof tt=="object")t=tt;else if(typeof dd=="object")t=dd;else if(typeof qq=="object")t=qq;else if(typeof swan=="object")t=swan;else throw new Error("sentry-miniapp ");return t},lp=()=>{let t="unknown";return typeof wx=="object"?t="wechat":typeof my=="object"?t="alipay":typeof tt=="object"?t="bytedance":typeof dd=="object"?t="dingtalk":typeof qq=="object"?t="qq":typeof swan=="object"&&(t="swan"),t},w=up(),Ki=lp(),fp="application/json";function Rr(t){function e(n){return new Pt((r,s)=>{const i=w.request||w.httpRequest;if(typeof i!="function"){s(new Error("Miniapp request function is not available"));return}i({url:t.url,method:"POST",data:n.body,header:{"content-type":fp},success(o){var a,c,u,f;r({statusCode:o==null?void 0:o.statusCode,headers:{"x-sentry-rate-limits":(c=(a=o==null?void 0:o.headers)==null?void 0:a["X-Sentry-Rate-Limits"])!=null?c:null,"retry-after":(f=(u=o==null?void 0:o.headers)==null?void 0:u["Retry-After"])!=null?f:null}})},fail(o){s(o)}})})}return Dc(t,e)}const pp=Object.freeze(Object.defineProperty({__proto__:null,makeMiniappTransport:Rr},Symbol.toStringTag,{value:"Module"})),dp=()=>[];class Xi extends jc{constructor(e={}){const n=e.transport||Rr,r=e.stackParser||dp,s=e.integrations||e.defaultIntegrations||[],i=b(p({},e),{transport:n,stackParser:r,integrations:s,dsn:e.dsn,tracesSampleRate:e.tracesSampleRate});Zc(i,"miniapp",["miniapp"]),super(i)}_prepareEvent(e,n,r,s){return e.platform=e.platform||"javascript",e.sdk=b(p({},e.sdk),{name:Vi,packages:[...e.sdk&&e.sdk.packages||[],{name:"npm:@sentry/miniapp",version:Bn}],version:Bn}),super._prepareEvent(e,n,r,s)}showReportDialog(e={}){console.log("sentry-miniapp ",e)}eventFromException(e,n){return rp(e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return sp(e,n,r,this._options.attachStacktrace)}}function mp(){setTimeout(()=>{})}function Ot(t,e={},n){if(typeof t!="function")return t;try{const s=t.__sentry_wrapped__;if(s)return s;if(Bs(t))return t}catch(s){return t}const r=function(...s){try{const i=s.map(o=>Ot(o,e));return t.handleEvent?t.handleEvent.apply(this,i):t.apply(this,i)}catch(i){throw mp(),rt(o=>{o.addEventProcessor(a=>{const c=p({},a);return e.mechanism&&(Rn(c,void 0),ct(c,e.mechanism)),c.extra=b(p({},c.extra),{arguments:G(s,3)}),c}),D(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch(s){}js(r,t),W(t,"__sentry_wrapped__",r);try{const s=Object.getOwnPropertyDescriptor(r,"name");s!=null&&s.configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch(s){}return r}const We=class We{constructor(e){this.name=We.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._onPageNotFoundHandlerInstalled=!1,this._onMemoryWarningHandlerInstalled=!1,this._options=p({onerror:!0,onunhandledrejection:!0,onpagenotfound:!0,onmemorywarning:!0},e)}setupOnce(){Error.stackTraceLimit=50,this._options.onerror&&(g.log("Global Handler attached: onError"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(g.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler()),this._options.onpagenotfound&&(g.log("Global Handler attached: onPageNotFound"),this._installGlobalOnPageNotFoundHandler()),this._options.onmemorywarning&&(g.log("Global Handler attached: onMemoryWarning"),this._installGlobalOnMemoryWarningHandler())}_installGlobalOnErrorHandler(){this._onErrorHandlerInstalled||(w.onError&&w.onError(e=>{const n=typeof e=="string"?new Error(e):e;D(n)}),this._onErrorHandlerInstalled=!0)}_installGlobalOnUnhandledRejectionHandler(){this._onUnhandledRejectionHandlerInstalled||(w.onUnhandledRejection&&w.onUnhandledRejection(({reason:e,promise:n})=>{const r=typeof e=="string"?new Error(e):e;D(r,{data:n})}),this._onUnhandledRejectionHandlerInstalled=!0)}_installGlobalOnPageNotFoundHandler(){this._onPageNotFoundHandlerInstalled||(w.onPageNotFound&&w.onPageNotFound(e=>{const n=e.path.split("?")[0];$n("pagenotfound",n),Dn("message",JSON.stringify(e)),xn(`: ${n}`)}),this._onPageNotFoundHandlerInstalled=!0)}_installGlobalOnMemoryWarningHandler(){this._onMemoryWarningHandlerInstalled||(w.onMemoryWarning&&w.onMemoryWarning(({level:e=-1})=>{let n="";switch(e){case 5:n="TRIM_MEMORY_RUNNING_MODERATE";break;case 10:n="TRIM_MEMORY_RUNNING_LOW";break;case 15:n="TRIM_MEMORY_RUNNING_CRITICAL";break;default:return}$n("memory-warning",String(e)),Dn("message",n),xn("")}),this._onMemoryWarningHandlerInstalled=!0)}};We.id="GlobalHandlers";let Ue=We;const Je=class Je{constructor(){this._ignoreOnError=0,this.name=Je.id}_wrapTimeFunction(e){return function(...n){const r=n[0];return n[0]=Ot(r,{mechanism:{data:{function:Ae(e)},handled:!0,type:"instrument"}}),e.apply(this,n)}}_wrapRAF(e){return function(n){return e(Ot(n,{mechanism:{data:{function:"requestAnimationFrame",handler:Ae(e)},handled:!0,type:"instrument"}}))}}_wrapEventTarget(e){const n=I,r=n[e]&&n[e].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(kt(r,"addEventListener",function(s){return function(i,o,a){try{typeof o.handleEvent=="function"&&(o.handleEvent=Ot(o.handleEvent.bind(o),{mechanism:{data:{function:"handleEvent",handler:Ae(o),target:e},handled:!0,type:"instrument"}}))}catch(c){}return s.call(this,i,Ot(o,{mechanism:{data:{function:"addEventListener",handler:Ae(o),target:e},handled:!0,type:"instrument"}}),a)}}),kt(r,"removeEventListener",function(s){return function(i,o,a){let c=o;try{c=c&&(c.__sentry_wrapped__||c)}catch(u){}return s.call(this,i,c,a)}}))}setupOnce(){this._ignoreOnError=this._ignoreOnError;const e=I;kt(e,"setTimeout",this._wrapTimeFunction.bind(this)),kt(e,"setInterval",this._wrapTimeFunction.bind(this)),kt(e,"requestAnimationFrame",this._wrapRAF.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))}};Je.id="TryCatch";let je=Je;function Ae(t){try{return t&&t.name||"<anonymous>"}catch(e){return"<anonymous>"}}const _p="cause",gp=5,Zt=class Zt{constructor(e={}){this.name=Zt.id,this._key=e.key||_p,this._limit=e.limit||gp}setupOnce(){fe((e,n)=>{const r=M(),s=r&&r.getIntegrationByName(Zt.id);return s?s._handler(e,n):e})}_handler(e,n){if(!e.exception||!e.exception.values||!n||!(n.originalException instanceof Error))return e;const r=this._walkErrorTree(n.originalException,this._key);return e.exception.values=[...r,...e.exception.values],e}_walkErrorTree(e,n,r=[]){if(!(e[n]instanceof Error)||r.length+1>=this._limit)return r;const s=Ir(e[n]);return this._walkErrorTree(e[n],n,[s,...r])}};Zt.id="LinkedErrors";let Be=Zt;const Qt=class Qt{constructor(){this.name=Qt.id}setupOnce(){fe(e=>{const n=M();if(n&&n.getIntegrationByName(Qt.id))try{const s=w.getSystemInfoSync(),{SDKVersion:i="0.0.0",batteryLevel:o,currentBattery:a,battery:c,brand:u,language:f,model:d,pixelRatio:m,platform:l,screenHeight:h,screenWidth:y,system:_,version:E,app:T,appName:k}=s,[A,$]=_.split(" "),X=b(p({},e.tags),{SDKVersion:i}),R=T||k||Ki||"app";return b(p({},e),{tags:X,contexts:b(p({},e.contexts),{device:{brand:u,battery_level:o||a||c,model:d,language:f,platform:l,screen_dpi:m,screen_height:h,screen_width:y},os:{name:A||_,version:$||_},browser:{name:R,version:E}})})}catch(s){console.warn(`sentry-miniapp get system info fail: ${s}`)}return e})}};Qt.id="System";let Ge=Qt;const te=class te{constructor(e){this.name=te.id,this._options=p({enable:!0},e)}setupOnce(){fe(e=>{const n=M();if(n&&n.getIntegrationByName(te.id)&&this._options.enable)try{const s=getCurrentPages().map(i=>({route:i.route,options:i.options}));return b(p({},e),{extra:b(p({},e.extra),{routers:s})})}catch(s){console.warn(`sentry-miniapp get router info fail: ${s}`)}return e})}};te.id="Router";let He=te;const ee=class ee{constructor(){this.name=ee.id}setupOnce(){fe(e=>{const n=M();return n&&n.getIntegrationByName(ee.id)&&Ki==="wechat"&&w.getLaunchOptionsSync&&w.getLaunchOptionsSync().scene===1129?null:e})}};ee.id="IgnoreMpcrawlerErrors";let ze=ee;const hp=Object.freeze(Object.defineProperty({__proto__:null,GlobalHandlers:Ue,IgnoreMpcrawlerErrors:ze,LinkedErrors:Be,Router:He,System:Ge,TryCatch:je},Symbol.toStringTag,{value:"Module"})),Zi=[iu(),nu(),new je,new Ue,new Be,new Ge,new He,new ze];function yp(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=Zi),t.normalizeDepth=t.normalizeDepth||5;const e=p({integrations:t.integrations||t.defaultIntegrations||[],stackParser:t.stackParser||(()=>[]),transport:t.transport||Rr},t);qc(Xi,e)}function Sp(t={}){t.eventId||(t.eventId=di());const e=M();e&&e.showReportDialog(t)}function Ep(){return di()}function bp(t){const e=M();return e?e.flush(t):Ht(!1)}function Tp(t){const e=M();return e?e.close(t):Ht(!1)}function Ip(t){return Ot(t)()}const Ms=2147483647;function U(t){return typeof t=="number"&&isFinite(t)}function at(t){return t/1e3}function Kt(t,e,n,r){const s=N(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),le(t,()=>{const i=nr(p({startTime:e},r));return i&&i.end(n),i})}function Ap(t,e){return e.some(n=>typeof n=="string"?t===n:n.test(t))}class Rp{constructor(e=!1){this._reportAllChanges=e,this._measurements={},this._performanceCursor=0}addPerformanceEntries(e,n={}){var u;const r=this._getPerformance();if(!r)return;const s=this._getMiniProgramTimeOrigin(r);if(!s)return;const i=at(s),{op:o,start_timestamp:a}=N(e),c=((u=r.getEntries)==null?void 0:u.call(r))||[];c.slice(this._performanceCursor).forEach(f=>{const d=at(f.startTime),m=at(Math.max(0,f.duration));if(!(o==="navigation"&&a&&i+d<a)&&!this._shouldIgnoreEntry(f,n))switch(f.entryType){case"navigation":{this._addNavigationSpans(e,f,i);break}case"render":{this._addRenderSpan(e,f,d,m,i);break}case"script":{this._addScriptSpan(e,f,d,m,i);break}case"loadPackage":{this._addPackageSpan(e,f,d,m,i);break}case"resource":{this._addResourceSpan(e,f,d,m,i,n.ignoreResourceSpans);break}}}),this._performanceCursor=Math.max(c.length-1,0),this._trackSystemInfo(e),(o==="pageload"||o==="navigation")&&(e.setAttribute("performance.timeOrigin",i),Object.entries(this._measurements).forEach(([f,d])=>{li(f,d.value,d.unit)})),this._measurements={}}addPerformanceEntriesFromSpan(e){this.addPerformanceEntries(e),this._stopObserver()}startObserving(e,n={}){var i;const r=this._getPerformance();if(!r)return;const s=N(e);this._timeOrigin=this._getTimeOrigin(r,s.start_timestamp),this._measurements={},this._performanceCursor=0,this._observer=(i=r.createObserver)==null?void 0:i.call(r,o=>{var u;const a=((u=o==null?void 0:o.getEntries)==null?void 0:u.call(o))||[],c=N(e);if(c.timestamp!==void 0){this._stopObserver();return}a.forEach(f=>this._handleEntry(e,f,c.start_timestamp,n))}),this._observer&&this._observer.observe({entryTypes:["navigation","render","script","loadPackage","resource"]})}_getPerformance(){if(!w.getPerformance)return;const e=w.getPerformance();if(e)return e}_getMiniProgramTimeOrigin(e){if(typeof e.timeOrigin=="number")return e.timeOrigin;const n=typeof e.now=="function"?e.now():void 0;if(typeof n=="number")return Date.now()-n}_getTimeOrigin(e,n){const r=this._getMiniProgramTimeOrigin(e);return r?at(r):n}_shouldIgnoreEntry(e,n){const{ignorePerformanceEntryNames:r=[]}=n;return r.length>0&&e.name?Ap(e.name,r):!1}_handleEntry(e,n,r,s={}){var c;const i=(c=this._timeOrigin)!=null?c:r,o=at(n.startTime),a=at(Math.max(0,n.duration));if(!this._shouldIgnoreEntry(n,s)){switch(n.entryType){case"navigation":this._addNavigationSpans(e,n,i);break;case"render":this._addRenderSpan(e,n,o,a,i);break;case"script":this._addScriptSpan(e,n,o,a,i);break;case"loadPackage":this._addPackageSpan(e,n,o,a,i);break;case"resource":this._addResourceSpan(e,n,o,a,i,s.ignoreResourceSpans);break}this._recordMeasurements(n,r,i+o)}}_addNavigationSpans(e,n,r){const s=r+at(n.startTime),i=s+at(Math.max(0,n.duration)),o={[L]:"auto.ui.miniapp.metrics","performance.entry_type":n.entryType};n.path&&(o["navigation.path"]=n.path),n.referrerPath&&(o["navigation.referrer_path"]=n.referrerPath),U(n.viewLayerReadyTime)&&(o["navigation.view_layer_ready_time"]=n.viewLayerReadyTime),Kt(e,s,i,{name:n.path||n.name||"navigation",op:"browser.navigation",attributes:o}),U(n.duration)&&!this._measurements["navigation.duration"]&&(this._measurements["navigation.duration"]={value:n.duration,unit:"millisecond"}),U(n.viewLayerReadyTime)&&(this._measurements["navigation.view_layer_ready"]={value:n.viewLayerReadyTime,unit:"millisecond"})}_addRenderSpan(e,n,r,s,i){const o=i+r,a=o+s,c={[L]:"auto.ui.miniapp.metrics","performance.entry_type":n.entryType};n.path&&(c["ui.component_path"]=n.path),U(n.viewLayerReadyTime)&&(c["ui.view_layer_ready_time"]=n.viewLayerReadyTime),U(n.firstRenderTime)&&(c["ui.first_render_time"]=n.firstRenderTime),Kt(e,o,a,{name:n.path||n.name||"render",op:"ui.render",attributes:c}),U(n.firstRenderTime)&&(this._measurements["ui.first_render"]={value:n.firstRenderTime,unit:"millisecond"})}_addScriptSpan(e,n,r,s,i){const o=i+r,a=o+s,c={[L]:"auto.resource.miniapp.metrics","performance.entry_type":n.entryType};n.moduleName&&(c["code.filepath"]=n.moduleName),Kt(e,o,a,{name:n.moduleName||n.name||"script",op:"script",attributes:c})}_addPackageSpan(e,n,r,s,i){const o=i+r,a=o+s,c={[L]:"auto.resource.miniapp.metrics","performance.entry_type":n.entryType};n.packageName&&(c["resource.package_name"]=n.packageName),U(n.packageSize)&&n.packageSize<Ms&&(c["resource.package_size"]=n.packageSize),Kt(e,o,a,{name:n.packageName||n.name||"loadPackage",op:"resource.package",attributes:c})}_addResourceSpan(e,n,r,s,i,o){if(n.initiatorType==="xmlhttprequest"||n.initiatorType==="fetch")return;const a=n.initiatorType?`resource.${n.initiatorType}`:"resource.other";if(o!=null&&o.includes(a))return;const c=i+r,u=c+s,f={[L]:"auto.resource.miniapp.metrics","performance.entry_type":n.entryType};n.initiatorType&&(f["resource.initiator_type"]=n.initiatorType),U(n.transferSize)&&n.transferSize<Ms&&(f["http.response_transfer_size"]=n.transferSize),n.path&&(f["resource.path"]=n.path),Kt(e,c,u,{name:n.path||n.name||"resource",op:a,attributes:f})}_trackSystemInfo(e){if(w.getSystemInfoSync)try{const n=w.getSystemInfoSync();if(!n)return;n.networkType&&e.setAttribute("network.type",n.networkType),n.platform&&e.setAttribute("device.platform",n.platform),n.model&&e.setAttribute("device.model",n.model),n.system&&e.setAttribute("os.version",n.system),U(n.benchmarkLevel)&&e.setAttribute("device.benchmark_level",String(n.benchmarkLevel))}catch(n){}}_recordMeasurements(e,n,r){const s=(e.name||"").toLowerCase(),i=e.duration,o=Math.max((r-n)*1e3,0);if(s==="first-paint"||s==="firstpaint"?this._measurements.fp={value:o,unit:"millisecond"}:s==="first-contentful-paint"||s==="firstcontentfulpaint"?this._measurements.fcp={value:o,unit:"millisecond"}:s==="largest-contentful-paint"||s==="largestcontentfulpaint"||s==="lcp"?this._measurements.lcp={value:o,unit:"millisecond"}:(s==="first-input-delay"||s==="firstinputdelay"||s==="fid")&&U(i)&&(this._measurements.fid={value:i,unit:"millisecond"}),U(e.viewLayerReadyTime)&&!this._measurements.view_layer_ready&&(this._measurements.view_layer_ready={value:e.viewLayerReadyTime,unit:"millisecond"}),U(e.firstRenderTime)&&!this._measurements.first_render&&(this._measurements.first_render={value:e.firstRenderTime,unit:"millisecond"}),this._reportAllChanges&&U(i)){const a=this._measurementKey(e);a&&!this._measurements[a]&&(this._measurements[a]={value:i,unit:"millisecond"})}}_measurementKey(e){const n=e.name||e.entryType;if(n)return n.replace(/\s+/g,"_").toLowerCase()}_stopObserver(){var e;(e=this._observer)==null||e.disconnect(),this._observer=void 0}}const Np={traceRequest:!0},P=typeof __SENTRY_DEBUG__=="undefined"?!0:__SENTRY_DEBUG__;function Nr(){const t=It(),e=t&&H(t);if(!e)return;const n=N(e).op;return n==="navigation"||n==="pageload"?e:void 0}function Qi(t){return{name:t.path||"unknown",source:"url"}}function to(t,e){const n={[L]:e};return t.openType&&(n["miniapp.open_type"]=t.openType),t.scene!==void 0&&(n["miniapp.scene"]=t.scene),t.isTabBar!==void 0&&(n["miniapp.is_tabbar"]=t.isTabBar),t.webviewId!==void 0&&(n["miniapp.webview_id"]=t.webviewId),t.query&&(n["miniapp.query"]=t.query),n}function In(t){return{path:(t==null?void 0:t.path)||(t==null?void 0:t.route)||(t==null?void 0:t.url)||"unknown-route",query:t==null?void 0:t.query,scene:t==null?void 0:t.scene,openType:t==null?void 0:t.openType,isTabBar:t==null?void 0:t.isTabBar,webviewId:t==null?void 0:t.webviewId,routeEventId:t==null?void 0:t.routeEventId,timeStamp:t==null?void 0:t.timeStamp}}function ws(t,e=!1){return!!(t==="appLaunch"||e)}function eo(t,e){const{instrumentPageLoad:n=!0,instrumentNavigation:r=!0,endSpanOnRouteComplete:s=!0}=t,i=I,o=i.wx||i.my;if(!o){P&&g.warn("[MiniAppTracing] No miniapp global object found");return}const a=w.onBeforeAppRoute||o.onBeforeAppRoute,c=w.onAppRoute||o.onAppRoute,u=w.onAppRouteDone||o.onAppRouteDone,f=w.onBeforePageLoad||o.onBeforePageLoad,d=w.onAfterPageLoad||o.onAfterPageLoad,m=typeof a=="function";if(!m&&typeof c!="function"){P&&g.warn("[MiniAppTracing] No route event API available");return}let l=!0,h=!1;const y=new Map;if(n&&typeof i.getCurrentPages=="function"){const _=i.getCurrentPages()||[],E=_[_.length-1];if(E!=null&&E.route){h=!0,l=!1;const T={path:E.route,openType:"appLaunch"};An(T,e)}}m?(P&&g.log("[MiniAppTracing] Using new route event API (onBeforeAppRoute)"),a(_=>{const E=In(_),T=E.routeEventId,k=E.timeStamp?E.timeStamp/1e3:z();P&&g.log("[MiniAppTracing] onBeforeAppRoute:",E.path,"routeEventId:",T);const A=!h&&ws(E.openType,l);l&&(l=!1),!(A&&!n||!A&&!r)&&(T&&y.set(T,{route:E,startTime:k,isPageLoad:A}),A&&n?(h=!0,An(E,e,k)):r&&h&&Cs(E,e,k))}),typeof c=="function"&&c(_=>{const E=In(_),T=E.routeEventId,k=E.timeStamp?E.timeStamp/1e3:z();P&&g.log("[MiniAppTracing] onAppRoute:",E.path,"routeEventId:",T);const A=Nr();if(T){const $=y.get(T);if($){const X=(k-$.startTime)*1e3;A&&(A.setAttribute("miniapp.route_duration_ms",X),A.setAttribute("miniapp.route_event_id",T)),P&&g.log(`[MiniAppTracing] Route completed: ${E.path}, duration: ${X.toFixed(2)}ms`),y.delete(T)}}s&&A&&!N(A).timestamp&&(A.setAttribute(se,"routeComplete"),A.end(k),P&&g.log(`[MiniAppTracing] Ended span on onAppRoute: ${E.path}`))}),typeof u=="function"&&u(_=>{P&&g.log("[MiniAppTracing] onAppRouteDone:",_==null?void 0:_.path)})):(P&&g.log("[MiniAppTracing] Using legacy route event API (onAppRoute)"),c(_=>{const E=In(_),T=!h&&ws(E.openType,l);if(l&&(l=!1),T&&n){h=!0,An(E,e);return}r&&h&&Cs(E,e)}),typeof u=="function"&&u(_=>{P&&g.log("[MiniAppTracing] Route done:",_==null?void 0:_.path)})),typeof f=="function"&&f(_=>{P&&g.log("[MiniAppTracing] onBeforePageLoad:",_==null?void 0:_.path)}),typeof d=="function"&&d(_=>{P&&g.log("[MiniAppTracing] onAfterPageLoad:",_==null?void 0:_.path)})}function An(t,e,n){const{name:r,source:s}=Qi(t),i=to(t,"auto.pageload.miniapp");i[nt]=s;const o=Nr();if(o)(N(o).data||{})[nt]!=="custom"&&(o.updateName(r),o.setAttribute(nt,s)),o.setAttributes(i),P&&g.log(`[MiniAppTracing] Updated pageload span: ${r}`);else{O().setTransactionName(r);const a={name:r,op:"pageload",attributes:i};n!==void 0&&(a.startTime=n),e(a),P&&g.log(`[MiniAppTracing] Created pageload span: ${r}${n?" (with accurate timing)":""}`)}}function Cs(t,e,n){const{name:r,source:s}=Qi(t),i=to(t,"auto.navigation.miniapp");i[nt]=s,O().setTransactionName(r);const o={name:r,op:"navigation",attributes:i};n!==void 0&&(o.startTime=n),e(o),P&&g.log(`[MiniAppTracing] Created navigation span: ${r}${n?" (with accurate timing)":""}`)}function kp(){return Nr()}const vp=3600;let Mt,qe;function Op(){return{traceId:ut(),spanId:jt(),sampleRand:Math.random()}}function Mp(){return Mt||(Mt=Op()),Mt}function wp(t=!1){const e=Mt;return Mt={traceId:t&&e?e.traceId:ut(),spanId:jt(),sampleRand:Math.random()},Mt}function Cp(){return qe}function Pp(t,e,n,r,s,i){qe={spanContext:{traceId:t,spanId:e,traceFlags:n?1:0},startTimestamp:r,sampleRate:s,sampleRand:i}}function xp(){return qe?Date.now()/1e3-qe.startTimestamp<=vp:!1}const Dp=1e3,$p=3e4,Lp=15e3,Fp="MiniAppTracing",no="_sentry_miniapp_idleSpan";function kr(t){return t[no]}function Ps(t,e){W(t,no,e)}const Up=p({idleTimeout:Dp,finalTimeout:$p,childSpanTimeout:Lp,instrumentPageLoad:!0,instrumentNavigation:!0,endSpanOnRouteComplete:!0,traceContinuityMode:"link",consistentTraceSampling:!1},Np);function jp(t={}){const e=p(p({},Up),t),{idleTimeout:n,finalTimeout:r,childSpanTimeout:s,instrumentPageLoad:i,instrumentNavigation:o,endSpanOnRouteComplete:a,traceContinuityMode:c,consistentTraceSampling:u,beforeStartSpan:f,_metricOptions:d,ignoreResourceSpans:m,ignorePerformanceEntryNames:l}=e,h={ignoreResourceSpans:m,ignorePerformanceEntryNames:l};let y,_,E;return{name:Fp,setupOnce(){y=new Rp(d==null?void 0:d._reportAllChanges)},setup(T){var k;(k=w.onAppHide)==null||k.call(w,()=>{const A=kr(T);A&&!N(A).timestamp&&(P&&g.log("[MiniAppTracing] App hiding, finishing active span"),A.setAttribute(se,"appHide"),A.end())})},afterAllSetup(T){eo({instrumentPageLoad:i,instrumentNavigation:o,endSpanOnRouteComplete:a},A=>{ro(T,A,{idleTimeout:n,finalTimeout:r,childSpanTimeout:s,traceContinuityMode:c,consistentTraceSampling:u,beforeStartSpan:f,metricsInstrumentation:y,performanceEntriesOptions:h,latestRoute:{get name(){return _},set name($){_=$},get source(){return E},set source($){E=$}}})})}}}function ro(t,e,n){const{idleTimeout:r,finalTimeout:s,childSpanTimeout:i,traceContinuityMode:o,consistentTraceSampling:a,beforeStartSpan:c,metricsInstrumentation:u,performanceEntriesOptions:f,latestRoute:d}=n;Bp(t);const m=Gp(o,a),l=c?c(e):e;m&&m.length>0&&(l.links=[...l.links||[],...m]);const h=l.attributes||{};d.name=l.name,d.source=h[nt];const y=La(l,{idleTimeout:r,finalTimeout:s,childSpanTimeout:i,beforeSpanEnd:_=>{var A;u==null||u.addPerformanceEntries(_,f),Ps(t,void 0);const E=O(),T=E.getPropagationContext();E.setPropagationContext(b(p({},T),{traceId:_.spanContext().traceId,sampled:bt(_),dsc:lt(_)}));const k=N(_);Pp(_.spanContext().traceId,_.spanContext().spanId,bt(_),k.start_timestamp,1,(A=T.sampleRand)!=null?A:Math.random()),P&&g.log(`[MiniAppTracing] Span ended: ${k.op} - ${k.description}, traceId=${_.spanContext().traceId}`)}});return y.setAttribute("miniapp.trace_continuity_mode",o),Ps(t,y),P&&g.log(`[MiniAppTracing] Started ${e.op} span: ${e.name}, traceId=${y.spanContext().traceId}`),y}function Bp(t){const e=kr(t);e&&!N(e).timestamp&&(P&&g.log(`[MiniAppTracing] Finishing current active span with op: ${N(e).op}`),e.setAttribute(se,"navigationStart"),e.end())}function Gp(t,e){var s;if(t==="off"){O().setPropagationContext({traceId:ut(),sampleRand:Math.random()});return}const n=Cp(),r=xp();if(t==="session"){const i=Mp();O().setPropagationContext(p({traceId:i.traceId,sampleRand:i.sampleRand},e&&r&&n&&{sampled:n.spanContext.traceFlags===1})),P&&g.log(`[MiniAppTracing] Session mode: reusing traceId=${i.traceId}`);return}if(t==="link"){const i=wp(!1);if(O().setPropagationContext(p({traceId:i.traceId,sampleRand:i.sampleRand},e&&r&&n&&{sampled:n.spanContext.traceFlags===1})),r&&n)return P&&g.log(`[MiniAppTracing] Link mode: new traceId=${i.traceId}, linked from ${n.spanContext.traceId}`),[{context:{traceId:n.spanContext.traceId,spanId:n.spanContext.spanId,traceFlags:(s=n.spanContext.traceFlags)!=null?s:0},attributes:{"sentry.link.type":"previous_trace"}}]}}function Hp(){const t=M();return t?kr(t):void 0}exports.Integrations=hp;exports.MiniappClient=Xi;exports.SDK_NAME=Vi;exports.SDK_VERSION=Bn;exports.Transports=pp;exports.addBreadcrumb=Oi;exports.addEventProcessor=fe;exports.captureConsoleIntegration=Su;exports.captureEvent=sc;exports.captureException=D;exports.captureMessage=xn;exports.close=Tp;exports.consoleLoggingIntegration=bl;exports.createConsolaReporter=kl;exports.defaultIntegrations=Zi;exports.extraErrorDataIntegration=Iu;exports.featureFlagsIntegration=cl;exports.flush=bp;exports.getActiveMiniAppRootSpan=kp;exports.getActiveMiniAppSpan=Hp;exports.getActiveSpan=It;exports.getCurrentScope=O;exports.getRootSpan=H;exports.getSpanDescendants=Xt;exports.getSpanStatusFromHttpCode=Ys;exports.init=yp;exports.instrumentAnthropicAiClient=xf;exports.instrumentGoogleGenAIClient=Jf;exports.instrumentMiniAppRouter=eo;exports.instrumentOpenAiClient=gf;exports.instrumentSupabaseClient=$i;exports.lastEventId=Ep;exports.logger=_l;exports.makeMultiplexedTransport=Yc;exports.metrics=Rl;exports.miniappTracingIntegration=jp;exports.moduleMetadataIntegration=_u;exports.registerSpanErrorInstrumentation=oa;exports.rewriteFramesIntegration=wu;exports.setContext=ic;exports.setExtra=Dn;exports.setExtras=oc;exports.setHttpStatus=vn;exports.setMeasurement=li;exports.setTag=$n;exports.setTags=ac;exports.setUser=cc;exports.showReportDialog=Sp;exports.startInactiveSpan=nr;exports.startMiniAppTracingNavigationSpan=ro;exports.startNewTrace=wa;exports.startSpan=Gt;exports.startSpanManual=oe;exports.supabaseIntegration=zu;exports.thirdPartyErrorFilterIntegration=tl;exports.withActiveSpan=le;exports.withScope=rt;exports.wrap=Ip;exports.zodErrorsIntegration=Qu;
