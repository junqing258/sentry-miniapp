"use strict";var eo=Object.defineProperty,no=Object.defineProperties;var ro=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Rr=Object.prototype.hasOwnProperty,kr=Object.prototype.propertyIsEnumerable;var dn=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t);var Nr=(t,e,n)=>e in t?eo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,d=(t,e)=>{for(var n in e||(e={}))Rr.call(e,n)&&Nr(t,n,e[n]);if(he)for(var n of he(e))kr.call(e,n)&&Nr(t,n,e[n]);return t},E=(t,e)=>no(t,ro(e));var pn=(t,e)=>{var n={};for(var r in t)Rr.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&he)for(var r of he(t))e.indexOf(r)<0&&kr.call(t,r)&&(n[r]=t[r]);return n};var F=(t,e,n)=>new Promise((r,s)=>{var i=c=>{try{a(n.next(c))}catch(u){s(u)}},o=c=>{try{a(n.throw(c))}catch(u){s(u)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,o);a((n=n.apply(t,e)).next())}),it=function(t,e){this[0]=t,this[1]=e},ye=(t,e,n)=>{var r=(o,a,c,u)=>{try{var f=n[o](a),p=(a=f.value)instanceof it,m=f.done;Promise.resolve(p?a[0]:a).then(l=>p?r(o==="return"?o:"next",a[1]?{done:l.done,value:l.value}:l,c,u):c({value:l,done:m})).catch(l=>r("throw",l,c,u))}catch(l){u(l)}},s=o=>i[o]=a=>new Promise((c,u)=>r(o,a,c,u)),i={};return n=n.apply(t,e),i[dn("asyncIterator")]=()=>i,s("next"),s("throw"),s("return"),i};var Se=(t,e,n)=>(e=t[dn("asyncIterator")])?e.call(t):(t=t[dn("iterator")](),e={},n=(r,s)=>(s=t[r])&&(e[r]=i=>new Promise((o,a,c)=>(i=s.call(t,i),c=i.done,Promise.resolve(i.value).then(u=>o({value:u,done:c}),a)))),n("next"),n("return"),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();function so(){const t=Function("return this")();return t&&typeof t.wx!="undefined"&&t.wx?t.wx:t&&typeof t.my!="undefined"&&t.my?t.my:t&&typeof t.swan!="undefined"&&t.swan?t.swan:t&&typeof t.tt!="undefined"&&t.tt?t.tt:t&&typeof t.qq!="undefined"&&t.qq?t.qq:typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:t}const Or=so();class io{constructor(e){if(this._entries=[],!!e){if(typeof e=="string"){const n=e.startsWith("?")?e.slice(1):e;n.length>0&&n.split("&").forEach(r=>{if(!r)return;const[s,i=""]=r.split("=");this.append(decodeURIComponent(s),decodeURIComponent(i))});return}if(Array.isArray(e)){e.forEach(([n,r])=>this.append(n,r));return}Object.keys(e).forEach(n=>{const r=e[n];r!=null&&this.append(n,String(r))})}}append(e,n){this._entries.push([e,n])}toString(){return this._entries.map(([e,n])=>`${encodeURIComponent(e)}=${encodeURIComponent(n)}`).join("&")}}Or.URLSearchParams||(Or.URLSearchParams=io);const S=typeof __SENTRY_DEBUG__=="undefined"||__SENTRY_DEBUG__,T=globalThis,mt="10.27.0";function Dt(){return Ve(T),T}function Ve(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||mt,e[mt]=e[mt]||{}}function $t(t,e,n=T){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[mt]=r[mt]||{};return s[t]||(s[t]=e())}const Bn=["debug","info","warn","error","log","assert","trace"],oo="Sentry Logger ",ve={};function Lt(t){if(!("console"in T))return t();const e=T.console,n={},r=Object.keys(ve);r.forEach(s=>{const i=ve[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function ao(){Hn().enabled=!0}function co(){Hn().enabled=!1}function Ms(){return Hn().enabled}function uo(...t){Gn("log",...t)}function lo(...t){Gn("warn",...t)}function fo(...t){Gn("error",...t)}function Gn(t,...e){S&&Ms()&&Lt(()=>{T.console[t](`${oo}[${t}]:`,...e)})}function Hn(){return S?$t("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const h={enable:ao,disable:co,isEnabled:Ms,log:uo,warn:lo,error:fo},mn="<anonymous>";function Cs(t){try{return!t||typeof t!="function"?mn:t.name||mn}catch(e){return mn}}function po(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch(r){return}}}function ws(t){return"__v_isVNode"in t&&t.__v_isVNode?"[VueVNode]":"[VueViewModel]"}const Ae={},vr={};function qn(t,e){Ae[t]=Ae[t]||[],Ae[t].push(e)}function zn(t,e){if(!vr[t]){vr[t]=!0;try{e()}catch(n){S&&h.error(`Error while instrumenting ${t}`,n)}}}function Wn(t,e){const n=t&&Ae[t];if(n)for(const r of n)try{r(e)}catch(s){S&&h.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Cs(r)}
Error:`,s)}}let _n=null;function mo(t){const e="error";qn(e,t),zn(e,_o)}function _o(){_n=T.onerror,T.onerror=function(t,e,n,r,s){return Wn("error",{column:r,error:s,line:n,msg:t,url:e}),_n?_n.apply(this,arguments):!1},T.onerror.__SENTRY_INSTRUMENTED__=!0}let gn=null;function go(t){const e="unhandledrejection";qn(e,t),zn(e,ho)}function ho(){gn=T.onunhandledrejection,T.onunhandledrejection=function(t){return Wn("unhandledrejection",t),gn?gn.apply(this,arguments):!0},T.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Ps=Object.prototype.toString;function _t(t){switch(Ps.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Xe(t,Error)}}function Ft(t,e){return Ps.call(t)===`[object ${e}]`}function xs(t){return Ft(t,"ErrorEvent")}function Mr(t){return Ft(t,"DOMError")}function yo(t){return Ft(t,"DOMException")}function Me(t){return Ft(t,"String")}function Ye(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Jn(t){return t===null||Ye(t)||typeof t!="object"&&typeof t!="function"}function Et(t){return Ft(t,"Object")}function Ke(t){return typeof Event!="undefined"&&Xe(t,Event)}function So(t){return typeof Element!="undefined"&&Xe(t,Element)}function Eo(t){return Ft(t,"RegExp")}function Ut(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function bo(t){return Et(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Xe(t,e){try{return t instanceof e}catch(n){return!1}}function Ds(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue||t.__v_isVNode))}const To=T,Io=80;function Ao(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const f=Array.isArray(e)?e:e.keyAttrs,p=!Array.isArray(e)&&e.maxStringLength||Io;for(;n&&i++<r&&(u=No(n,f),!(u==="html"||i>1&&o+s.length*c+u.length>=p));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch(n){return"<unknown>"}}function No(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(To.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Me(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function pt(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&$s(s,r);try{t[e]=s}catch(i){S&&h.log(`Failed to replace method "${e}" in object`,t)}}function W(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch(r){S&&h.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function $s(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,W(t,"__sentry_original__",e)}catch(n){}}function Ls(t){return t.__sentry_original__}function Fs(t){if(_t(t))return d({message:t.message,name:t.name,stack:t.stack},wr(t));if(Ke(t)){const e=d({type:t.type,target:Cr(t.target),currentTarget:Cr(t.currentTarget)},wr(t));return typeof CustomEvent!="undefined"&&Xe(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function Cr(t){try{return So(t)?Ao(t):Object.prototype.toString.call(t)}catch(e){return"<unknown>"}}function wr(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function Ro(t){const e=Object.keys(Fs(t));return e.sort(),e[0]?e.join(", "):"[object has no keys]"}function ne(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function Pr(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{Ds(s)?n.push(ws(s)):n.push(String(s))}catch(i){n.push("[value cannot be serialized]")}}return n.join(e)}function Ne(t,e,n=!1){return Me(t)?Eo(e)?e.test(t):Me(e)?n?t===e:t.includes(e):!1:!1}function Ze(t,e=[],n=!1){return e.some(r=>Ne(t,r,n))}function ko(){const t=T;return t.crypto||t.msCrypto}let hn;function Oo(){return Math.random()*16}function V(t=ko()){try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"")}catch(e){}return hn||(hn="10000000100040008000"+1e11),hn.replace(/[018]/g,e=>(e^(Oo()&15)>>e/4).toString(16))}function Us(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}function Ot(t){const{message:e,event_id:n}=t;if(e)return e;const r=Us(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function In(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function ct(t,e){const n=Us(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism=d(d(d({},r),s),e),e&&"data"in e){const i=d(d({},s==null?void 0:s.data),e.data);n.mechanism.data=i}}function xr(t){if(vo(t))return!0;try{W(t,"__sentry_captured__",!0)}catch(e){}return!1}function vo(t){try{return t.__sentry_captured__}catch(e){}}const js=1e3;function oe(){return Date.now()/js}function Mo(){const{performance:t}=T;if(!(t!=null&&t.now)||!t.timeOrigin)return oe;const e=t.timeOrigin;return()=>(e+t.now())/js}let Ee;function et(){return(Ee!=null?Ee:Ee=Mo())()}function An(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||et(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:V()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function ae(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r=d({},t);for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=ae(r[s],e[s],n-1));return r}function ut(){return V()}function jt(){return V().substring(16)}const Nn="_sentrySpan";function bt(t,e){e?W(t,Nn,e):delete t[Nn]}function Ct(t){return t[Nn]}const Co=100;class K{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:ut(),sampleRand:Math.random()}}clone(){const e=new K;return e._breadcrumbs=[...this._breadcrumbs],e._tags=d({},this._tags),e._attributes=d({},this._attributes),e._extra=d({},this._extra),e._contexts=d({},this._contexts),this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata=d({},this._sdkProcessingMetadata),e._propagationContext=d({},this._propagationContext),e._client=this._client,e._lastEventId=this._lastEventId,bt(e,Ct(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&An(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags=d(d({},this._tags),e),this._notifyScopeListeners(),this}setTag(e,n){return this.setTags({[e]:n})}setAttributes(e){return this._attributes=d(d({},this._attributes),e),this._notifyScopeListeners(),this}setAttribute(e,n){return this.setAttributes({[e]:n})}removeAttribute(e){return e in this._attributes&&(delete this._attributes[e],this._notifyScopeListeners()),this}setExtras(e){return this._extra=d(d({},this._extra),e),this._notifyScopeListeners(),this}setExtra(e,n){return this._extra=E(d({},this._extra),{[e]:n}),this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof K?n.getScopeData():Et(n)?e:void 0,{tags:s,attributes:i,extra:o,user:a,contexts:c,level:u,fingerprint:f=[],propagationContext:p}=r||{};return this._tags=d(d({},this._tags),s),this._attributes=d(d({},this._attributes),i),this._extra=d(d({},this._extra),o),this._contexts=d(d({},this._contexts),c),a&&Object.keys(a).length&&(this._user=a),u&&(this._level=u),f.length&&(this._fingerprint=f),p&&(this._propagationContext=p),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,bt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:ut(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:Co;if(r<=0)return this;const s=E(d({timestamp:oe()},e),{message:e.message?ne(e.message,2048):e.message});return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ct(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=ae(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||V();if(!this._client)return S&&h.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,E(d({originalException:e,syntheticException:s},n),{event_id:r}),this),r}captureMessage(e,n,r){var o;const s=(r==null?void 0:r.event_id)||V();if(!this._client)return S&&h.warn("No client configured on scope - will not capture message!"),s;const i=(o=r==null?void 0:r.syntheticException)!=null?o:new Error(e);return this._client.captureMessage(e,n,E(d({originalException:e,syntheticException:i},r),{event_id:s}),this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||V();return this._client?(this._client.captureEvent(e,E(d({},n),{event_id:r}),this),r):(S&&h.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function wo(){return $t("defaultCurrentScope",()=>new K)}function Po(){return $t("defaultIsolationScope",()=>new K)}class xo{constructor(e,n){let r;e?r=e:r=new K;let s;n?s=n:s=new K,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Ut(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function wt(){const t=Dt(),e=Ve(t);return e.stack=e.stack||new xo(wo(),Po())}function Do(t){return wt().withScope(t)}function $o(t,e){const n=wt();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function Dr(t){return wt().withScope(()=>t(wt().getIsolationScope()))}function Lo(){return{withIsolationScope:Dr,withScope:Do,withSetScope:$o,withSetIsolationScope:(t,e)=>Dr(e),getCurrentScope:()=>wt().getScope(),getIsolationScope:()=>wt().getIsolationScope()}}function ce(t){const e=Ve(t);return e.acs?e.acs:Lo()}function O(){const t=Dt();return ce(t).getCurrentScope()}function B(){const t=Dt();return ce(t).getIsolationScope()}function Vn(){return $t("globalScope",()=>new K)}function rt(...t){const e=Dt(),n=ce(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function v(){return O().getClient()}function Bs(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,i={trace_id:n,span_id:s||jt()};return r&&(i.parent_span_id=r),i}const nt="sentry.source",Gs="sentry.sample_rate",Fo="sentry.previous_trace_sample_rate",re="sentry.op",D="sentry.origin",Ce="sentry.idle_span_finish_reason",Hs="sentry.measurement_unit",qs="sentry.measurement_value",$r="sentry.custom_span_name",Yn="sentry.profile_id",Kn="sentry.exclusive_time",Uo=0,Qe=1,k=2;function zs(t){if(t<400&&t>=100)return{code:Qe};if(t>=400&&t<500)switch(t){case 401:return{code:k,message:"unauthenticated"};case 403:return{code:k,message:"permission_denied"};case 404:return{code:k,message:"not_found"};case 409:return{code:k,message:"already_exists"};case 413:return{code:k,message:"failed_precondition"};case 429:return{code:k,message:"resource_exhausted"};case 499:return{code:k,message:"cancelled"};default:return{code:k,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:k,message:"unimplemented"};case 503:return{code:k,message:"unavailable"};case 504:return{code:k,message:"deadline_exceeded"};default:return{code:k,message:"internal_error"}}return{code:k,message:"internal_error"}}function Rn(t,e){t.setAttribute("http.response.status_code",e);const n=zs(e);n.message!=="unknown_error"&&t.setStatus(n)}const Ws="_sentryScope",Js="_sentryIsolationScope";function jo(t){try{const e=T.WeakRef;if(typeof e=="function")return new e(t)}catch(e){}return t}function Bo(t){if(t){if(typeof t=="object"&&"deref"in t&&typeof t.deref=="function")try{return t.deref()}catch(e){return}return t}}function Go(t,e,n){t&&(W(t,Js,jo(n)),W(t,Ws,e))}function we(t){const e=t;return{scope:e[Ws],isolationScope:Bo(e[Js])}}const Ho="sentry-",qo=/^sentry-/;function zo(t){const e=Wo(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(qo)){const o=s.slice(Ho.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function Wo(t){if(!(!t||!Me(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=Lr(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):Lr(t)}function Lr(t){return t.split(",").map(e=>{const n=e.indexOf("=");if(n===-1)return[];const r=e.slice(0,n),s=e.slice(n+1);return[r,s].map(i=>{try{return decodeURIComponent(i.trim())}catch(o){return}})}).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}const Jo=/^o(\d+)\./,Vo=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Yo(t){return t==="http"||t==="https"}function Bt(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function Vs(t){const e=Vo.exec(t);if(!e){Lt(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",o="",a=""]=e.slice(1);let c="",u=a;const f=u.split("/");if(f.length>1&&(c=f.slice(0,-1).join("/"),u=f.pop()),u){const p=u.match(/^\d+/);p&&(u=p[0])}return Ys({host:i,pass:s,path:c,projectId:u,port:o,protocol:n,publicKey:r})}function Ys(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Ko(t){if(!S)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(h.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Yo(r)?e&&isNaN(parseInt(e,10))?(h.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(h.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(h.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Xo(t){const e=t.match(Jo);return e==null?void 0:e[1]}function Zo(t){const e=t.getOptions(),{host:n}=t.getDsn()||{};let r;return e.orgId?r=String(e.orgId):n&&(r=Xo(n)),r}function Qo(t){const e=typeof t=="string"?Vs(t):Ys(t);if(!(!e||!Ko(e)))return e}function Xn(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Ks=0,Zn=1;let Fr=!1;function ta(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=R(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function Xs(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:R(t).parent_span_id,i=we(t).scope,o=r?(i==null?void 0:i.getPropagationContext().propagationSpanId)||jt():e;return{parent_span_id:s,span_id:o,trace_id:n}}function Zs(t){if(t&&t.length>0)return t.map(o=>{var a=o,{context:c}=a,u=c,{spanId:e,traceId:n,traceFlags:r}=u,s=pn(u,["spanId","traceId","traceFlags"]),{attributes:i}=a;return d({span_id:e,trace_id:n,sampled:r===Zn,attributes:i},s)})}function gt(t){return typeof t=="number"?Ur(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Ur(t.getTime()):et()}function Ur(t){return t>9999999999?t/1e3:t}function R(t){var r;if(na(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(ea(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,f="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:f,start_timestamp:gt(i),timestamp:gt(a)||void 0,status:Qs(c),op:s[re],origin:s[D],links:Zs(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function ea(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function na(t){return typeof t.getSpanJSON=="function"}function Tt(t){const{traceFlags:e}=t.spanContext();return e===Zn}function Qs(t){if(!(!t||t.code===Uo))return t.code===Qe?"ok":t.message||"internal_error"}const ht="_sentryChildSpans",kn="_sentryRootSpan";function ti(t,e){const n=t[kn]||t;W(e,kn,n),t[ht]?t[ht].add(e):W(t,ht,new Set([e]))}function ra(t,e){t[ht]&&t[ht].delete(e)}function Xt(t){const e=new Set;function n(r){if(!e.has(r)&&Tt(r)){e.add(r);const s=r[ht]?Array.from(r[ht]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function q(t){return t[kn]||t}function At(){const t=Dt(),e=ce(t);return e.getActiveSpan?e.getActiveSpan():Ct(O())}function On(){Fr||(Lt(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly or use `ignoreSpans`.")}),Fr=!0)}let jr=!1;function sa(){if(jr)return;function t(){const e=At(),n=e&&q(e);if(n){const r="internal_error";S&&h.log(`[Tracing] Root span: ${r} -> Global error occurred`),n.setStatus({code:k,message:r})}}t.tag="sentry_tracingErrorCallback",jr=!0,mo(t),go(t)}function tn(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=v())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}function Br(t){h.log(`Ignoring span ${t.op} - ${t.description} because it matches \`ignoreSpans\`.`)}function Pe(t,e){if(!(e!=null&&e.length)||!t.description)return!1;for(const n of e){if(oa(n)){if(Ne(t.description,n))return S&&Br(t),!0;continue}if(!n.name&&!n.op)continue;const r=n.name?Ne(t.description,n.name):!0,s=n.op?t.op&&Ne(t.op,n.op):!0;if(r&&s)return S&&Br(t),!0}return!1}function ia(t,e){const n=e.parent_span_id,r=e.span_id;if(n)for(const s of t)s.parent_span_id===r&&(s.parent_span_id=n)}function oa(t){return typeof t=="string"||t instanceof RegExp}const Qn="production",ei="_frozenDsc";function Re(t,e){W(t,ei,e)}function ni(t,e){const n=e.getOptions(),{publicKey:r}=e.getDsn()||{},s={environment:n.environment||Qn,release:n.release,public_key:r,trace_id:t,org_id:Zo(e)};return e.emit("createDsc",s),s}function ri(t,e){const n=e.getPropagationContext();return n.dsc||ni(n.traceId,t)}function lt(t){var _,y,g,A;const e=v();if(!e)return{};const n=q(t),r=R(n),s=r.data,i=n.spanContext().traceState,o=(y=(_=i==null?void 0:i.get("sentry.sample_rate"))!=null?_:s[Gs])!=null?y:s[Fo];function a(I){return(typeof o=="number"||typeof o=="string")&&(I.sample_rate=`${o}`),I}const c=n[ei];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),f=u&&zo(u);if(f)return a(f);const p=ni(t.spanContext().traceId,e),m=s[nt],l=r.description;return m!=="url"&&l&&(p.transaction=l),tn()&&(p.sampled=String(Tt(n)),p.sample_rand=(A=i==null?void 0:i.get("sentry.sample_rand"))!=null?A:(g=we(n).scope)==null?void 0:g.getPropagationContext().sampleRand.toString()),a(p),e.emit("createDsc",p,n),p}class It{constructor(e={}){this._traceId=e.traceId||ut(),this._spanId=e.spanId||jt()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Ks}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}function H(t,e=100,n=1/0){try{return vn("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function si(t,e=3,n=100*1024){const r=H(t,e);return la(r)>n?si(t,e-1,n):r}function vn(t,e,n=1/0,r=1/0,s=fa()){const[i,o]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=aa(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const u=e;if(u&&typeof u.toJSON=="function")try{const l=u.toJSON();return vn("",l,c-1,r,s)}catch(l){}const f=Array.isArray(e)?[]:{};let p=0;const m=Fs(e);for(const l in m){if(!Object.prototype.hasOwnProperty.call(m,l))continue;if(p>=r){f[l]="[MaxProperties ~]";break}const _=m[l];f[l]=vn(l,_,c-1,r,s),p++}return o(e),f}function aa(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global!="undefined"&&e===global)return"[Global]";if(typeof window!="undefined"&&e===window)return"[Window]";if(typeof document!="undefined"&&e===document)return"[Document]";if(Ds(e))return ws(e);if(bo(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Cs(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=ca(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function ca(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function ua(t){return~-encodeURI(t).split(/%..|./).length}function la(t){return ua(JSON.stringify(t))}function fa(){const t=new WeakSet;function e(r){return t.has(r)?!0:(t.add(r),!1)}function n(r){t.delete(r)}return[e,n]}function ft(t,e=[]){return[t,e]}function da(t,e){const[n,r]=t;return[n,[...r,e]]}function se(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function Mn(t){const e=Ve(T);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function pa(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[Mn(r),i]:r.push(typeof i=="string"?Mn(i):i)}for(const i of n){const[o,a]=i;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let c;try{c=JSON.stringify(a)}catch(u){c=JSON.stringify(H(a))}s(c)}}return typeof r=="string"?r:ma(r)}function ma(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function _a(t){return[{type:"span"},t]}function ga(t){const e=typeof t.data=="string"?Mn(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const ha={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item",metric:"metric",trace_metric:"metric"};function Gr(t){return ha[t]}function ii(t){if(!(t!=null&&t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function ya(t,e,n,r){var i;const s=(i=t.sdkProcessingMetadata)==null?void 0:i.dynamicSamplingContext;return d(d(d({event_id:t.event_id,sent_at:new Date().toISOString()},e&&{sdk:e}),!!n&&r&&{dsn:Bt(r)}),s&&{trace:s})}function Sa(t,e){var r,s,i,o;if(!e)return t;const n=t.sdk||{};return t.sdk=E(d({},n),{name:n.name||e.name,version:n.version||e.version,integrations:[...((r=t.sdk)==null?void 0:r.integrations)||[],...e.integrations||[]],packages:[...((s=t.sdk)==null?void 0:s.packages)||[],...e.packages||[]],settings:(i=t.sdk)!=null&&i.settings||e.settings?d(d({},(o=t.sdk)==null?void 0:o.settings),e.settings):void 0}),t}function Ea(t,e,n,r){const s=ii(n),i=d(d({sent_at:new Date().toISOString()},s&&{sdk:s}),!!r&&e&&{dsn:Bt(e)}),o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return ft(i,[o])}function ba(t,e,n,r){const s=ii(n),i=t.type&&t.type!=="replay_event"?t.type:"event";Sa(t,n==null?void 0:n.sdk);const o=ya(t,s,r,e);return delete t.sdkProcessingMetadata,ft(o,[[{type:i},t]])}function Ta(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=lt(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o=d(d({sent_at:new Date().toISOString()},n(r)&&{trace:r}),!!i&&s&&{dsn:Bt(s)}),{beforeSendSpan:a,ignoreSpans:c}=(e==null?void 0:e.getOptions())||{},u=c!=null&&c.length?t.filter(l=>!Pe(R(l),c)):t,f=t.length-u.length;f&&(e==null||e.recordDroppedEvent("before_send","span",f));const p=a?l=>{const _=R(l),y=a(_);return y||(On(),_)}:R,m=[];for(const l of u){const _=p(l);_&&m.push(_a(_))}return ft(o,m)}function Ia(t){if(!S)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=R(t),{spanId:s}=t.spanContext(),i=Tt(t),o=q(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:f,description:p}=R(o);u.push(`root ID: ${o.spanContext().spanId}`),f&&u.push(`root op: ${f}`),p&&u.push(`root description: ${p}`)}h.log(`${c}
  ${u.join(`
  `)}`)}function Aa(t){if(!S)return;const{description:e="< unknown name >",op:n="< unknown op >"}=R(t),{spanId:r}=t.spanContext(),i=q(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;h.log(o)}function oi(t,e,n,r=At()){const s=r&&q(r);s&&(S&&h.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[qs]:e,[Hs]:n}))}function Hr(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[Hs],i=r[qs];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const qr=1e3;class en{constructor(e={}){this._traceId=e.traceId||ut(),this._spanId=e.spanId||jt(),this._startTime=e.startTimestamp||et(),this._links=e.links,this._attributes={},this.setAttributes(d({[D]:"manual",[re]:e.op},e.attributes)),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?Zn:Ks}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=gt(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(nt,"custom"),this}end(e){this._endTime||(this._endTime=gt(e),Aa(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[re],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Qs(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[D],profile_id:this._attributes[Yn],exclusive_time:this._attributes[Kn],measurements:Hr(this._events),is_segment:this._isStandaloneSpan&&q(this)===this||void 0,segment_id:this._isStandaloneSpan?q(this).spanContext().spanId:void 0,links:Zs(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){S&&h.log("[Tracing] Adding an event to span:",e);const s=zr(n)?n:r||et(),i=zr(n)?{}:n||{},o={name:e,time:gt(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=v();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===q(this)))return;if(this._isStandaloneSpan){this._sampled?Ra(Ta([this],e)):(S&&h.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(we(this).scope||O()).captureEvent(r)}_convertSpanToTransaction(){var f;if(!Wr(R(this)))return;this._name||(S&&h.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=we(this),r=(f=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:f.normalizedRequest;if(this._sampled!==!0)return;const i=Xt(this).filter(p=>p!==this&&!Na(p)).map(p=>R(p)).filter(Wr),o=this._attributes[nt];delete this._attributes[$r],i.forEach(p=>{delete p.data[$r]});const a=d({contexts:{trace:ta(this)},spans:i.length>qr?i.sort((p,m)=>p.start_timestamp-m.start_timestamp).slice(0,qr):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:lt(this)},request:r},o&&{transaction_info:{source:o}}),c=Hr(this._events);return c&&Object.keys(c).length&&(S&&h.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}}function zr(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function Wr(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function Na(t){return t instanceof en&&t.isStandaloneSpan()}function Ra(t){const e=v();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}function nn(t,e,n=()=>{},r=()=>{}){let s;try{s=t()}catch(i){throw e(i),n(),i}return ka(s,e,n,r)}function ka(t,e,n,r){return Ut(t)?t.then(s=>(n(),r(s),s),s=>{throw e(s),n(),s}):(n(),r(t),t)}function Oa(t,e,n){if(!tn(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler(E(d({},e),{inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a})),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate!="undefined"&&(s=t.tracesSampleRate,r=!0);const i=Xn(s);if(i===void 0)return S&&h.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return S&&h.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||S&&h.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}const ai="__SENTRY_SUPPRESS_TRACING__";function Gt(t,e){const n=rn();if(n.startSpan)return n.startSpan(t,e);const r=nr(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return rt(a,()=>ci(i)(()=>{const u=O(),f=rr(u,i),m=t.onlyIfParent&&!f?new It:er({parentSpan:f,spanArguments:r,forceTransaction:s,scope:u});return bt(u,m),nn(()=>e(m),()=>{const{status:l}=R(m);m.isRecording()&&(!l||l==="ok")&&m.setStatus({code:k,message:"internal_error"})},()=>{m.end()})}))}function ie(t,e){const n=rn();if(n.startSpanManual)return n.startSpanManual(t,e);const r=nr(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return rt(a,()=>ci(i)(()=>{const u=O(),f=rr(u,i),m=t.onlyIfParent&&!f?new It:er({parentSpan:f,spanArguments:r,forceTransaction:s,scope:u});return bt(u,m),nn(()=>e(m,()=>m.end()),()=>{const{status:l}=R(m);m.isRecording()&&(!l||l==="ok")&&m.setStatus({code:k,message:"internal_error"})})}))}function tr(t){const e=rn();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=nr(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>rt(t.scope,o):s!==void 0?o=>ue(s,o):o=>o())(()=>{const o=O(),a=rr(o,s);return t.onlyIfParent&&!a?new It:er({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function ue(t,e){const n=rn();return n.withActiveSpan?n.withActiveSpan(t,e):rt(r=>(bt(r,t||void 0),e(r)))}function va(t){return rt(e=>(e.setPropagationContext({traceId:ut(),sampleRand:Math.random()}),S&&h.log(`Starting a new trace with id ${e.getPropagationContext().traceId}`),ue(null,t)))}function er({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!tn()){const o=new It;if(n||!t){const a=d({sampled:"false",sample_rate:"0",transaction:e.name},lt(o));Re(o,a)}return o}const s=B();let i;if(t&&!n)i=Ma(t,r,e),ti(t,i);else if(t){const o=lt(t),{traceId:a,spanId:c}=t.spanContext(),u=Tt(t);i=Jr(d({traceId:a,parentSpanId:c},e),r,u),Re(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}=d(d({},s.getPropagationContext()),r.getPropagationContext());i=Jr(d({traceId:o,parentSpanId:c},e),r,u),a&&Re(i,a)}return Ia(i),Go(i,r,s),i}function nr(t){const e=t.experimental||{},n=d({isStandalone:e.standalone},t);if(t.startTime){const r=d({},n);return r.startTimestamp=gt(t.startTime),delete r.startTime,r}return n}function rn(){const t=Dt();return ce(t)}function Jr(t,e,n){var _,y;const r=v(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:d({},t.attributes),spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=(_=o.parentSampled)!=null?_:n,c=o.spanAttributes,u=e.getPropagationContext(),[f,p,m]=e.getScopeData().sdkProcessingMetadata[ai]?[!1]:Oa(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:Xn((y=u.dsc)==null?void 0:y.sample_rate)},u.sampleRand),l=new en(E(d({},t),{attributes:d({[nt]:"custom",[Gs]:p!==void 0&&m?p:void 0},c),sampled:f}));return!f&&r&&(S&&h.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",l),l}function Ma(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[ai]?!1:Tt(t),o=i?new en(E(d({},n),{parentSpanId:r,traceId:s,sampled:i})):new It({traceId:s});ti(t,o);const a=v();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function rr(t,e){if(e)return e;if(e===null)return;const n=Ct(t);if(!n)return;const r=v();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?q(n):n}function ci(t){return t!==void 0?e=>ue(t,e):e=>e()}const yn={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},Ca="heartbeatFailed",wa="idleTimeout",Pa="finalTimeout",xa="externalFinish";function Da(t,e={}){const n=new Map;let r=!1,s,i=xa,o=!e.disableAutoFinish;const a=[],{idleTimeout:c=yn.idleTimeout,finalTimeout:u=yn.finalTimeout,childSpanTimeout:f=yn.childSpanTimeout,beforeSpanEnd:p,trimIdleSpanEndTimestamp:m=!0}=e,l=v();if(!l||!tn()){const b=new It,P=d({sample_rate:"0",sampled:"false"},lt(b));return Re(b,P),b}const _=O(),y=At(),g=$a(t);g.end=new Proxy(g.end,{apply(b,P,Jt){if(p&&p(g),P instanceof It)return;const[Vt,...st]=Jt,Nt=Vt||et(),G=gt(Nt),M=Xt(g).filter(X=>X!==g),Yt=R(g);if(!M.length||!m)return L(G),Reflect.apply(b,P,[G,...st]);const Rt=l.getOptions().ignoreSpans,pe=M==null?void 0:M.reduce((X,_e)=>{const ge=R(_e);return!ge.timestamp||Rt&&Pe(ge,Rt)?X:X?Math.max(X,ge.timestamp):ge.timestamp},void 0),kt=Yt.start_timestamp,me=Math.min(kt?kt+u/1e3:1/0,Math.max(kt||-1/0,Math.min(G,pe||1/0)));return L(me),Reflect.apply(b,P,[me,...st])}});function A(){s&&(clearTimeout(s),s=void 0)}function I(b){A(),s=setTimeout(()=>{!r&&n.size===0&&o&&(i=wa,g.end(b))},c)}function N(b){s=setTimeout(()=>{!r&&o&&(i=Ca,g.end(b))},f)}function w(b){A(),n.set(b,!0);const P=et();N(P+f/1e3)}function $(b){if(n.has(b)&&n.delete(b),n.size===0){const P=et();I(P+c/1e3)}}function L(b){r=!0,n.clear(),a.forEach(M=>M()),bt(_,y);const P=R(g),{start_timestamp:Jt}=P;if(!Jt)return;P.data[Ce]||g.setAttribute(Ce,i);const st=P.status;(!st||st==="unknown")&&g.setStatus({code:Qe}),h.log(`[Tracing] Idle span "${P.op}" finished`);const Nt=Xt(g).filter(M=>M!==g);let G=0;Nt.forEach(M=>{M.isRecording()&&(M.setStatus({code:k,message:"cancelled"}),M.end(b),S&&h.log("[Tracing] Cancelling span since span ended early",JSON.stringify(M,void 0,2)));const Yt=R(M),{timestamp:Rt=0,start_timestamp:pe=0}=Yt,kt=pe<=b,me=(u+c)/1e3,X=Rt-pe<=me;if(S){const _e=JSON.stringify(M,void 0,2);kt?X||h.log("[Tracing] Discarding span since it finished after idle span final timeout",_e):h.log("[Tracing] Discarding span since it happened after idle span was finished",_e)}(!X||!kt)&&(ra(g,M),G++)}),G>0&&g.setAttribute("sentry.idle_span_discarded_spans",G)}return a.push(l.on("spanStart",b=>{if(r||b===g||R(b).timestamp||b instanceof en&&b.isStandaloneSpan())return;Xt(g).includes(b)&&w(b.spanContext().spanId)})),a.push(l.on("spanEnd",b=>{r||$(b.spanContext().spanId)})),a.push(l.on("idleSpanEnableAutoFinish",b=>{b===g&&(o=!0,I(),n.size&&N())})),e.disableAutoFinish||I(),setTimeout(()=>{r||(g.setStatus({code:k,message:"deadline_exceeded"}),i=Pa,g.end())},u),g}function $a(t){const e=tr(t);return bt(O(),e),S&&h.log("[Tracing] Started span is an idle span"),e}const Sn=0,Vr=1,Yr=2;function Ht(t){return new Pt(e=>{e(t)})}function sr(t){return new Pt((e,n)=>{n(t)})}class Pt{constructor(e){this._state=Sn,this._handlers=[],this._runExecutor(e)}then(e,n){return new Pt((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Pt((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}_executeHandlers(){if(this._state===Sn)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Vr&&n[1](this._value),this._state===Yr&&n[2](this._value),n[0]=!0)})}_runExecutor(e){const n=(i,o)=>{if(this._state===Sn){if(Ut(o)){o.then(r,s);return}this._state=i,this._value=o,this._executeHandlers()}},r=i=>{n(Vr,i)},s=i=>{n(Yr,i)};try{e(r,s)}catch(i){s(i)}}}function La(t,e,n,r=0){try{const s=Cn(e,n,t,r);return Ut(s)?s:Ht(s)}catch(s){return sr(s)}}function Cn(t,e,n,r){const s=n[r];if(!t||!s)return t;const i=s(d({},t),e);return S&&i===null&&h.log(`Event processor "${s.id||"?"}" dropped event`),Ut(i)?i.then(o=>Cn(o,e,n,r+1)):Cn(i,e,n,r+1)}function Fa(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;Ua(t,e),r&&Ga(t,r),Ha(t,n),ja(t,s),Ba(t,i)}function xt(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:f,attachments:p,propagationContext:m,transactionName:l,span:_}=e;be(t,"extra",n),be(t,"tags",r),be(t,"user",s),be(t,"contexts",i),t.sdkProcessingMetadata=ae(t.sdkProcessingMetadata,a,2),o&&(t.level=o),l&&(t.transactionName=l),_&&(t.span=_),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),f.length&&(t.eventProcessors=[...t.eventProcessors,...f]),p.length&&(t.attachments=[...t.attachments,...p]),t.propagationContext=d(d({},t.propagationContext),m)}function be(t,e,n){t[e]=ae(t[e],n,1)}function Ua(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e;Object.keys(n).length&&(t.extra=d(d({},n),t.extra)),Object.keys(r).length&&(t.tags=d(d({},r),t.tags)),Object.keys(s).length&&(t.user=d(d({},s),t.user)),Object.keys(i).length&&(t.contexts=d(d({},i),t.contexts)),o&&(t.level=o),a&&t.type!=="transaction"&&(t.transaction=a)}function ja(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function Ba(t,e){t.sdkProcessingMetadata=d(d({},t.sdkProcessingMetadata),e)}function Ga(t,e){t.contexts=d({trace:Xs(e)},t.contexts),t.sdkProcessingMetadata=d({dynamicSamplingContext:lt(e)},t.sdkProcessingMetadata);const n=q(e),r=R(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function Ha(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}let Z,Kr,Xr,ot;function qa(t){const e=T._sentryDebugIds,n=T._debugIds;if(!e&&!n)return{};const r=e?Object.keys(e):[],s=n?Object.keys(n):[];if(ot&&r.length===Kr&&s.length===Xr)return ot;Kr=r.length,Xr=s.length,ot={},Z||(Z={});const i=(o,a)=>{for(const c of o){const u=a[c],f=Z==null?void 0:Z[c];if(f&&ot&&u)ot[f[0]]=u,Z&&(Z[c]=[f[0],u]);else if(u){const p=t(c);for(let m=p.length-1;m>=0;m--){const l=p[m],_=l==null?void 0:l.filename;if(_&&ot&&Z){ot[_]=u,Z[c]=[_,u];break}}}}};return e&&i(r,e),n&&i(s,n),ot}function za(t,e,n,r,s,i){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c=E(d({},e),{event_id:e.event_id||n.event_id||V(),timestamp:e.timestamp||oe()}),u=n.integrations||t.integrations.map(g=>g.name);Wa(c,t),Ya(c,u),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&Ja(c,t.stackParser);const f=Xa(r,n.captureContext);n.mechanism&&ct(c,n.mechanism);const p=s?s.getEventProcessors():[],m=Vn().getScopeData();if(i){const g=i.getScopeData();xt(m,g)}if(f){const g=f.getScopeData();xt(m,g)}const l=[...n.attachments||[],...m.attachments];l.length&&(n.attachments=l),Fa(c,m);const _=[...p,...m.eventProcessors];return La(_,c,n).then(g=>(g&&Va(g),typeof o=="number"&&o>0?Ka(g,o,a):g))}function Wa(t,e){var a,c;const{environment:n,release:r,dist:s,maxValueLength:i}=e;t.environment=t.environment||n||Qn,!t.release&&r&&(t.release=r),!t.dist&&s&&(t.dist=s);const o=t.request;o!=null&&o.url&&i&&(o.url=ne(o.url,i)),i&&((c=(a=t.exception)==null?void 0:a.values)==null||c.forEach(u=>{u.value&&(u.value=ne(u.value,i))}))}function Ja(t,e){var r,s;const n=qa(e);(s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function Va(t){var r,s;const e={};if((s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([i,o])=>{n.push({type:"sourcemap",code_file:i,debug_id:o})})}function Ya(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function Ka(t,e,n){var s,i;if(!t)return null;const r=d(d(d(d(d({},t),t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(o=>d(d({},o),o.data&&{data:H(o.data,e,n)}))}),t.user&&{user:H(t.user,e,n)}),t.contexts&&{contexts:H(t.contexts,e,n)}),t.extra&&{extra:H(t.extra,e,n)});return(s=t.contexts)!=null&&s.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=H(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(o=>d(d({},o),o.data&&{data:H(o.data,e,n)}))),(i=t.contexts)!=null&&i.flags&&r.contexts&&(r.contexts.flags=H(t.contexts.flags,3,n)),r}function Xa(t,e){if(!e)return t;const n=t?t.clone():new K;return n.update(e),n}function Za(t){if(t)return Qa(t)?{captureContext:t}:ec(t)?{captureContext:t}:t}function Qa(t){return t instanceof K||typeof t=="function"}const tc=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function ec(t){return Object.keys(t).some(e=>tc.includes(e))}function x(t,e){return O().captureException(t,Za(e))}function wn(t,e){const n=typeof e=="string"?e:void 0,r=typeof e!="string"?{captureContext:e}:void 0;return O().captureMessage(t,n,r)}function nc(t,e){return O().captureEvent(t,e)}function rc(t,e){B().setContext(t,e)}function sc(t){B().setExtras(t)}function Pn(t,e){B().setExtra(t,e)}function ic(t){B().setTags(t)}function xn(t,e){B().setTag(t,e)}function oc(t){B().setUser(t)}function ui(){return B().lastEventId()}function le(t){B().addEventProcessor(t)}const ac="7";function cc(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function uc(t){return`${cc(t)}${t.projectId}/envelope/`}function lc(t,e){const n={sentry_version:ac};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}function li(t,e,n){return e||`${uc(t)}?${lc(t,n)}`}const Zr=[];function fc(t,e){const n={};return e.forEach(r=>{r&&fi(t,r,n)}),n}function Qr(t,e){for(const n of e)n!=null&&n.afterAllSetup&&n.afterAllSetup(t)}function fi(t,e,n){if(n[e.name]){S&&h.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,!Zr.includes(e.name)&&typeof e.setupOnce=="function"&&(e.setupOnce(),Zr.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}S&&h.log(`Integration installed: ${e.name}`)}function di(t,e){return e?rt(e,()=>{const n=At(),r=n?Xs(n):Bs(e);return[n?lt(n):ri(t,e),r]}):[void 0,void 0]}const dc={trace:1,debug:5,info:9,warn:13,error:17,fatal:21};function pc(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function mc(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=Bt(r)),ft(s,[pc(t)])}const _c=100;function gc(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let n="";try{n=(e=JSON.stringify(t))!=null?e:""}catch(r){}return{value:n,type:"string"}}}}function J(t,e,n,r=!0){n&&(!t[e]||r)&&(t[e]=n)}function hc(t,e){const n=ir(),r=mi(t);r===void 0?n.set(t,[e]):r.length>=_c?(pi(t,r),n.set(t,[e])):n.set(t,[...r,e])}function xe(t,e=O(),n=hc){var Vt,st,Nt;const r=(Vt=e==null?void 0:e.getClient())!=null?Vt:v();if(!r){S&&h.warn("No client available to capture log.");return}const{release:s,environment:i,enableLogs:o=!1,beforeSendLog:a}=r.getOptions();if(!o){S&&h.warn("logging option not enabled, log will not be captured.");return}const[,c]=di(r,e),u=d({},t.attributes),{user:{id:f,email:p,username:m}}=yc(e);J(u,"user.id",f,!1),J(u,"user.email",p,!1),J(u,"user.name",m,!1),J(u,"sentry.release",s),J(u,"sentry.environment",i);const{name:l,version:_}=(Nt=(st=r.getSdkMetadata())==null?void 0:st.sdk)!=null?Nt:{};J(u,"sentry.sdk.name",l),J(u,"sentry.sdk.version",_);const y=r.getIntegrationByName("Replay"),g=y==null?void 0:y.getReplayId(!0);J(u,"sentry.replay_id",g),g&&(y==null?void 0:y.getRecordingMode())==="buffer"&&J(u,"sentry._internal.replay_is_buffering",!0);const A=t.message;if(Ye(A)){const{__sentry_template_string__:G,__sentry_template_values__:M=[]}=A;M!=null&&M.length&&(u["sentry.message.template"]=G),M.forEach((Yt,Rt)=>{u[`sentry.message.parameter.${Rt}`]=Yt})}const I=Ct(e);J(u,"sentry.trace.parent_span_id",I==null?void 0:I.spanContext().spanId);const N=E(d({},t),{attributes:u});r.emit("beforeCaptureLog",N);const w=a?Lt(()=>a(N)):N;if(!w){r.recordDroppedEvent("before_send","log_item",1),S&&h.warn("beforeSendLog returned null, log will not be captured.");return}const{level:$,message:L,attributes:b={},severityNumber:P}=w,Jt={timestamp:et(),level:$,body:L,trace_id:c==null?void 0:c.trace_id,severity_number:P!=null?P:dc[$],attributes:Object.keys(b).reduce((G,M)=>(G[M]=gc(b[M]),G),{})};n(r,Jt),r.emit("afterCaptureLog",w)}function pi(t,e){var i;const n=(i=e!=null?e:mi(t))!=null?i:[];if(n.length===0)return;const r=t.getOptions(),s=mc(n,r._metadata,r.tunnel,t.getDsn());ir().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function mi(t){return ir().get(t)}function yc(t){const e=Vn().getScopeData();return xt(e,B().getScopeData()),xt(e,t.getScopeData()),e}function ir(){return $t("clientToLogBufferMap",()=>new WeakMap)}function Sc(t){return[{type:"trace_metric",item_count:t.length,content_type:"application/vnd.sentry.items.trace-metric+json"},{items:t}]}function Ec(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=Bt(r)),ft(s,[Sc(t)])}const bc=1e3;function Tc(t){var e;switch(typeof t){case"number":return Number.isInteger(t)?{value:t,type:"integer"}:{value:t,type:"double"};case"boolean":return{value:t,type:"boolean"};case"string":return{value:t,type:"string"};default:{let n="";try{n=(e=JSON.stringify(t))!=null?e:""}catch(r){}return{value:n,type:"string"}}}}function Q(t,e,n,r=!0){n&&(r||!(e in t))&&(t[e]=n)}function Ic(t,e){const n=or(),r=gi(t);r===void 0?n.set(t,[e]):r.length>=bc?(_i(t,r),n.set(t,[e])):n.set(t,[...r,e])}function Ac(t,e,n){var l,_;const{release:r,environment:s}=e.getOptions(),i=d({},t.attributes),{user:{id:o,email:a,username:c}}=kc(n);Q(i,"user.id",o,!1),Q(i,"user.email",a,!1),Q(i,"user.name",c,!1),Q(i,"sentry.release",r),Q(i,"sentry.environment",s);const{name:u,version:f}=(_=(l=e.getSdkMetadata())==null?void 0:l.sdk)!=null?_:{};Q(i,"sentry.sdk.name",u),Q(i,"sentry.sdk.version",f);const p=e.getIntegrationByName("Replay"),m=p==null?void 0:p.getReplayId(!0);return Q(i,"sentry.replay_id",m),m&&(p==null?void 0:p.getRecordingMode())==="buffer"&&Q(i,"sentry._internal.replay_is_buffering",!0),E(d({},t),{attributes:i})}function Nc(t,e,n){const r={};for(const c in t.attributes)t.attributes[c]!==void 0&&(r[c]=Tc(t.attributes[c]));const[,s]=di(e,n),i=Ct(n),o=i?i.spanContext().traceId:s==null?void 0:s.trace_id,a=i?i.spanContext().spanId:void 0;return{timestamp:et(),trace_id:o!=null?o:"",span_id:a,name:t.name,type:t.type,unit:t.unit,value:t.value,attributes:r}}function Rc(t,e){var l,_,y,g;const n=(l=e==null?void 0:e.scope)!=null?l:O(),r=(_=e==null?void 0:e.captureSerializedMetric)!=null?_:Ic,s=(y=n==null?void 0:n.getClient())!=null?y:v();if(!s){S&&h.warn("No client available to capture metric.");return}const{_experiments:i,enableMetrics:o,beforeSendMetric:a}=s.getOptions();if(!((g=o!=null?o:i==null?void 0:i.enableMetrics)!=null?g:!0)){S&&h.warn("metrics option not enabled, metric will not be captured.");return}const u=Ac(t,s,n);s.emit("processMetric",u);const f=a||(i==null?void 0:i.beforeSendMetric),p=f?f(u):u;if(!p){S&&h.log("`beforeSendMetric` returned `null`, will not send metric.");return}const m=Nc(p,s,n);S&&h.log("[Metric]",m),r(s,m),s.emit("afterCaptureMetric",p)}function _i(t,e){var i;const n=(i=e!=null?e:gi(t))!=null?i:[];if(n.length===0)return;const r=t.getOptions(),s=Ec(n,r._metadata,r.tunnel,t.getDsn());or().set(t,[]),t.emit("flushMetrics"),t.sendEnvelope(s)}function gi(t){return or().get(t)}function kc(t){const e=Vn().getScopeData();return xt(e,B().getScopeData()),xt(e,t.getScopeData()),e}function or(){return $t("clientToMetricBufferMap",()=>new WeakMap)}const ar=Symbol.for("SentryBufferFullError");function hi(t=100){const e=new Set;function n(){return e.size<t}function r(o){e.delete(o)}function s(o){if(!n())return sr(ar);const a=o();return e.add(a),a.then(()=>r(a),()=>r(a)),a}function i(o){if(!e.size)return Ht(!0);const a=Promise.allSettled(Array.from(e)).then(()=>!0);if(!o)return a;const c=[a,new Promise(u=>setTimeout(()=>u(!1),o))];return Promise.race(c)}return{get $(){return Array.from(e)},add:s,drain:i}}const Oc=60*1e3;function vc(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?Oc:r-e}function Mc(t,e){return t[e]||t.all||0}function Cc(t,e,n=Date.now()){return Mc(t,e)>n}function wc(t,{statusCode:e,headers:n},r=Date.now()){const s=d({},t),i=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(i)for(const a of i.trim().split(",")){const[c,u,,,f]=a.split(":",5),p=parseInt(c,10),m=(isNaN(p)?60:p)*1e3;if(!u)s.all=r+m;else for(const l of u.split(";"))l==="metric_bucket"?(!f||f.split(";").includes("custom"))&&(s[l]=r+m):s[l]=r+m}else o?s.all=r+vc(o,r):e===429&&(s.all=r+60*1e3);return s}const yi=64;function Pc(t,e,n=hi(t.bufferSize||yi)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(se(o,(p,m)=>{const l=Gr(m);Cc(r,l)?t.recordDroppedEvent("ratelimit_backoff",l):a.push(p)}),a.length===0)return Promise.resolve({});const c=ft(o[0],a),u=p=>{se(c,(m,l)=>{t.recordDroppedEvent(p,Gr(l))})},f=()=>e({body:pa(c)}).then(p=>(p.statusCode!==void 0&&(p.statusCode<200||p.statusCode>=300)&&S&&h.warn(`Sentry responded with status code ${p.statusCode} to sent event.`),r=wc(r,p),p),p=>{throw u("network_error"),S&&h.error("Encountered error running transport request:",p),p});return n.add(f).then(p=>p,p=>{if(p===ar)return S&&h.error("Skipped sending event because buffer is full."),u("queue_overflow"),Promise.resolve({});throw p})}return{send:i,flush:s}}function xc(t,e,n){const r=[{type:"client_report"},{timestamp:oe(),discarded_events:t}];return ft(e?{dsn:e}:{},[r])}function Si(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];n!=null&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch(n){}return e}function Dc(t){var c,u,f;const{trace_id:e,parent_span_id:n,span_id:r,status:s,origin:i,data:o,op:a}=(u=(c=t.contexts)==null?void 0:c.trace)!=null?u:{};return{data:o!=null?o:{},description:t.transaction,op:a,parent_span_id:n,span_id:r!=null?r:"",start_timestamp:(f=t.start_timestamp)!=null?f:0,status:s,timestamp:t.timestamp,trace_id:e!=null?e:"",origin:i,profile_id:o==null?void 0:o[Yn],exclusive_time:o==null?void 0:o[Kn],measurements:t.measurements,is_segment:!0}}function $c(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:d(d(d({},t.data),t.profile_id&&{[Yn]:t.profile_id}),t.exclusive_time&&{[Kn]:t.exclusive_time})}},measurements:t.measurements}}const ts="Not capturing exception because it's already been captured.",es="Discarded session because of missing or non-string release",Ei=Symbol.for("SentryInternalError"),bi=Symbol.for("SentryDoNotSendEventError"),Lc=5e3;function ke(t){return{message:t,[Ei]:!0}}function En(t){return{message:t,[bi]:!0}}function ns(t){return!!t&&typeof t=="object"&&Ei in t}function rs(t){return!!t&&typeof t=="object"&&bi in t}function ss(t,e,n,r,s){let i=0,o,a=!1;t.on(n,()=>{i=0,clearTimeout(o),a=!1}),t.on(e,c=>{i+=r(c),i>=8e5?s(t):a||(a=!0,o=setTimeout(()=>{s(t)},Lc))}),t.on("flush",()=>{s(t)})}class Fc{constructor(e){var r,s,i,o,a,c,u;if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],this._promiseBuffer=hi((s=(r=e.transportOptions)==null?void 0:r.bufferSize)!=null?s:yi),e.dsn?this._dsn=Qo(e.dsn):S&&h.warn("No DSN provided, client will not send events."),this._dsn){const f=li(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport(E(d({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this)},e.transportOptions),{url:f}))}this._options.enableLogs=(o=this._options.enableLogs)!=null?o:(i=this._options._experiments)==null?void 0:i.enableLogs,this._options.enableLogs&&ss(this,"afterCaptureLog","flushLogs",Gc,pi),((u=(c=this._options.enableMetrics)!=null?c:(a=this._options._experiments)==null?void 0:a.enableMetrics)!=null?u:!0)&&ss(this,"afterCaptureMetric","flushMetrics",Bc,_i)}captureException(e,n,r){const s=V();if(xr(e))return S&&h.log(ts),s;const i=d({event_id:s},n);return this._process(()=>this.eventFromException(e,i).then(o=>this._captureEvent(o,i,r)).then(o=>o),"error"),i.event_id}captureMessage(e,n,r,s){const i=d({event_id:V()},r),o=Ye(e)?e:String(e),a=Jn(e),c=a?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(()=>c.then(u=>this._captureEvent(u,i,s)),a?"unknown":"error"),i.event_id}captureEvent(e,n,r){const s=V();if(n!=null&&n.originalException&&xr(n.originalException))return S&&h.log(ts),s;const i=d({event_id:s},n),o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope,u=is(e.type);return this._process(()=>this._captureEvent(e,i,a||r,c),u),i.event_id}captureSession(e){this.sendSession(e),An(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){return F(this,null,function*(){const n=this._transport;if(!n)return!0;this.emit("flush");const r=yield this._isClientDoneProcessing(e),s=yield n.flush(e);return r&&s})}close(e){return F(this,null,function*(){const n=yield this.flush(e);return this.getOptions().enabled=!1,this.emit("close"),n})}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];fi(this,e,this._integrations),n||Qr(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=ba(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])r=da(r,ga(s));this.sendEnvelope(r).then(s=>this.emit("afterSendEvent",e,s))}sendSession(e){const{release:n,environment:r=Qn}=this._options;if("aggregates"in e){const i=e.attrs||{};if(!i.release&&!n){S&&h.warn(es);return}i.release=i.release||n,i.environment=i.environment||r,e.attrs=i}else{if(!e.release&&!n){S&&h.warn(es);return}e.release=e.release||n,e.environment=e.environment||r}this.emit("beforeSendSession",e);const s=Ea(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,n,r=1){if(this._options.sendClientReports){const s=`${e}:${n}`;S&&h.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,n){const r=this._hooks[e]=this._hooks[e]||new Set,s=(...i)=>n(...i);return r.add(s),()=>{r.delete(s)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}sendEnvelope(e){return F(this,null,function*(){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)try{return yield this._transport.send(e)}catch(n){return S&&h.error("Error while sending envelope:",n),{}}return S&&h.error("Transport disabled"),{}})}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=fc(this,e),Qr(this,e)}_updateSessionFromEvent(e,n){var c,u;let r=n.level==="fatal",s=!1;const i=(c=n.exception)==null?void 0:c.values;if(i){s=!0,r=!1;for(const f of i)if(((u=f.mechanism)==null?void 0:u.handled)===!1){r=!0;break}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(An(e,E(d({},r&&{status:"crashed"}),{errors:e.errors||Number(s||r)})),this.captureSession(e))}_isClientDoneProcessing(e){return F(this,null,function*(){let n=0;for(;!e||n<e;){if(yield new Promise(r=>setTimeout(r,1)),!this._numProcessing)return!0;n++}return!1})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s){const i=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),za(i,e,n,r,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts=d({trace:Bs(r)},a.contexts);const c=ri(this,r);return a.sdkProcessingMetadata=d({dynamicSamplingContext:c},a.sdkProcessingMetadata),a})}_captureEvent(e,n={},r=O(),s=B()){return S&&Dn(e)&&h.log(`Captured error event \`${Si(e)[0]||"<unknown>"}\``),this._processEvent(e,n,r,s).then(i=>i.event_id,i=>{S&&(rs(i)?h.log(i.message):ns(i)?h.warn(i.message):h.warn(i))})}_processEvent(e,n,r,s){const i=this.getOptions(),{sampleRate:o}=i,a=Ti(e),c=Dn(e),f=`before send for type \`${e.type||"error"}\``,p=typeof o=="undefined"?void 0:Xn(o);if(c&&typeof p=="number"&&Math.random()>p)return this.recordDroppedEvent("sample_rate","error"),sr(En(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const m=is(e.type);return this._prepareEvent(e,n,r,s).then(l=>{if(l===null)throw this.recordDroppedEvent("event_processor",m),En("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return l;const y=jc(this,i,l,n);return Uc(y,f)}).then(l=>{var g;if(l===null){if(this.recordDroppedEvent("before_send",m),a){const I=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",I)}throw En(`${f} returned \`null\`, will not send event.`)}const _=r.getSession()||s.getSession();if(c&&_&&this._updateSessionFromEvent(_,l),a){const A=((g=l.sdkProcessingMetadata)==null?void 0:g.spanCountBeforeProcessing)||0,I=l.spans?l.spans.length:0,N=A-I;N>0&&this.recordDroppedEvent("before_send","span",N)}const y=l.transaction_info;if(a&&y&&l.transaction!==e.transaction){const A="custom";l.transaction_info=E(d({},y),{source:A})}return this.sendEvent(l,n),l}).then(null,l=>{throw rs(l)||ns(l)?l:(this.captureException(l,{mechanism:{handled:!1,type:"internal"},data:{__sentry__:!0},originalException:l}),ke(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${l}`))})}_process(e,n){this._numProcessing++,this._promiseBuffer.add(e).then(r=>(this._numProcessing--,r),r=>(this._numProcessing--,r===ar&&this.recordDroppedEvent("queue_overflow",n),r))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){S&&h.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){S&&h.log("No outcomes to send");return}if(!this._dsn){S&&h.log("No dsn provided, will not send outcomes");return}S&&h.log("Sending outcomes:",e);const n=xc(e,this._options.tunnel&&Bt(this._dsn));this.sendEnvelope(n)}}function is(t){return t==="replay_event"?"replay":t||"error"}function Uc(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Ut(t))return t.then(r=>{if(!Et(r)&&r!==null)throw ke(n);return r},r=>{throw ke(`${e} rejected with ${r}`)});if(!Et(t)&&t!==null)throw ke(n);return t}function jc(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:o,ignoreSpans:a}=e;let c=n;if(Dn(c)&&s)return s(c,r);if(Ti(c)){if(o||a){const u=Dc(c);if(a!=null&&a.length&&Pe(u,a))return null;if(o){const f=o(u);f?c=ae(n,$c(f)):On()}if(c.spans){const f=[],p=c.spans;for(const l of p){if(a!=null&&a.length&&Pe(l,a)){ia(p,l);continue}if(o){const _=o(l);_?f.push(_):(On(),f.push(l))}else f.push(l)}const m=c.spans.length-f.length;m&&t.recordDroppedEvent("before_send","span",m),c.spans=f}}if(i){if(c.spans){const u=c.spans.length;c.sdkProcessingMetadata=E(d({},n.sdkProcessingMetadata),{spanCountBeforeProcessing:u})}return i(c,r)}}return c}function Dn(t){return t.type===void 0}function Ti(t){return t.type==="transaction"}function Bc(t){let e=0;return t.name&&(e+=t.name.length*2),e+=8,e+Ii(t.attributes)}function Gc(t){let e=0;return t.message&&(e+=t.message.length*2),e+Ii(t.attributes)}function Ii(t){if(!t)return 0;let e=0;return Object.values(t).forEach(n=>{Array.isArray(n)?e+=n.length*os(n[0]):Jn(n)?e+=os(n):e+=100}),e}function os(t){return typeof t=="string"?t.length*2:typeof t=="number"?8:typeof t=="boolean"?4:0}function Hc(t,e){e.debug===!0&&(S?h.enable():Lt(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),O().update(e.initialScope);const r=new t(e);return qc(r),r.init(),r}function qc(t){O().setClient(t)}function Ai(t,e){let n;return se(t,(r,s)=>(e.includes(s)&&(n=Array.isArray(r)?r[1]:void 0),!!n)),n}function zc(t,e){return n=>{const r=t(n);return E(d({},r),{send:s=>F(null,null,function*(){const i=Ai(s,["event","transaction","profile","replay_event"]);return i&&(i.release=e),r.send(s)})})}}function Wc(t,e){return ft(e?E(d({},t[0]),{dsn:e}):t[0],t[1])}function Jc(t,e){return n=>{const r=t(n),s=new Map;function i(c,u){const f=u?`${c}:${u}`:c;let p=s.get(f);if(!p){const m=Vs(c);if(!m)return;const l=li(m,n.tunnel);p=u?zc(t,u)(E(d({},n),{url:l})):t(E(d({},n),{url:l})),s.set(f,p)}return[c,p]}function o(c){return F(this,null,function*(){function u(l){const _=l!=null&&l.length?l:["event"];return Ai(c,_)}const f=e({envelope:c,getEvent:u}).map(l=>typeof l=="string"?i(l,void 0):i(l.dsn,l.release)).filter(l=>!!l),p=f.length?f:[["",r]];return(yield Promise.all(p.map(([l,_])=>_.send(Wc(c,l)))))[0]})}function a(c){return F(this,null,function*(){const u=[...s.values(),r];return(yield Promise.all(u.map(p=>p.flush(c)))).every(p=>p)})}return{send:o,flush:a}}}function Vc(t,...e){const n=new String(String.raw(t,...e));return n.__sentry_template_string__=t.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),n.__sentry_template_values__=e,n}const Yc=Vc;function Kc(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:mt})),version:mt}),t._metadata=s}const Xc=100;function Ni(t,e){const n=v(),r=B();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=Xc}=n.getOptions();if(i<=0)return;const o=oe(),a=d({timestamp:o},t),c=s?Lt(()=>s(a,e)):a;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let as;const Zc="FunctionToString",cs=new WeakMap,Qc=(()=>({name:Zc,setupOnce(){as=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=Ls(this),n=cs.has(v())&&e!==void 0?e:this;return as.apply(n,t)}}catch(t){}},setup(t){cs.set(t,!0)}})),tu=Qc,eu=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],nu="EventFilters",ru=(t={})=>{let e;return{name:nu,setup(n){const r=n.getOptions();e=us(t,r)},processEvent(n,r,s){if(!e){const i=s.getOptions();e=us(t,i)}return su(n,e)?null:n}}};function us(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:eu],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function su(t,e){if(t.type){if(t.type==="transaction"&&ou(t,e.ignoreTransactions))return S&&h.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Ot(t)}`),!0}else{if(iu(t,e.ignoreErrors))return S&&h.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Ot(t)}`),!0;if(lu(t))return S&&h.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Ot(t)}`),!0;if(au(t,e.denyUrls))return S&&h.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Ot(t)}.
Url: ${De(t)}`),!0;if(!cu(t,e.allowUrls))return S&&h.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Ot(t)}.
Url: ${De(t)}`),!0}return!1}function iu(t,e){return e!=null&&e.length?Si(t).some(n=>Ze(n,e)):!1}function ou(t,e){if(!(e!=null&&e.length))return!1;const n=t.transaction;return n?Ze(n,e):!1}function au(t,e){if(!(e!=null&&e.length))return!1;const n=De(t);return n?Ze(n,e):!1}function cu(t,e){if(!(e!=null&&e.length))return!0;const n=De(t);return n?Ze(n,e):!0}function uu(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function De(t){var e,n,r;try{const s=[...(n=(e=t.exception)==null?void 0:e.values)!=null?n:[]].reverse().find(o=>{var a,c,u;return((a=o.mechanism)==null?void 0:a.parent_id)===void 0&&((u=(c=o.stacktrace)==null?void 0:c.frames)==null?void 0:u.length)}),i=(r=s==null?void 0:s.stacktrace)==null?void 0:r.frames;return i?uu(i):null}catch(s){return S&&h.error(`Cannot extract url for event ${Ot(t)}`),null}}function lu(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)!=null&&n.length?!t.message&&!t.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}const Ri=new Map,ls=new Set;function fu(t){if(T._sentryModuleMetadata)for(const e of Object.keys(T._sentryModuleMetadata)){const n=T._sentryModuleMetadata[e];if(ls.has(e))continue;ls.add(e);const r=t(e);for(const s of r.reverse())if(s.filename){Ri.set(s.filename,n);break}}}function du(t,e){return fu(t),Ri.get(e)}function ki(t,e){var n,r;(r=(n=e.exception)==null?void 0:n.values)==null||r.forEach(s=>{var i,o;(o=(i=s.stacktrace)==null?void 0:i.frames)==null||o.forEach(a=>{if(!a.filename||a.module_metadata)return;const c=du(t,a.filename);c&&(a.module_metadata=c)})})}function Oi(t){var e,n;(n=(e=t.exception)==null?void 0:e.values)==null||n.forEach(r=>{var s,i;(i=(s=r.stacktrace)==null?void 0:s.frames)==null||i.forEach(o=>{delete o.module_metadata})})}const pu=()=>({name:"ModuleMetadata",setup(t){t.on("beforeEnvelope",e=>{se(e,(n,r)=>{if(r==="event"){const s=Array.isArray(n)?n[1]:void 0;s&&(Oi(s),n[1]=s)}})}),t.on("applyFrameMetadata",e=>{if(e.type)return;const n=t.getOptions().stackParser;ki(n,e)})}});function vi(t){const e="console";qn(e,t),zn(e,mu)}function mu(){"console"in T&&Bn.forEach(function(t){t in T.console&&pt(T.console,t,function(e){return ve[t]=e,function(...n){Wn("console",{args:n,level:t});const s=ve[t];s==null||s.apply(T.console,n)}})})}function fs(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const _u="CaptureConsole",gu=((t={})=>{var r;const e=t.levels||Bn,n=(r=t.handled)!=null?r:!0;return{name:_u,setup(s){"console"in T&&vi(({args:i,level:o})=>{v()!==s||!e.includes(o)||yu(i,o,n)})}}}),hu=gu;function yu(t,e,n){const r=fs(e),s=new Error,i={level:fs(e),extra:{arguments:t}};rt(o=>{if(o.addEventProcessor(u=>(u.logger="console",ct(u,{handled:n,type:"auto.core.capture_console"}),u)),e==="assert"){if(!t[0]){const u=`Assertion failed: ${Pr(t.slice(1)," ")||"console.assert"}`;o.setExtra("arguments",t.slice(1)),o.captureMessage(u,r,{captureContext:i,syntheticException:s})}return}const a=t.find(u=>u instanceof Error);if(a){x(a,i);return}const c=Pr(t," ");o.captureMessage(c,r,{captureContext:i,syntheticException:s})})}const Su="ExtraErrorData",Eu=((t={})=>{const{depth:e=3,captureErrorCause:n=!0}=t;return{name:Su,processEvent(r,s,i){const{maxValueLength:o}=i.getOptions();return Tu(r,s,e,n,o)}}}),bu=Eu;function Tu(t,e={},n,r,s){if(!e.originalException||!_t(e.originalException))return t;const i=e.originalException.name||e.originalException.constructor.name,o=Mi(e.originalException,r,s);if(o){const a=d({},t.contexts),c=H(o,n);return Et(c)&&(W(c,"__sentry_skip_normalization__",!0),a[i]=c),E(d({},t),{contexts:a})}return t}function Mi(t,e,n){try{const r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],s={};for(const i of Object.keys(t)){if(r.indexOf(i)!==-1)continue;const o=t[i];s[i]=_t(o)||typeof o=="string"?n?ne(`${o}`,n):`${o}`:o}if(e&&t.cause!==void 0)if(_t(t.cause)){const i=t.cause.name||t.cause.constructor.name;s.cause={[i]:Mi(t.cause,!1,n)}}else s.cause=t.cause;if(typeof t.toJSON=="function"){const i=t.toJSON();for(const o of Object.keys(i)){const a=i[o];s[o]=_t(a)?a.toString():a}}return s}catch(r){S&&h.error("Unable to extract extra data from the Error object:",r)}return null}function Iu(t,e){let n=0;for(let r=t.length-1;r>=0;r--){const s=t[r];s==="."?t.splice(r,1):s===".."?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}const Au=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function Nu(t){const e=t.length>1024?`<truncated>${t.slice(-1024)}`:t,n=Au.exec(e);return n?n.slice(1):[]}function ds(...t){let e="",n=!1;for(let r=t.length-1;r>=-1&&!n;r--){const s=r>=0?t[r]:"/";s&&(e=`${s}/${e}`,n=s.charAt(0)==="/")}return e=Iu(e.split("/").filter(r=>!!r),!n).join("/"),(n?"/":"")+e||"."}function ps(t){let e=0;for(;e<t.length&&t[e]==="";e++);let n=t.length-1;for(;n>=0&&t[n]==="";n--);return e>n?[]:t.slice(e,n-e+1)}function Ru(t,e){t=ds(t).slice(1),e=ds(e).slice(1);const n=ps(t.split("/")),r=ps(e.split("/")),s=Math.min(n.length,r.length);let i=s;for(let a=0;a<s;a++)if(n[a]!==r[a]){i=a;break}let o=[];for(let a=i;a<n.length;a++)o.push("..");return o=o.concat(r.slice(i)),o.join("/")}function ku(t,e){return Nu(t)[2]||""}const Ou="RewriteFrames",vu=(t={})=>{const e=t.root,n=t.prefix||"app:///",r="window"in T&&!!T.window,s=t.iteratee||Mu({isBrowser:r,root:e,prefix:n});function i(a){try{return E(d({},a),{exception:E(d({},a.exception),{values:a.exception.values.map(c=>d(d({},c),c.stacktrace&&{stacktrace:o(c.stacktrace)}))})})}catch(c){return a}}function o(a){var c;return E(d({},a),{frames:(c=a==null?void 0:a.frames)==null?void 0:c.map(u=>s(u))})}return{name:Ou,processEvent(a){let c=a;return a.exception&&Array.isArray(a.exception.values)&&(c=i(c)),c}}};function Mu({isBrowser:t,root:e,prefix:n}){return r=>{if(!r.filename)return r;const s=/^[a-zA-Z]:\\/.test(r.filename)||r.filename.includes("\\")&&!r.filename.includes("/"),i=/^\//.test(r.filename);if(t){if(e){const o=r.filename;o.indexOf(e)===0&&(r.filename=o.replace(e,n))}}else if(s||i){const o=s?r.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):r.filename,a=e?Ru(e,o):ku(o);r.filename=`${n}${a}`}return r}}const Cu=["reauthenticate","signInAnonymously","signInWithOAuth","signInWithIdToken","signInWithOtp","signInWithPassword","signInWithSSO","signOut","signUp","verifyOtp"],wu=["createUser","deleteUser","listUsers","getUserById","updateUserById","inviteUserByEmail"],Pu={eq:"eq",neq:"neq",gt:"gt",gte:"gte",lt:"lt",lte:"lte",like:"like","like(all)":"likeAllOf","like(any)":"likeAnyOf",ilike:"ilike","ilike(all)":"ilikeAllOf","ilike(any)":"ilikeAnyOf",is:"is",in:"in",cs:"contains",cd:"containedBy",sr:"rangeGt",nxl:"rangeGte",sl:"rangeLt",nxr:"rangeLte",adj:"rangeAdjacent",ov:"overlaps",fts:"",plfts:"plain",phfts:"phrase",wfts:"websearch",not:"not"},Ci=["select","insert","upsert","update","delete"];function sn(t){try{t.__SENTRY_INSTRUMENTED__=!0}catch(e){}}function on(t){try{return t.__SENTRY_INSTRUMENTED__}catch(e){return!1}}function xu(t,e={}){var n;switch(t){case"GET":return"select";case"POST":return(n=e.Prefer)!=null&&n.includes("resolution=")?"upsert":"insert";case"PATCH":return"update";case"DELETE":return"delete";default:return"<unknown-op>"}}function Du(t,e){if(e===""||e==="*")return"select(*)";if(t==="select")return`select(${e})`;if(t==="or"||t.endsWith(".or"))return`${t}${e}`;const[n,...r]=e.split(".");let s;return n!=null&&n.startsWith("fts")?s="textSearch":n!=null&&n.startsWith("plfts")?s="textSearch[plain]":n!=null&&n.startsWith("phfts")?s="textSearch[phrase]":n!=null&&n.startsWith("wfts")?s="textSearch[websearch]":s=n&&Pu[n]||"filter",`${s}(${t}, ${r.join(".")})`}function ms(t,e=!1){return new Proxy(t,{apply(n,r,s){return Gt({name:`auth ${e?"(admin) ":""}${t.name}`,attributes:{[D]:"auto.db.supabase",[re]:"db","db.system":"postgresql","db.operation":`auth.${e?"admin.":""}${t.name}`}},i=>Reflect.apply(n,r,s).then(o=>(o&&typeof o=="object"&&"error"in o&&o.error?(i.setStatus({code:k}),x(o.error,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}})):i.setStatus({code:Qe}),i.end(),o)).catch(o=>{throw i.setStatus({code:k}),i.end(),x(o,{mechanism:{handled:!1,type:"auto.db.supabase.auth"}}),o}).then(...s))}})}function $u(t){const e=t.auth;if(!(!e||on(t.auth))){for(const n of Cu){const r=e[n];r&&typeof t.auth[n]=="function"&&(t.auth[n]=ms(r))}for(const n of wu){const r=e.admin[n];r&&typeof t.auth.admin[n]=="function"&&(t.auth.admin[n]=ms(r,!0))}sn(t.auth)}}function Lu(t){on(t.prototype.from)||(t.prototype.from=new Proxy(t.prototype.from,{apply(e,n,r){const s=Reflect.apply(e,n,r),i=s.constructor;return Uu(i),s}}),sn(t.prototype.from))}function Fu(t){on(t.prototype.then)||(t.prototype.then=new Proxy(t.prototype.then,{apply(e,n,r){var l;const s=Ci,i=n,o=xu(i.method,i.headers);if(!s.includes(o)||!((l=i==null?void 0:i.url)!=null&&l.pathname)||typeof i.url.pathname!="string")return Reflect.apply(e,n,r);const a=i.url.pathname.split("/"),c=a.length>0?a[a.length-1]:"",u=[];for(const[_,y]of i.url.searchParams.entries())u.push(Du(_,y));const f=Object.create(null);if(Et(i.body))for(const[_,y]of Object.entries(i.body))f[_]=y;const p=`${o==="select"?"":`${o}${f?"(...) ":""}`}${u.join(" ")} from(${c})`,m={"db.table":c,"db.schema":i.schema,"db.url":i.url.origin,"db.sdk":i.headers["X-Client-Info"],"db.system":"postgresql","db.operation":o,[D]:"auto.db.supabase",[re]:"db"};return u.length&&(m["db.query"]=u),Object.keys(f).length&&(m["db.body"]=f),Gt({name:p,attributes:m},_=>Reflect.apply(e,n,[]).then(y=>{if(_&&(y&&typeof y=="object"&&"status"in y&&Rn(_,y.status||500),_.end()),y.error){const I=new Error(y.error.message);y.error.code&&(I.code=y.error.code),y.error.details&&(I.details=y.error.details);const N={};u.length&&(N.query=u),Object.keys(f).length&&(N.body=f),x(I,w=>(w.addEventProcessor($=>(ct($,{handled:!1,type:"auto.db.supabase.postgres"}),$)),w.setContext("supabase",N),w))}const g={type:"supabase",category:`db.${o}`,message:p},A={};return u.length&&(A.query=u),Object.keys(f).length&&(A.body=f),Object.keys(A).length&&(g.data=A),Ni(g),y},y=>{throw _&&(Rn(_,500),_.end()),y}).then(...r))}}),sn(t.prototype.then))}function Uu(t){for(const e of Ci)on(t.prototype[e])||(t.prototype[e]=new Proxy(t.prototype[e],{apply(n,r,s){const i=Reflect.apply(n,r,s),o=i.constructor;return S&&h.log(`Instrumenting ${e} operation's PostgRESTFilterBuilder`),Fu(o),i}}),sn(t.prototype[e]))}const wi=t=>{if(!t){S&&h.warn("Supabase integration was not installed because no Supabase client was provided.");return}const e=t.constructor===Function?t:t.constructor;Lu(e),$u(t)},ju="Supabase",Bu=(t=>({setupOnce(){wi(t)},name:ju})),Gu=t=>Bu(t.supabaseClient),Hu=10,qu="ZodErrors";function zu(t){return _t(t)&&t.name==="ZodError"&&Array.isArray(t.issues)}function Wu(t){return E(d({},t),{path:"path"in t&&Array.isArray(t.path)?t.path.join("."):void 0,keys:"keys"in t?JSON.stringify(t.keys):void 0,unionErrors:"unionErrors"in t?JSON.stringify(t.unionErrors):void 0})}function Ju(t){return t.map(e=>typeof e=="number"?"<array>":e).join(".")}function Vu(t){const e=new Set;for(const r of t.issues){const s=Ju(r.path);s.length>0&&e.add(s)}const n=Array.from(e);if(n.length===0){let r="variable";if(t.issues.length>0){const s=t.issues[0];s!==void 0&&"expected"in s&&typeof s.expected=="string"&&(r=s.expected)}return`Failed to validate ${r}`}return`Failed to validate keys: ${ne(n.join(", "),100)}`}function Yu(t,e=!1,n,r){var s;if(!((s=n.exception)!=null&&s.values)||!r.originalException||!zu(r.originalException)||r.originalException.issues.length===0)return n;try{const o=(e?r.originalException.issues:r.originalException.issues.slice(0,t)).map(Wu);return e&&(Array.isArray(r.attachments)||(r.attachments=[]),r.attachments.push({filename:"zod_issues.json",data:JSON.stringify({issues:o})})),E(d({},n),{exception:E(d({},n.exception),{values:[E(d({},n.exception.values[0]),{value:Vu(r.originalException)}),...n.exception.values.slice(1)]}),extra:E(d({},n.extra),{"zoderror.issues":o.slice(0,t)})})}catch(i){return E(d({},n),{extra:E(d({},n.extra),{"zoderrors sentry integration parse error":{message:"an exception was thrown while processing ZodError within applyZodErrorsToEvent()",error:i instanceof Error?`${i.name}: ${i.message}
${i.stack}`:"unknown"}})})}}const Ku=((t={})=>{var n;const e=(n=t.limit)!=null?n:Hu;return{name:qu,processEvent(r,s){return Yu(e,t.saveZodIssuesAsAttachment,r,s)}}}),Xu=Ku,Zu=t=>({name:"ThirdPartyErrorsFilter",setup(e){e.on("beforeEnvelope",n=>{se(n,(r,s)=>{if(s==="event"){const i=Array.isArray(r)?r[1]:void 0;i&&(Oi(i),r[1]=i)}})}),e.on("applyFrameMetadata",n=>{if(n.type)return;const r=e.getOptions().stackParser;ki(r,n)})},processEvent(e){const n=Qu(e);if(n){const r=t.behaviour==="drop-error-if-contains-third-party-frames"||t.behaviour==="apply-tag-if-contains-third-party-frames"?"some":"every";if(n[r](i=>!i.some(o=>t.filterKeys.includes(o)))){if(t.behaviour==="drop-error-if-contains-third-party-frames"||t.behaviour==="drop-error-if-exclusively-contains-third-party-frames")return null;e.tags=E(d({},e.tags),{third_party_code:!0})}}return e}});function Qu(t){const e=po(t);if(e)return e.filter(n=>{var r;return!!n.filename&&((r=n.lineno)!=null?r:n.colno)!=null}).map(n=>n.module_metadata?Object.keys(n.module_metadata).filter(r=>r.startsWith(_s)).map(r=>r.slice(_s.length)):[])}const _s="_sentryBundlerPluginAppKey:",tl=100,el=10,Te="flag.evaluation.";function nl(t){const n=O().getScopeData().contexts.flags,r=n?n.values:[];return r.length&&(t.contexts===void 0&&(t.contexts={}),t.contexts.flags={values:[...r]}),t}function rl(t,e,n=tl){const r=O().getScopeData().contexts;r.flags||(r.flags={values:[]});const s=r.flags.values;sl(s,t,e,n)}function sl(t,e,n,r){if(typeof n!="boolean")return;if(t.length>r){S&&h.error(`[Feature Flags] insertToFlagBuffer called on a buffer larger than maxSize=${r}`);return}const s=t.findIndex(i=>i.flag===e);s!==-1&&t.splice(s,1),t.length===r&&t.shift(),t.push({flag:e,result:n})}function il(t,e,n=el){if(typeof e!="boolean")return;const r=At();if(!r)return;const s=R(r).data;if(`${Te}${t}`in s){r.setAttribute(`${Te}${t}`,e);return}Object.keys(s).filter(o=>o.startsWith(Te)).length<n&&r.setAttribute(`${Te}${t}`,e)}const ol=()=>({name:"FeatureFlags",processEvent(t,e,n){return nl(t)},addFeatureFlag(t,e){rl(t,e),il(t,e)}});function qt(t,e,n,r,s){xe({level:t,message:e,attributes:n,severityNumber:s},r)}function al(t,e,{scope:n}={}){qt("trace",t,e,n)}function cl(t,e,{scope:n}={}){qt("debug",t,e,n)}function ul(t,e,{scope:n}={}){qt("info",t,e,n)}function ll(t,e,{scope:n}={}){qt("warn",t,e,n)}function fl(t,e,{scope:n}={}){qt("error",t,e,n)}function dl(t,e,{scope:n}={}){qt("fatal",t,e,n)}const pl=Object.freeze(Object.defineProperty({__proto__:null,debug:cl,error:fl,fatal:dl,fmt:Yc,info:ul,trace:al,warn:ll},Symbol.toStringTag,{value:"Module"}));function $n(t,e,n){return"util"in T&&typeof T.util.format=="function"?T.util.format(...t):ml(t,e,n)}function ml(t,e,n){return t.map(r=>Jn(r)?String(r):JSON.stringify(H(r,e,n))).join(" ")}function _l(t){return/%[sdifocO]/.test(t)}function gl(t,e){const n={},r=new Array(e.length).fill("{}").join(" ");return n["sentry.message.template"]=`${t} ${r}`,e.forEach((s,i)=>{n[`sentry.message.parameter.${i}`]=s}),n}const hl="ConsoleLogs",gs={[D]:"auto.log.console"},yl=((t={})=>{const e=t.levels||Bn;return{name:hl,setup(n){const{enableLogs:r,normalizeDepth:s=3,normalizeMaxBreadth:i=1e3}=n.getOptions();if(!r){S&&h.warn("`enableLogs` is not enabled, ConsoleLogs integration disabled");return}vi(({args:o,level:a})=>{if(v()!==n||!e.includes(a))return;const c=o[0],u=o.slice(1);if(a==="assert"){if(!c){const l=u.length>0?`Assertion failed: ${$n(u,s,i)}`:"Assertion failed";xe({level:"error",message:l,attributes:gs})}return}const f=a==="log",p=o.length>1&&typeof o[0]=="string"&&!_l(o[0]),m=d(d({},gs),p?gl(c,u):{});xe({level:f?"info":a,message:$n(o,s,i),severityNumber:f?10:void 0,attributes:m})})}}}),Sl=yl;function cr(t,e,n,r){Rc({type:t,name:e,value:n,unit:r==null?void 0:r.unit,attributes:r==null?void 0:r.attributes},{scope:r==null?void 0:r.scope})}function El(t,e=1,n){cr("counter",t,e,n)}function bl(t,e,n){cr("gauge",t,e,n)}function Tl(t,e,n){cr("distribution",t,e,n)}const Il=Object.freeze(Object.defineProperty({__proto__:null,count:El,distribution:Tl,gauge:bl},Symbol.toStringTag,{value:"Module"})),Al=["trace","debug","info","warn","error","fatal"];function Nl(t={}){var r;const e=new Set((r=t.levels)!=null?r:Al),n=t.client;return{log(s){const I=s,{type:i,level:o,message:a,args:c,tag:u,date:f}=I,p=pn(I,["type","level","message","args","tag","date"]),m=n||v();if(!m)return;const l=Ol(i,o);if(!e.has(l))return;const{normalizeDepth:_=3,normalizeMaxBreadth:y=1e3}=m.getOptions(),g=[];a&&g.push(a),c&&c.length>0&&g.push($n(c,_,y));const A=g.join(" ");p["sentry.origin"]="auto.log.consola",u&&(p["consola.tag"]=u),i&&(p["consola.type"]=i),o!=null&&typeof o=="number"&&(p["consola.level"]=o),xe({level:l,message:A,attributes:p})}}}const Rl={silent:"trace",fatal:"fatal",error:"error",warn:"warn",log:"info",info:"info",success:"info",fail:"error",ready:"info",start:"info",box:"info",debug:"debug",trace:"trace",verbose:"debug",critical:"fatal",notice:"info"},kl={0:"fatal",1:"warn",2:"info",3:"info",4:"debug",5:"trace"};function Ol(t,e){if(t==="verbose")return"debug";if(t==="silent")return"trace";if(t){const n=Rl[t];if(n)return n}if(typeof e=="number"){const n=kl[e];if(n)return n}return"info"}const vl="gen_ai.prompt",ur="gen_ai.system",z="gen_ai.request.model",Pi="gen_ai.request.stream",lr="gen_ai.request.temperature",xi="gen_ai.request.max_tokens",fr="gen_ai.request.frequency_penalty",Di="gen_ai.request.presence_penalty",dr="gen_ai.request.top_p",$i="gen_ai.request.top_k",Ml="gen_ai.request.encoding_format",Cl="gen_ai.request.dimensions",zt="gen_ai.response.finish_reasons",Wt="gen_ai.response.model",fe="gen_ai.response.id",an="gen_ai.usage.input_tokens",cn="gen_ai.usage.output_tokens",un="gen_ai.usage.total_tokens",pr="gen_ai.operation.name",yt="gen_ai.request.messages",Y="gen_ai.response.text",mr="gen_ai.request.available_tools",ln="gen_ai.response.streaming",dt="gen_ai.response.tool_calls",wl="openai.response.id",Li="openai.response.model",Pl="openai.response.timestamp",xl="openai.usage.completion_tokens",Dl="openai.usage.prompt_tokens",bn={CHAT:"chat",RESPONSES:"responses",EMBEDDINGS:"embeddings"},hs="anthropic.response.timestamp",Fi=2e4,$e=t=>new TextEncoder().encode(t).length,Le=t=>$e(JSON.stringify(t));function _r(t,e){if($e(t)<=e)return t;let n=0,r=t.length,s="";for(;n<=r;){const i=Math.floor((n+r)/2),o=t.slice(0,i);$e(o)<=e?(s=o,n=i+1):r=i-1}return s}function $l(t){return typeof t=="string"?t:t.text}function ys(t,e){return typeof t=="string"?e:E(d({},t),{text:e})}function Ll(t){return t!==null&&typeof t=="object"&&"content"in t&&typeof t.content=="string"}function Fl(t){return t!==null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)&&t.parts.length>0}function Ul(t,e){const n=E(d({},t),{content:""}),r=Le(n),s=e-r;if(s<=0)return[];const i=_r(t.content,s);return[E(d({},t),{content:i})]}function jl(t,e){const{parts:n}=t,r=n.map(a=>ys(a,"")),s=Le(E(d({},t),{parts:r}));let i=e-s;if(i<=0)return[];const o=[];for(const a of n){const c=$l(a),u=$e(c);if(u<=i)o.push(a),i-=u;else if(o.length===0){const f=_r(c,i);f&&o.push(ys(a,f));break}else break}return o.length>0?[E(d({},t),{parts:o})]:[]}function Bl(t,e){return!t||typeof t!="object"?[]:Ll(t)?Ul(t,e):Fl(t)?jl(t,e):[]}function Gl(t,e){if(!Array.isArray(t)||t.length===0||Le(t)<=e)return t;const r=t.map(Le);let s=0,i=t.length;for(let o=t.length-1;o>=0;o--){const a=r[o];if(a&&s+a>e)break;a&&(s+=a),i=o}if(i===t.length){const o=t[t.length-1];return Bl(o,e)}return t.slice(i)}function Hl(t){return Gl(t,Fi)}function ql(t){return _r(t,Fi)}function de(t){return t.includes("messages")?"messages":t.includes("completions")?"completions":t.includes("models")?"models":t.includes("chat")?"chat":t.split(".").pop()||"unknown"}function Fe(t){return`gen_ai.${de(t)}`}function Ui(t,e){return t?`${t}.${e}`:e}function gr(t,e,n,r,s){if(e!==void 0&&t.setAttributes({[an]:e}),n!==void 0&&t.setAttributes({[cn]:n}),e!==void 0||n!==void 0||r!==void 0||s!==void 0){const i=(e!=null?e:0)+(n!=null?n:0)+(r!=null?r:0)+(s!=null?s:0);t.setAttributes({[un]:i})}}function St(t){if(typeof t=="string")return ql(t);if(Array.isArray(t)){const e=Hl(t);return JSON.stringify(e)}return JSON.stringify(t)}const zl="OpenAI",Wl=["responses.create","chat.completions.create","embeddings.create"],Jl=["response.output_item.added","response.function_call_arguments.delta","response.function_call_arguments.done","response.output_item.done"],Vl=["response.created","response.in_progress","response.failed","response.completed","response.incomplete","response.queued","response.output_text.delta",...Jl];function hr(t){return t.includes("chat.completions")?bn.CHAT:t.includes("responses")?bn.RESPONSES:t.includes("embeddings")?bn.EMBEDDINGS:t.split(".").pop()||"unknown"}function Ss(t){return`gen_ai.${hr(t)}`}function Yl(t){return Wl.includes(t)}function Kl(t,e){return t?`${t}.${e}`:e}function Xl(t){return t!==null&&typeof t=="object"&&"object"in t&&t.object==="chat.completion"}function Zl(t){return t!==null&&typeof t=="object"&&"object"in t&&t.object==="response"}function Ql(t){if(t===null||typeof t!="object"||!("object"in t))return!1;const e=t;return e.object==="list"&&typeof e.model=="string"&&e.model.toLowerCase().includes("embedding")}function tf(t){return t!==null&&typeof t=="object"&&"type"in t&&typeof t.type=="string"&&t.type.startsWith("response.")}function ef(t){return t!==null&&typeof t=="object"&&"object"in t&&t.object==="chat.completion.chunk"}function nf(t,e,n){if(yr(t,e.id,e.model,e.created),e.usage&&fn(t,e.usage.prompt_tokens,e.usage.completion_tokens,e.usage.total_tokens),Array.isArray(e.choices)){const r=e.choices.map(s=>s.finish_reason).filter(s=>s!==null);if(r.length>0&&t.setAttributes({[zt]:JSON.stringify(r)}),n){const s=e.choices.map(i=>{var o;return(o=i.message)==null?void 0:o.tool_calls}).filter(i=>Array.isArray(i)&&i.length>0).flat();s.length>0&&t.setAttributes({[dt]:JSON.stringify(s)})}}}function rf(t,e,n){if(yr(t,e.id,e.model,e.created_at),e.status&&t.setAttributes({[zt]:JSON.stringify([e.status])}),e.usage&&fn(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.total_tokens),n){const r=e;if(Array.isArray(r.output)&&r.output.length>0){const s=r.output.filter(i=>typeof i=="object"&&i!==null&&i.type==="function_call");s.length>0&&t.setAttributes({[dt]:JSON.stringify(s)})}}}function sf(t,e){t.setAttributes({[Li]:e.model,[Wt]:e.model}),e.usage&&fn(t,e.usage.prompt_tokens,void 0,e.usage.total_tokens)}function fn(t,e,n,r){e!==void 0&&t.setAttributes({[Dl]:e,[an]:e}),n!==void 0&&t.setAttributes({[xl]:n,[cn]:n}),r!==void 0&&t.setAttributes({[un]:r})}function yr(t,e,n,r){t.setAttributes({[wl]:e,[fe]:e}),t.setAttributes({[Li]:n,[Wt]:n}),t.setAttributes({[Pl]:new Date(r*1e3).toISOString()})}function of(t,e){for(const n of t){const r=n.index;if(!(r===void 0||!n.function))if(!(r in e.chatCompletionToolCalls))e.chatCompletionToolCalls[r]=E(d({},n),{function:{name:n.function.name,arguments:n.function.arguments||""}});else{const s=e.chatCompletionToolCalls[r];n.function.arguments&&(s!=null&&s.function)&&(s.function.arguments+=n.function.arguments)}}}function af(t,e,n){var r,s,i,o,a,c;e.responseId=(r=t.id)!=null?r:e.responseId,e.responseModel=(s=t.model)!=null?s:e.responseModel,e.responseTimestamp=(i=t.created)!=null?i:e.responseTimestamp,t.usage&&(e.promptTokens=t.usage.prompt_tokens,e.completionTokens=t.usage.completion_tokens,e.totalTokens=t.usage.total_tokens);for(const u of(o=t.choices)!=null?o:[])n&&((a=u.delta)!=null&&a.content&&e.responseTexts.push(u.delta.content),(c=u.delta)!=null&&c.tool_calls&&of(u.delta.tool_calls,e)),u.finish_reason&&e.finishReasons.push(u.finish_reason)}function cf(t,e,n,r){var i,o,a;if(!(t&&typeof t=="object")){e.eventTypes.push("unknown:non-object");return}if(t instanceof Error){r.setStatus({code:k,message:"internal_error"}),x(t,{mechanism:{handled:!1,type:"auto.ai.openai.stream-response"}});return}if(!("type"in t))return;const s=t;if(!Vl.includes(s.type)){e.eventTypes.push(s.type);return}if(n&&(s.type==="response.output_item.done"&&"item"in s&&e.responsesApiToolCalls.push(s.item),s.type==="response.output_text.delta"&&"delta"in s&&s.delta)){e.responseTexts.push(s.delta);return}if("response"in s){const{response:c}=s;e.responseId=(i=c.id)!=null?i:e.responseId,e.responseModel=(o=c.model)!=null?o:e.responseModel,e.responseTimestamp=(a=c.created_at)!=null?a:e.responseTimestamp,c.usage&&(e.promptTokens=c.usage.input_tokens,e.completionTokens=c.usage.output_tokens,e.totalTokens=c.usage.total_tokens),c.status&&e.finishReasons.push(c.status),n&&c.output_text&&e.responseTexts.push(c.output_text)}}function uf(t,e,n){return ye(this,null,function*(){const r={eventTypes:[],responseTexts:[],finishReasons:[],responseId:"",responseModel:"",responseTimestamp:0,promptTokens:void 0,completionTokens:void 0,totalTokens:void 0,chatCompletionToolCalls:{},responsesApiToolCalls:[]};try{try{for(var s=Se(t),i,o,a;i=!(o=yield new it(s.next())).done;i=!1){const c=o.value;ef(c)?af(c,r,n):tf(c)&&cf(c,r,n,e),yield c}}catch(o){a=[o]}finally{try{i&&(o=s.return)&&(yield new it(o.call(s)))}finally{if(a)throw a[0]}}}finally{yr(e,r.responseId,r.responseModel,r.responseTimestamp),fn(e,r.promptTokens,r.completionTokens,r.totalTokens),e.setAttributes({[ln]:!0}),r.finishReasons.length&&e.setAttributes({[zt]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length&&e.setAttributes({[Y]:r.responseTexts.join("")});const u=[...Object.values(r.chatCompletionToolCalls),...r.responsesApiToolCalls];u.length>0&&e.setAttributes({[dt]:JSON.stringify(u)}),e.end()}})}function lf(t,e){var r;const n={[ur]:"openai",[pr]:hr(e),[D]:"auto.ai.openai"};if(t.length>0&&typeof t[0]=="object"&&t[0]!==null){const s=t[0],i=Array.isArray(s.tools)?s.tools:[],a=s.web_search_options&&typeof s.web_search_options=="object"?[d({type:"web_search_options"},s.web_search_options)]:[],c=[...i,...a];c.length>0&&(n[mr]=JSON.stringify(c))}if(t.length>0&&typeof t[0]=="object"&&t[0]!==null){const s=t[0];n[z]=(r=s.model)!=null?r:"unknown","temperature"in s&&(n[lr]=s.temperature),"top_p"in s&&(n[dr]=s.top_p),"frequency_penalty"in s&&(n[fr]=s.frequency_penalty),"presence_penalty"in s&&(n[Di]=s.presence_penalty),"stream"in s&&(n[Pi]=s.stream),"encoding_format"in s&&(n[Ml]=s.encoding_format),"dimensions"in s&&(n[Cl]=s.dimensions)}else n[z]="unknown";return n}function ff(t,e,n){var s;if(!e||typeof e!="object")return;const r=e;if(Xl(r)){if(nf(t,r,n),n&&((s=r.choices)!=null&&s.length)){const i=r.choices.map(o=>{var a;return((a=o.message)==null?void 0:a.content)||""});t.setAttributes({[Y]:JSON.stringify(i)})}}else Zl(r)?(rf(t,r,n),n&&r.output_text&&t.setAttributes({[Y]:r.output_text})):Ql(r)&&sf(t,r)}function Es(t,e){if("messages"in e){const n=St(e.messages);t.setAttributes({[yt]:n})}if("input"in e){const n=St(e.input);t.setAttributes({[yt]:n})}}function df(){var s,i,o,a;const e=O().getClient(),n=e==null?void 0:e.getIntegrationByName(zl),r=n?!!(e!=null&&e.getOptions().sendDefaultPii):!1;return{recordInputs:(i=(s=n==null?void 0:n.options)==null?void 0:s.recordInputs)!=null?i:r,recordOutputs:(a=(o=n==null?void 0:n.options)==null?void 0:o.recordOutputs)!=null?a:r}}function pf(t,e,n,r){return function(...i){return F(this,null,function*(){const o=r||df(),a=lf(i,e),c=a[z]||"unknown",u=hr(e),f=i[0];return f&&typeof f=="object"&&f.stream===!0?ie({name:`${u} ${c} stream-response`,op:Ss(e),attributes:a},m=>F(null,null,function*(){var l;try{o.recordInputs&&i[0]&&typeof i[0]=="object"&&Es(m,i[0]);const _=yield t.apply(n,i);return uf(_,m,(l=o.recordOutputs)!=null?l:!1)}catch(_){throw m.setStatus({code:k,message:"internal_error"}),x(_,{mechanism:{handled:!1,type:"auto.ai.openai.stream",data:{function:e}}}),m.end(),_}})):Gt({name:`${u} ${c}`,op:Ss(e),attributes:a},m=>F(null,null,function*(){try{o.recordInputs&&i[0]&&typeof i[0]=="object"&&Es(m,i[0]);const l=yield t.apply(n,i);return ff(m,l,o.recordOutputs),l}catch(l){throw x(l,{mechanism:{handled:!1,type:"auto.ai.openai",data:{function:e}}}),l}}))})}}function ji(t,e="",n){return new Proxy(t,{get(r,s){const i=r[s],o=Kl(e,String(s));return typeof i=="function"&&Yl(o)?pf(i,o,r,n):typeof i=="function"?i.bind(r):i&&typeof i=="object"?ji(i,o,n):i}})}function mf(t,e){return ji(t,"",e)}function _f(t,e){var n,r;return"type"in t&&typeof t.type=="string"&&t.type==="error"?(e.setStatus({code:k,message:(r=(n=t.error)==null?void 0:n.type)!=null?r:"internal_error"}),x(t.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}),!0):!1}function gf(t,e){if(t.type==="message_delta"&&t.usage&&"output_tokens"in t.usage&&typeof t.usage.output_tokens=="number"&&(e.completionTokens=t.usage.output_tokens),t.message){const n=t.message;n.id&&(e.responseId=n.id),n.model&&(e.responseModel=n.model),n.stop_reason&&e.finishReasons.push(n.stop_reason),n.usage&&(typeof n.usage.input_tokens=="number"&&(e.promptTokens=n.usage.input_tokens),typeof n.usage.cache_creation_input_tokens=="number"&&(e.cacheCreationInputTokens=n.usage.cache_creation_input_tokens),typeof n.usage.cache_read_input_tokens=="number"&&(e.cacheReadInputTokens=n.usage.cache_read_input_tokens))}}function hf(t,e){t.type!=="content_block_start"||typeof t.index!="number"||!t.content_block||(t.content_block.type==="tool_use"||t.content_block.type==="server_tool_use")&&(e.activeToolBlocks[t.index]={id:t.content_block.id,name:t.content_block.name,inputJsonParts:[]})}function yf(t,e,n){if(!(t.type!=="content_block_delta"||!t.delta)){if(typeof t.index=="number"&&"partial_json"in t.delta&&typeof t.delta.partial_json=="string"){const r=e.activeToolBlocks[t.index];r&&r.inputJsonParts.push(t.delta.partial_json)}n&&typeof t.delta.text=="string"&&e.responseTexts.push(t.delta.text)}}function Sf(t,e){if(t.type!=="content_block_stop"||typeof t.index!="number")return;const n=e.activeToolBlocks[t.index];if(!n)return;const r=n.inputJsonParts.join("");let s;try{s=r?JSON.parse(r):{}}catch(i){s={__unparsed:r}}e.toolCalls.push({type:"tool_use",id:n.id,name:n.name,input:s}),delete e.activeToolBlocks[t.index]}function Bi(t,e,n,r){!(t&&typeof t=="object")||_f(t,r)||(gf(t,e),hf(t,e),yf(t,e,n),Sf(t,e))}function Ef(t,e,n){e.isRecording()&&(t.responseId&&e.setAttributes({[fe]:t.responseId}),t.responseModel&&e.setAttributes({[Wt]:t.responseModel}),gr(e,t.promptTokens,t.completionTokens,t.cacheCreationInputTokens,t.cacheReadInputTokens),e.setAttributes({[ln]:!0}),t.finishReasons.length>0&&e.setAttributes({[zt]:JSON.stringify(t.finishReasons)}),n&&t.responseTexts.length>0&&e.setAttributes({[Y]:t.responseTexts.join("")}),n&&t.toolCalls.length>0&&e.setAttributes({[dt]:JSON.stringify(t.toolCalls)}),e.end())}function bf(t,e,n){return ye(this,null,function*(){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};try{try{for(var s=Se(t),i,o,a;i=!(o=yield new it(s.next())).done;i=!1){const c=o.value;Bi(c,r,n,e),yield c}}catch(o){a=[o]}finally{try{i&&(o=s.return)&&(yield new it(o.call(s)))}finally{if(a)throw a[0]}}}finally{r.responseId&&e.setAttributes({[fe]:r.responseId}),r.responseModel&&e.setAttributes({[Wt]:r.responseModel}),gr(e,r.promptTokens,r.completionTokens,r.cacheCreationInputTokens,r.cacheReadInputTokens),e.setAttributes({[ln]:!0}),r.finishReasons.length>0&&e.setAttributes({[zt]:JSON.stringify(r.finishReasons)}),n&&r.responseTexts.length>0&&e.setAttributes({[Y]:r.responseTexts.join("")}),n&&r.toolCalls.length>0&&e.setAttributes({[dt]:JSON.stringify(r.toolCalls)}),e.end()}})}function Tf(t,e,n){const r={responseTexts:[],finishReasons:[],responseId:"",responseModel:"",promptTokens:void 0,completionTokens:void 0,cacheCreationInputTokens:void 0,cacheReadInputTokens:void 0,toolCalls:[],activeToolBlocks:{}};return t.on("streamEvent",s=>{Bi(s,r,n,e)}),t.on("message",()=>{Ef(r,e,n)}),t.on("error",s=>{x(s,{mechanism:{handled:!1,type:"auto.ai.anthropic.stream_error"}}),e.isRecording()&&(e.setStatus({code:k,message:"stream_error"}),e.end())}),t}const If=["messages.create","messages.stream","messages.countTokens","models.get","completions.create","models.retrieve","beta.messages.create"];function Af(t){return If.includes(t)}function Nf(t,e){e.error&&(t.setStatus({code:k,message:e.error.type||"internal_error"}),x(e.error,{mechanism:{handled:!1,type:"auto.ai.anthropic.anthropic_error"}}))}function Rf(t,e){var r;const n={[ur]:"anthropic",[pr]:de(e),[D]:"auto.ai.anthropic"};if(t.length>0&&typeof t[0]=="object"&&t[0]!==null){const s=t[0];s.tools&&Array.isArray(s.tools)&&(n[mr]=JSON.stringify(s.tools)),n[z]=(r=s.model)!=null?r:"unknown","temperature"in s&&(n[lr]=s.temperature),"top_p"in s&&(n[dr]=s.top_p),"stream"in s&&(n[Pi]=s.stream),"top_k"in s&&(n[$i]=s.top_k),"frequency_penalty"in s&&(n[fr]=s.frequency_penalty),"max_tokens"in s&&(n[xi]=s.max_tokens)}else e==="models.retrieve"||e==="models.get"?n[z]=t[0]:n[z]="unknown";return n}function Ln(t,e){if("messages"in e){const n=St(e.messages);t.setAttributes({[yt]:n})}if("input"in e){const n=St(e.input);t.setAttributes({[yt]:n})}"prompt"in e&&t.setAttributes({[vl]:JSON.stringify(e.prompt)})}function kf(t,e){if("content"in e&&Array.isArray(e.content)){t.setAttributes({[Y]:e.content.map(r=>r.text).filter(r=>!!r).join("")});const n=[];for(const r of e.content)(r.type==="tool_use"||r.type==="server_tool_use")&&n.push(r);n.length>0&&t.setAttributes({[dt]:JSON.stringify(n)})}"completion"in e&&t.setAttributes({[Y]:e.completion}),"input_tokens"in e&&t.setAttributes({[Y]:JSON.stringify(e.input_tokens)})}function Of(t,e){"id"in e&&"model"in e&&(t.setAttributes({[fe]:e.id,[Wt]:e.model}),"created"in e&&typeof e.created=="number"&&t.setAttributes({[hs]:new Date(e.created*1e3).toISOString()}),"created_at"in e&&typeof e.created_at=="number"&&t.setAttributes({[hs]:new Date(e.created_at*1e3).toISOString()}),"usage"in e&&e.usage&&gr(t,e.usage.input_tokens,e.usage.output_tokens,e.usage.cache_creation_input_tokens,e.usage.cache_read_input_tokens))}function vf(t,e,n){if(!(!e||typeof e!="object")){if("type"in e&&e.type==="error"){Nf(t,e);return}n&&kf(t,e),Of(t,e)}}function bs(t,e,n){throw x(t,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:n}}}),e.isRecording()&&(e.setStatus({code:k,message:"internal_error"}),e.end()),t}function Mf(t,e,n,r,s,i,o,a,c,u,f){var l;const p=(l=s[z])!=null?l:"unknown",m={name:`${i} ${p} stream-response`,op:Fe(o),attributes:s};return u&&!f?ie(m,_=>F(null,null,function*(){var y;try{c.recordInputs&&a&&Ln(_,a);const g=yield t.apply(n,r);return bf(g,_,(y=c.recordOutputs)!=null?y:!1)}catch(g){return bs(g,_,o)}})):ie(m,_=>{var y;try{c.recordInputs&&a&&Ln(_,a);const g=e.apply(n,r);return Tf(g,_,(y=c.recordOutputs)!=null?y:!1)}catch(g){return bs(g,_,o)}})}function Cf(t,e,n,r){return new Proxy(t,{apply(s,i,o){var l;const a=Rf(o,e),c=(l=a[z])!=null?l:"unknown",u=de(e),f=typeof o[0]=="object"?o[0]:void 0,p=!!(f!=null&&f.stream),m=e==="messages.stream";return p||m?Mf(t,s,n,o,a,u,e,f,r,p,m):Gt({name:`${u} ${c}`,op:Fe(e),attributes:a},_=>(r.recordInputs&&f&&Ln(_,f),nn(()=>s.apply(n,o),y=>{x(y,{mechanism:{handled:!1,type:"auto.ai.anthropic",data:{function:e}}})},()=>{},y=>vf(_,y,r.recordOutputs))))}})}function Gi(t,e="",n){return new Proxy(t,{get(r,s){const i=r[s],o=Ui(e,String(s));return typeof i=="function"&&Af(o)?Cf(i,o,r,n):typeof i=="function"?i.bind(r):i&&typeof i=="object"?Gi(i,o,n):i}})}function wf(t,e){var s;const n=!!((s=v())!=null&&s.getOptions().sendDefaultPii),r=d({recordInputs:n,recordOutputs:n},e);return Gi(t,"",r)}const Ts=["models.generateContent","models.generateContentStream","chats.create","sendMessage","sendMessageStream"],Pf="google_genai",Hi="chats.create",xf="chat";function Df(t,e){var r;const n=t==null?void 0:t.promptFeedback;if(n!=null&&n.blockReason){const s=(r=n.blockReasonMessage)!=null?r:n.blockReason;return e.setStatus({code:k,message:`Content blocked: ${s}`}),x(`Content blocked: ${s}`,{mechanism:{handled:!1,type:"auto.ai.google_genai"}}),!0}return!1}function $f(t,e){typeof t.responseId=="string"&&(e.responseId=t.responseId),typeof t.modelVersion=="string"&&(e.responseModel=t.modelVersion);const n=t.usageMetadata;n&&(typeof n.promptTokenCount=="number"&&(e.promptTokens=n.promptTokenCount),typeof n.candidatesTokenCount=="number"&&(e.completionTokens=n.candidatesTokenCount),typeof n.totalTokenCount=="number"&&(e.totalTokens=n.totalTokenCount))}function Lf(t,e,n){var r,s,i;Array.isArray(t.functionCalls)&&e.toolCalls.push(...t.functionCalls);for(const o of(r=t.candidates)!=null?r:[]){o!=null&&o.finishReason&&!e.finishReasons.includes(o.finishReason)&&e.finishReasons.push(o.finishReason);for(const a of(i=(s=o==null?void 0:o.content)==null?void 0:s.parts)!=null?i:[])n&&a.text&&e.responseTexts.push(a.text),a.functionCall&&e.toolCalls.push({type:"function",id:a.functionCall.id,name:a.functionCall.name,arguments:a.functionCall.args})}}function Ff(t,e,n,r){!t||Df(t,r)||($f(t,e),Lf(t,e,n))}function Uf(t,e,n){return ye(this,null,function*(){const r={responseTexts:[],finishReasons:[],toolCalls:[]};try{try{for(var s=Se(t),i,o,a;i=!(o=yield new it(s.next())).done;i=!1){const c=o.value;Ff(c,r,n,e),yield c}}catch(o){a=[o]}finally{try{i&&(o=s.return)&&(yield new it(o.call(s)))}finally{if(a)throw a[0]}}}finally{const c={[ln]:!0};r.responseId&&(c[fe]=r.responseId),r.responseModel&&(c[Wt]=r.responseModel),r.promptTokens!==void 0&&(c[an]=r.promptTokens),r.completionTokens!==void 0&&(c[cn]=r.completionTokens),r.totalTokens!==void 0&&(c[un]=r.totalTokens),r.finishReasons.length&&(c[zt]=JSON.stringify(r.finishReasons)),n&&r.responseTexts.length&&(c[Y]=r.responseTexts.join("")),n&&r.toolCalls.length&&(c[dt]=JSON.stringify(r.toolCalls)),e.setAttributes(c),e.end()}})}function jf(t){if(Ts.includes(t))return!0;const e=t.split(".").pop();return Ts.includes(e)}function Bf(t){return t.includes("Stream")||t.endsWith("generateContentStream")||t.endsWith("sendMessageStream")}function Is(t,e){if("model"in t&&typeof t.model=="string")return t.model;if(e&&typeof e=="object"){const n=e;if("model"in n&&typeof n.model=="string")return n.model;if("modelVersion"in n&&typeof n.modelVersion=="string")return n.modelVersion}return"unknown"}function Gf(t){const e={};return"temperature"in t&&typeof t.temperature=="number"&&(e[lr]=t.temperature),"topP"in t&&typeof t.topP=="number"&&(e[dr]=t.topP),"topK"in t&&typeof t.topK=="number"&&(e[$i]=t.topK),"maxOutputTokens"in t&&typeof t.maxOutputTokens=="number"&&(e[xi]=t.maxOutputTokens),"frequencyPenalty"in t&&typeof t.frequencyPenalty=="number"&&(e[fr]=t.frequencyPenalty),"presencePenalty"in t&&typeof t.presencePenalty=="number"&&(e[Di]=t.presencePenalty),e}function Hf(t,e,n){const r={[ur]:Pf,[pr]:de(t),[D]:"auto.ai.google_genai"};if(e){if(r[z]=Is(e,n),"config"in e&&typeof e.config=="object"&&e.config){const s=e.config;if(Object.assign(r,Gf(s)),"tools"in s&&Array.isArray(s.tools)){const i=s.tools.flatMap(o=>o.functionDeclarations);r[mr]=JSON.stringify(i)}}}else r[z]=Is({},n);return r}function As(t,e){if("contents"in e){const n=e.contents,r=St(n);t.setAttributes({[yt]:r})}if("message"in e){const n=e.message,r=St(n);t.setAttributes({[yt]:r})}if("history"in e){const n=e.history,r=St(n);t.setAttributes({[yt]:r})}}function qf(t,e,n){if(!(!e||typeof e!="object")){if(e.usageMetadata&&typeof e.usageMetadata=="object"){const r=e.usageMetadata;typeof r.promptTokenCount=="number"&&t.setAttributes({[an]:r.promptTokenCount}),typeof r.candidatesTokenCount=="number"&&t.setAttributes({[cn]:r.candidatesTokenCount}),typeof r.totalTokenCount=="number"&&t.setAttributes({[un]:r.totalTokenCount})}if(n&&Array.isArray(e.candidates)&&e.candidates.length>0){const r=e.candidates.map(s=>{var i;return(i=s.content)!=null&&i.parts&&Array.isArray(s.content.parts)?s.content.parts.map(o=>typeof o.text=="string"?o.text:"").filter(o=>o.length>0).join(""):""}).filter(s=>s.length>0);r.length>0&&t.setAttributes({[Y]:r.join("")})}if(n&&e.functionCalls){const r=e.functionCalls;Array.isArray(r)&&r.length>0&&t.setAttributes({[dt]:JSON.stringify(r)})}}}function Ns(t,e,n,r){const s=e===Hi;return new Proxy(t,{apply(i,o,a){var m;const c=a[0],u=Hf(e,c,n),f=(m=u[z])!=null?m:"unknown",p=de(e);return Bf(e)?ie({name:`${p} ${f} stream-response`,op:Fe(e),attributes:u},l=>F(null,null,function*(){try{r.recordInputs&&c&&As(l,c);const _=yield i.apply(n,a);return Uf(_,l,!!r.recordOutputs)}catch(_){throw l.setStatus({code:k,message:"internal_error"}),x(_,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}}),l.end(),_}})):Gt({name:s?`${p} ${f} create`:`${p} ${f}`,op:Fe(e),attributes:u},l=>(r.recordInputs&&c&&As(l,c),nn(()=>i.apply(n,a),_=>{x(_,{mechanism:{handled:!1,type:"auto.ai.google_genai",data:{function:e}}})},()=>{},_=>{s||qf(l,_,r.recordOutputs)})))}})}function Fn(t,e="",n){return new Proxy(t,{get:(r,s,i)=>{const o=Reflect.get(r,s,i),a=Ui(e,String(s));if(typeof o=="function"&&jf(a)){if(a===Hi){const c=Ns(o,a,r,n);return function(...f){const p=c(...f);return p&&typeof p=="object"?Fn(p,xf,n):p}}return Ns(o,a,r,n)}return typeof o=="function"?o.bind(r):o&&typeof o=="object"?Fn(o,a,n):o}})}function zf(t,e){var s;const n=!!((s=v())!=null&&s.getOptions().sendDefaultPii),r=d({recordInputs:n,recordOutputs:n},e);return Fn(t,"",r)}const qi="sentry.javascript.miniapp",Un="10.27.0-rc.3",Oe="?",Wf=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Jf=/\((\S*)(?::(\d+))(?::(\d+))\)/,Vf=/^\s*at (.*?) ?\((\S*):(\d+):(\d+)\)/i;function Sr(t){let e=null;const n=t&&t.framesToPop;try{if(e=Kf(t),e)return Rs(e,n)}catch(r){}try{if(e=Yf(t),e)return Rs(e,n)}catch(r){}return{message:Er(t),name:t&&t.name,stack:[],failed:!0}}function Yf(t){if(!t||!t.stack)return null;const e=[],n=t.stack.split(`
`);let r,s,i,o;for(let a=0;a<n.length;++a){if(i=Wf.exec(n[a])){const c=i[2]&&i[2].indexOf("native")===0;r=i[2]&&i[2].indexOf("eval")===0,r&&(s=Jf.exec(i[2]))&&(i[2]=s[1],i[3]=s[2],i[4]=s[3]),o={url:i[2],func:i[1]||Oe,args:c?[i[2]]:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null}}else if(i=Vf.exec(n[a]))o={url:i[2],func:i[1]||Oe,args:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null};else continue;!o.func&&o.line&&(o.func=Oe),e.push(o)}return e.length?{message:Er(t),name:t.name,stack:e}:null}function Kf(t){if(!t||!t.stacktrace)return null;const e=t.stacktrace,n=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,r=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,s=e.split(`
`),i=[];let o;for(let a=0;a<s.length;a+=2){let c=null;(o=n.exec(s[a]))?c={url:o[2],func:o[3],args:[],line:+o[1],column:null}:(o=r.exec(s[a]))&&(c={url:o[6],func:o[3]||o[4],args:o[5]?o[5].split(","):[],line:+o[1],column:+o[2]}),c&&(!c.func&&c.line&&(c.func=Oe),i.push(c))}return i.length?{message:Er(t),name:t.name,stack:i}:null}function Rs(t,e){try{return E(d({},t),{stack:t.stack.slice(e)})}catch(n){return t}}function Er(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}const Xf=100;function br(t){const e=Sr(t),n=Tr(e.stack),r={type:Zf(t),value:Qf(t)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function Zf(t){const e=t==null?void 0:t.name;return!e&&zi(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function Qf(t){const e=t==null?void 0:t.message;return zi(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function zi(t){return typeof WebAssembly!="undefined"&&typeof WebAssembly.Exception!="undefined"?t instanceof WebAssembly.Exception:!1}function td(t,e,n){const r=v(),s=r==null?void 0:r.getOptions().normalizeDepth,i=od(t),o={__serialized__:si(t,s)};if(i)return{exception:{values:[br(i)]},extra:o};const a={exception:{values:[{type:Ke(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:sd(t,{isUnhandledRejection:n})}]},extra:o};if(e){const c=Sr(e),u=Tr(c.stack);u.length&&(a.exception.values[0].stacktrace={frames:u})}return a}function Tn(t){return{exception:{values:[br(t)]}}}function ed(t,e,n){const r=(e==null?void 0:e.syntheticException)||void 0,s=rd(t,r,n);return ct(s),s.level="error",e!=null&&e.event_id&&(s.event_id=e.event_id),Ht(s)}function nd(t,e="info",n,r){const s=(n==null?void 0:n.syntheticException)||void 0,i=jn(t,s,r);return i.level=e,n!=null&&n.event_id&&(i.event_id=n.event_id),Ht(i)}function rd(t,e,n,r){let s;if(xs(t)&&t.error)return Tn(t.error);if(Mr(t)||yo(t)){const i=t;if("stack"in t)s=Tn(t);else{const o=i.name||(Mr(i)?"DOMError":"DOMException"),a=i.message?`${o}: ${i.message}`:o;s=jn(a,e,n),In(s,a)}return"code"in i&&(s.tags=E(d({},s.tags),{"DOMException.code":`${i.code}`})),s}return _t(t)?Tn(t):Et(t)||Ke(t)?(s=td(t,e,r),ct(s,{synthetic:!0}),s):(s=jn(t,e,n),In(s,`${t}`),ct(s,{synthetic:!0}),s)}function jn(t,e,n){const r={};if(n&&e){const s=Sr(e),i=Tr(s.stack);i.length&&(r.exception={values:[{value:t,stacktrace:{frames:i}}]}),ct(r,{synthetic:!0})}if(Ye(t)){const{__sentry_template_string__:s,__sentry_template_values__:i}=t;return r.logentry={message:s,params:i},r}return r.message=t,r}function sd(t,{isUnhandledRejection:e}){const n=Ro(t),r="exception";return xs(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Ke(t)?`Event \`${id(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function id(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch(e){}}function od(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}function Tr(t){if(!t||!t.length)return[];let e=t;const n=e[0].func||"",r=e[e.length-1].func||"";return(n.indexOf("captureMessage")!==-1||n.indexOf("captureException")!==-1)&&(e=e.slice(1)),r.indexOf("sentryWrapped")!==-1&&(e=e.slice(0,-1)),e.map(s=>({colno:s.column===null?void 0:s.column,filename:s.url||e[0].url,function:s.func||"?",in_app:!0,lineno:s.line===null?void 0:s.line})).slice(0,Xf).reverse()}const ad=()=>{let t={request:()=>{},httpRequest:()=>{},getSystemInfoSync:()=>{},getPerformance:()=>({}),onAppHide:function(e){},canIUse:function(e){return!1}};if(typeof wx=="object")t=wx;else if(typeof my=="object")t=my;else if(typeof tt=="object")t=tt;else if(typeof dd=="object")t=dd;else if(typeof qq=="object")t=qq;else if(typeof swan=="object")t=swan;else throw new Error("sentry-miniapp ");return t},cd=()=>{let t="unknown";return typeof wx=="object"?t="wechat":typeof my=="object"?t="alipay":typeof tt=="object"?t="bytedance":typeof dd=="object"?t="dingtalk":typeof qq=="object"?t="qq":typeof swan=="object"&&(t="swan"),t},C=ad(),Wi=cd(),ud="application/json";function Ir(t){function e(n){return new Pt((r,s)=>{const i=C.request||C.httpRequest;if(typeof i!="function"){s(new Error("Miniapp request function is not available"));return}i({url:t.url,method:"POST",data:n.body,header:{"content-type":ud},success(o){var a,c,u,f;r({statusCode:o==null?void 0:o.statusCode,headers:{"x-sentry-rate-limits":(c=(a=o==null?void 0:o.headers)==null?void 0:a["X-Sentry-Rate-Limits"])!=null?c:null,"retry-after":(f=(u=o==null?void 0:o.headers)==null?void 0:u["Retry-After"])!=null?f:null}})},fail(o){s(o)}})})}return Pc(t,e)}const ld=Object.freeze(Object.defineProperty({__proto__:null,makeMiniappTransport:Ir},Symbol.toStringTag,{value:"Module"})),fd=()=>[];class Ji extends Fc{constructor(e={}){const n=e.transport||Ir,r=e.stackParser||fd,s=e.integrations||e.defaultIntegrations||[],i=E(d({},e),{transport:n,stackParser:r,integrations:s,dsn:e.dsn,tracesSampleRate:e.tracesSampleRate});Kc(i,"miniapp",["miniapp"]),super(i)}_prepareEvent(e,n,r,s){return e.platform=e.platform||"javascript",e.sdk=E(d({},e.sdk),{name:qi,packages:[...e.sdk&&e.sdk.packages||[],{name:"npm:@sentry/miniapp",version:Un}],version:Un}),super._prepareEvent(e,n,r,s)}showReportDialog(e={}){console.log("sentry-miniapp ",e)}eventFromException(e,n){return ed(e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return nd(e,n,r,this._options.attachStacktrace)}}function pd(){setTimeout(()=>{})}function vt(t,e={},n){if(typeof t!="function")return t;try{const s=t.__sentry_wrapped__;if(s)return s;if(Ls(t))return t}catch(s){return t}const r=function(...s){try{const i=s.map(o=>vt(o,e));return t.handleEvent?t.handleEvent.apply(this,i):t.apply(this,i)}catch(i){throw pd(),rt(o=>{o.addEventProcessor(a=>{const c=d({},a);return e.mechanism&&(In(c,void 0),ct(c,e.mechanism)),c.extra=E(d({},c.extra),{arguments:H(s,3)}),c}),x(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch(s){}$s(r,t),W(t,"__sentry_wrapped__",r);try{const s=Object.getOwnPropertyDescriptor(r,"name");s!=null&&s.configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch(s){}return r}const We=class We{constructor(e){this.name=We.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._onPageNotFoundHandlerInstalled=!1,this._onMemoryWarningHandlerInstalled=!1,this._options=d({onerror:!0,onunhandledrejection:!0,onpagenotfound:!0,onmemorywarning:!0},e)}setupOnce(){Error.stackTraceLimit=50,this._options.onerror&&(h.log("Global Handler attached: onError"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(h.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler()),this._options.onpagenotfound&&(h.log("Global Handler attached: onPageNotFound"),this._installGlobalOnPageNotFoundHandler()),this._options.onmemorywarning&&(h.log("Global Handler attached: onMemoryWarning"),this._installGlobalOnMemoryWarningHandler())}_installGlobalOnErrorHandler(){this._onErrorHandlerInstalled||(C.onError&&C.onError(e=>{const n=typeof e=="string"?new Error(e):e;x(n)}),this._onErrorHandlerInstalled=!0)}_installGlobalOnUnhandledRejectionHandler(){this._onUnhandledRejectionHandlerInstalled||(C.onUnhandledRejection&&C.onUnhandledRejection(({reason:e,promise:n})=>{const r=typeof e=="string"?new Error(e):e;x(r,{data:n})}),this._onUnhandledRejectionHandlerInstalled=!0)}_installGlobalOnPageNotFoundHandler(){this._onPageNotFoundHandlerInstalled||(C.onPageNotFound&&C.onPageNotFound(e=>{const n=e.path.split("?")[0];xn("pagenotfound",n),Pn("message",JSON.stringify(e)),wn(`: ${n}`)}),this._onPageNotFoundHandlerInstalled=!0)}_installGlobalOnMemoryWarningHandler(){this._onMemoryWarningHandlerInstalled||(C.onMemoryWarning&&C.onMemoryWarning(({level:e=-1})=>{let n="";switch(e){case 5:n="TRIM_MEMORY_RUNNING_MODERATE";break;case 10:n="TRIM_MEMORY_RUNNING_LOW";break;case 15:n="TRIM_MEMORY_RUNNING_CRITICAL";break;default:return}xn("memory-warning",String(e)),Pn("message",n),wn("")}),this._onMemoryWarningHandlerInstalled=!0)}};We.id="GlobalHandlers";let Ue=We;const Je=class Je{constructor(){this._ignoreOnError=0,this.name=Je.id}_wrapTimeFunction(e){return function(...n){const r=n[0];return n[0]=vt(r,{mechanism:{data:{function:Ie(e)},handled:!0,type:"instrument"}}),e.apply(this,n)}}_wrapRAF(e){return function(n){return e(vt(n,{mechanism:{data:{function:"requestAnimationFrame",handler:Ie(e)},handled:!0,type:"instrument"}}))}}_wrapEventTarget(e){const n=T,r=n[e]&&n[e].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(pt(r,"addEventListener",function(s){return function(i,o,a){try{typeof o.handleEvent=="function"&&(o.handleEvent=vt(o.handleEvent.bind(o),{mechanism:{data:{function:"handleEvent",handler:Ie(o),target:e},handled:!0,type:"instrument"}}))}catch(c){}return s.call(this,i,vt(o,{mechanism:{data:{function:"addEventListener",handler:Ie(o),target:e},handled:!0,type:"instrument"}}),a)}}),pt(r,"removeEventListener",function(s){return function(i,o,a){let c=o;try{c=c&&(c.__sentry_wrapped__||c)}catch(u){}return s.call(this,i,c,a)}}))}setupOnce(){this._ignoreOnError=this._ignoreOnError;const e=T;pt(e,"setTimeout",this._wrapTimeFunction.bind(this)),pt(e,"setInterval",this._wrapTimeFunction.bind(this)),pt(e,"requestAnimationFrame",this._wrapRAF.bind(this)),["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))}};Je.id="TryCatch";let je=Je;function Ie(t){try{return t&&t.name||"<anonymous>"}catch(e){return"<anonymous>"}}const md="cause",_d=5,Zt=class Zt{constructor(e={}){this.name=Zt.id,this._key=e.key||md,this._limit=e.limit||_d}setupOnce(){le((e,n)=>{const r=v(),s=r&&r.getIntegrationByName(Zt.id);return s?s._handler(e,n):e})}_handler(e,n){if(!e.exception||!e.exception.values||!n||!(n.originalException instanceof Error))return e;const r=this._walkErrorTree(n.originalException,this._key);return e.exception.values=[...r,...e.exception.values],e}_walkErrorTree(e,n,r=[]){if(!(e[n]instanceof Error)||r.length+1>=this._limit)return r;const s=br(e[n]);return this._walkErrorTree(e[n],n,[s,...r])}};Zt.id="LinkedErrors";let Be=Zt;const Qt=class Qt{constructor(){this.name=Qt.id}setupOnce(){le(e=>{const n=v();if(n&&n.getIntegrationByName(Qt.id))try{const s=C.getSystemInfoSync(),{SDKVersion:i="0.0.0",batteryLevel:o,currentBattery:a,battery:c,brand:u,language:f,model:p,pixelRatio:m,platform:l,screenHeight:_,screenWidth:y,system:g,version:A,app:I,appName:N}=s,[w,$]=g.split(" "),L=E(d({},e.tags),{SDKVersion:i}),b=I||N||Wi||"app";return E(d({},e),{tags:L,contexts:E(d({},e.contexts),{device:{brand:u,battery_level:o||a||c,model:p,language:f,platform:l,screen_dpi:m,screen_height:_,screen_width:y},os:{name:w||g,version:$||g},browser:{name:b,version:A}})})}catch(s){console.warn(`sentry-miniapp get system info fail: ${s}`)}return e})}};Qt.id="System";let Ge=Qt;const te=class te{constructor(e){this.name=te.id,this._options=d({enable:!0},e)}setupOnce(){le(e=>{const n=v();if(n&&n.getIntegrationByName(te.id)&&this._options.enable)try{const s=getCurrentPages().map(i=>({route:i.route,options:i.options}));return E(d({},e),{extra:E(d({},e.extra),{routers:s})})}catch(s){console.warn(`sentry-miniapp get router info fail: ${s}`)}return e})}};te.id="Router";let He=te;const ee=class ee{constructor(){this.name=ee.id}setupOnce(){le(e=>{const n=v();return n&&n.getIntegrationByName(ee.id)&&Wi==="wechat"&&C.getLaunchOptionsSync&&C.getLaunchOptionsSync().scene===1129?null:e})}};ee.id="IgnoreMpcrawlerErrors";let qe=ee;const gd=Object.freeze(Object.defineProperty({__proto__:null,GlobalHandlers:Ue,IgnoreMpcrawlerErrors:qe,LinkedErrors:Be,Router:He,System:Ge,TryCatch:je},Symbol.toStringTag,{value:"Module"})),Vi=[ru(),tu(),new je,new Ue,new Be,new Ge,new He,new qe];function hd(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=Vi),t.normalizeDepth=t.normalizeDepth||5;const e=d({integrations:t.integrations||t.defaultIntegrations||[],stackParser:t.stackParser||(()=>[]),transport:t.transport||Ir},t);Hc(Ji,e)}function yd(t={}){t.eventId||(t.eventId=ui());const e=v();e&&e.showReportDialog(t)}function Sd(){return ui()}function Ed(t){const e=v();return e?e.flush(t):Ht(!1)}function bd(t){const e=v();return e?e.close(t):Ht(!1)}function Td(t){return vt(t)()}const ks=2147483647;function U(t){return typeof t=="number"&&isFinite(t)}function at(t){return t/1e3}function Kt(t,e,n,r){const s=R(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),ue(t,()=>{const i=tr(d({startTime:e},r));return i&&i.end(n),i})}function Id(t,e){return e.some(n=>typeof n=="string"?t===n:n.test(t))}class Ad{constructor(e=!1){this._reportAllChanges=e,this._measurements={},this._performanceCursor=0}addPerformanceEntries(e,n={}){var u;const r=this._getPerformance();if(!r)return;const s=this._getMiniProgramTimeOrigin(r);if(!s)return;const i=at(s),{op:o,start_timestamp:a}=R(e),c=((u=r.getEntries)==null?void 0:u.call(r))||[];c.slice(this._performanceCursor).forEach(f=>{const p=at(f.startTime),m=at(Math.max(0,f.duration));if(!(o==="navigation"&&a&&i+p<a)&&!this._shouldIgnoreEntry(f,n))switch(f.entryType){case"navigation":{this._addNavigationSpans(e,f,i);break}case"render":{this._addRenderSpan(e,f,p,m,i);break}case"script":{this._addScriptSpan(e,f,p,m,i);break}case"loadPackage":{this._addPackageSpan(e,f,p,m,i);break}case"resource":{this._addResourceSpan(e,f,p,m,i,n.ignoreResourceSpans);break}}}),this._performanceCursor=Math.max(c.length-1,0),this._trackSystemInfo(e),(o==="pageload"||o==="navigation")&&(e.setAttribute("performance.timeOrigin",i),Object.entries(this._measurements).forEach(([f,p])=>{oi(f,p.value,p.unit)})),this._measurements={}}addPerformanceEntriesFromSpan(e){this.addPerformanceEntries(e),this._stopObserver()}startObserving(e,n={}){var i;const r=this._getPerformance();if(!r)return;const s=R(e);this._timeOrigin=this._getTimeOrigin(r,s.start_timestamp),this._measurements={},this._performanceCursor=0,this._observer=(i=r.createObserver)==null?void 0:i.call(r,o=>{var u;const a=((u=o==null?void 0:o.getEntries)==null?void 0:u.call(o))||[],c=R(e);if(c.timestamp!==void 0){this._stopObserver();return}a.forEach(f=>this._handleEntry(e,f,c.start_timestamp,n))}),this._observer&&this._observer.observe({entryTypes:["navigation","render","script","loadPackage","resource"]})}_getPerformance(){if(!C.getPerformance)return;const e=C.getPerformance();if(e)return e}_getMiniProgramTimeOrigin(e){if(typeof e.timeOrigin=="number")return e.timeOrigin;const n=typeof e.now=="function"?e.now():void 0;if(typeof n=="number")return Date.now()-n}_getTimeOrigin(e,n){const r=this._getMiniProgramTimeOrigin(e);return r?at(r):n}_shouldIgnoreEntry(e,n){const{ignorePerformanceEntryNames:r=[]}=n;return r.length>0&&e.name?Id(e.name,r):!1}_handleEntry(e,n,r,s={}){var c;const i=(c=this._timeOrigin)!=null?c:r,o=at(n.startTime),a=at(Math.max(0,n.duration));if(!this._shouldIgnoreEntry(n,s)){switch(n.entryType){case"navigation":this._addNavigationSpans(e,n,i);break;case"render":this._addRenderSpan(e,n,o,a,i);break;case"script":this._addScriptSpan(e,n,o,a,i);break;case"loadPackage":this._addPackageSpan(e,n,o,a,i);break;case"resource":this._addResourceSpan(e,n,o,a,i,s.ignoreResourceSpans);break}this._recordMeasurements(n,r,i+o)}}_addNavigationSpans(e,n,r){const s=r+at(n.startTime),i=s+at(Math.max(0,n.duration)),o={[D]:"auto.ui.miniapp.metrics","performance.entry_type":n.entryType};n.path&&(o["navigation.path"]=n.path),n.referrerPath&&(o["navigation.referrer_path"]=n.referrerPath),U(n.viewLayerReadyTime)&&(o["navigation.view_layer_ready_time"]=n.viewLayerReadyTime),Kt(e,s,i,{name:n.path||n.name||"navigation",op:"browser.navigation",attributes:o}),U(n.duration)&&!this._measurements["navigation.duration"]&&(this._measurements["navigation.duration"]={value:n.duration,unit:"millisecond"}),U(n.viewLayerReadyTime)&&(this._measurements["navigation.view_layer_ready"]={value:n.viewLayerReadyTime,unit:"millisecond"})}_addRenderSpan(e,n,r,s,i){const o=i+r,a=o+s,c={[D]:"auto.ui.miniapp.metrics","performance.entry_type":n.entryType};n.path&&(c["ui.component_path"]=n.path),U(n.viewLayerReadyTime)&&(c["ui.view_layer_ready_time"]=n.viewLayerReadyTime),U(n.firstRenderTime)&&(c["ui.first_render_time"]=n.firstRenderTime),Kt(e,o,a,{name:n.path||n.name||"render",op:"ui.render",attributes:c}),U(n.firstRenderTime)&&(this._measurements["ui.first_render"]={value:n.firstRenderTime,unit:"millisecond"})}_addScriptSpan(e,n,r,s,i){const o=i+r,a=o+s,c={[D]:"auto.resource.miniapp.metrics","performance.entry_type":n.entryType};n.moduleName&&(c["code.filepath"]=n.moduleName),Kt(e,o,a,{name:n.moduleName||n.name||"script",op:"script",attributes:c})}_addPackageSpan(e,n,r,s,i){const o=i+r,a=o+s,c={[D]:"auto.resource.miniapp.metrics","performance.entry_type":n.entryType};n.packageName&&(c["resource.package_name"]=n.packageName),U(n.packageSize)&&n.packageSize<ks&&(c["resource.package_size"]=n.packageSize),Kt(e,o,a,{name:n.packageName||n.name||"loadPackage",op:"resource.package",attributes:c})}_addResourceSpan(e,n,r,s,i,o){if(n.initiatorType==="xmlhttprequest"||n.initiatorType==="fetch")return;const a=n.initiatorType?`resource.${n.initiatorType}`:"resource.other";if(o!=null&&o.includes(a))return;const c=i+r,u=c+s,f={[D]:"auto.resource.miniapp.metrics","performance.entry_type":n.entryType};n.initiatorType&&(f["resource.initiator_type"]=n.initiatorType),U(n.transferSize)&&n.transferSize<ks&&(f["http.response_transfer_size"]=n.transferSize),n.path&&(f["resource.path"]=n.path),Kt(e,c,u,{name:n.path||n.name||"resource",op:a,attributes:f})}_trackSystemInfo(e){if(C.getSystemInfoSync)try{const n=C.getSystemInfoSync();if(!n)return;n.networkType&&e.setAttribute("network.type",n.networkType),n.platform&&e.setAttribute("device.platform",n.platform),n.model&&e.setAttribute("device.model",n.model),n.system&&e.setAttribute("os.version",n.system),U(n.benchmarkLevel)&&e.setAttribute("device.benchmark_level",String(n.benchmarkLevel))}catch(n){}}_recordMeasurements(e,n,r){const s=(e.name||"").toLowerCase(),i=e.duration,o=Math.max((r-n)*1e3,0);if(s==="first-paint"||s==="firstpaint"?this._measurements.fp={value:o,unit:"millisecond"}:s==="first-contentful-paint"||s==="firstcontentfulpaint"?this._measurements.fcp={value:o,unit:"millisecond"}:s==="largest-contentful-paint"||s==="largestcontentfulpaint"||s==="lcp"?this._measurements.lcp={value:o,unit:"millisecond"}:(s==="first-input-delay"||s==="firstinputdelay"||s==="fid")&&U(i)&&(this._measurements.fid={value:i,unit:"millisecond"}),U(e.viewLayerReadyTime)&&!this._measurements.view_layer_ready&&(this._measurements.view_layer_ready={value:e.viewLayerReadyTime,unit:"millisecond"}),U(e.firstRenderTime)&&!this._measurements.first_render&&(this._measurements.first_render={value:e.firstRenderTime,unit:"millisecond"}),this._reportAllChanges&&U(i)){const a=this._measurementKey(e);a&&!this._measurements[a]&&(this._measurements[a]={value:i,unit:"millisecond"})}}_measurementKey(e){const n=e.name||e.entryType;if(n)return n.replace(/\s+/g,"_").toLowerCase()}_stopObserver(){var e;(e=this._observer)==null||e.disconnect(),this._observer=void 0}}const Nd={traceRequest:!0},j=typeof __SENTRY_DEBUG__=="undefined"?!0:__SENTRY_DEBUG__;function Yi(){const t=At(),e=t&&q(t);if(!e)return;const n=R(e).op;return n==="navigation"||n==="pageload"?e:void 0}function Ki(t){return{name:t.path||"unknown",source:"url"}}function Xi(t,e){const n={[D]:e};return t.openType&&(n["miniapp.open_type"]=t.openType),t.scene!==void 0&&(n["miniapp.scene"]=t.scene),t.isTabBar!==void 0&&(n["miniapp.is_tabbar"]=t.isTabBar),t.webviewId!==void 0&&(n["miniapp.webview_id"]=t.webviewId),t.query&&(n["miniapp.query"]=t.query),n}function Rd(t){return{path:(t==null?void 0:t.path)||(t==null?void 0:t.route)||(t==null?void 0:t.url)||"unknown-route",query:t==null?void 0:t.query,scene:t==null?void 0:t.scene,openType:t==null?void 0:t.openType,isTabBar:t==null?void 0:t.isTabBar,webviewId:t==null?void 0:t.webviewId,routeEventId:t==null?void 0:t.routeEventId,timeStamp:t==null?void 0:t.timeStamp}}function kd(t,e=!1){return!!(t==="appLaunch"||e)}function Zi(t,e){const{instrumentPageLoad:n=!0,instrumentNavigation:r=!0}=t,s=T,i=C.onAppRoute,o=C.onAppRouteDone,a=C.onBeforePageLoad,c=C.onAfterPageLoad;let u=!0,f=!1;if(n&&typeof s.getCurrentPages=="function"){const m=s.getCurrentPages()||[],l=m[m.length-1];if(l!=null&&l.route){f=!0,u=!1;const _={path:l.route,openType:"appLaunch"};Os(_,e)}}const p=m=>{const l=Rd(m),_=!f&&kd(l.openType,u);if(u&&(u=!1),_&&n){f=!0,Os(l,e);return}r&&f&&Od(l,e)};if(typeof i=="function")i(p),typeof o=="function"&&o(m=>{j&&h.log("[MiniAppTracing] Route done:",m==null?void 0:m.path)});else{j&&h.log("[MiniAppTracing] No route event API available, falling back to Page/Component instrumentation");const m=l=>{typeof s[l]=="function"&&pt(s,l,y=>function(g){if(g){const A=N=>function(...w){const[$]=w;if(setTimeout(()=>{var P;const L=((P=s.getCurrentPages)==null?void 0:P.call(s))||[],b=L[L.length-1];b&&p({path:b.route||b.__route__,query:$})},0),N)return N.apply(this,w)},I=N=>function(...w){if(setTimeout(()=>{var b;const $=((b=s.getCurrentPages)==null?void 0:b.call(s))||[],L=$[$.length-1];L&&p({path:L.route||L.__route__,query:L.options||{},openType:"navigateBack"})},0),N)return N.apply(this,w)};l==="Page"?(g.onLoad=A(g.onLoad),g.onUnload=I(g.onUnload)):l==="Component"&&g.methods&&(g.methods.onLoad&&(g.methods.onLoad=A(g.methods.onLoad)),g.methods.onUnload&&(g.methods.onUnload=I(g.methods.onUnload)))}return y.call(this,g)})};m("Page"),m("Component")}typeof a=="function"&&a(m=>{j&&h.log("[MiniAppTracing] onBeforePageLoad:",m==null?void 0:m.path)}),typeof c=="function"&&c(m=>{j&&h.log("[MiniAppTracing] onAfterPageLoad:",m==null?void 0:m.path)})}function Os(t,e,n){const{name:r,source:s}=Ki(t),i=Xi(t,"auto.pageload.miniapp");i[nt]=s;const o=Yi();o?((R(o).data||{})[nt]!=="custom"&&(o.updateName(r),o.setAttribute(nt,s)),o.setAttributes(i),j&&h.log(`[MiniAppTracing] Updated pageload span: ${r}`)):(O().setTransactionName(r),e({name:r,op:"pageload",attributes:i}),j&&h.log(`[MiniAppTracing] Created pageload span: ${r}`))}function Od(t,e,n){const{name:r,source:s}=Ki(t),i=Xi(t,"auto.navigation.miniapp");i[nt]=s,O().setTransactionName(r),e({name:r,op:"navigation",attributes:i}),j&&h.log(`[MiniAppTracing] Created navigation span: ${r}`)}function vd(){return Yi()}const Md=3600;let Mt,ze;function Cd(){return{traceId:ut(),spanId:jt(),sampleRand:Math.random()}}function wd(){return Mt||(Mt=Cd()),Mt}function Pd(t=!1){const e=Mt;return Mt={traceId:t&&e?e.traceId:ut(),spanId:jt(),sampleRand:Math.random()},Mt}function xd(){return ze}function Dd(t,e,n,r,s,i){ze={spanContext:{traceId:t,spanId:e,traceFlags:n?1:0},startTimestamp:r,sampleRate:s,sampleRand:i}}function $d(){return ze?Date.now()/1e3-ze.startTimestamp<=Md:!1}const Ld=1e3,Fd=3e4,Ud=15e3,jd="MiniAppTracing",Qi="_sentry_miniapp_idleSpan";function Ar(t){return t[Qi]}function vs(t,e){W(t,Qi,e)}const Bd=d({idleTimeout:Ld,finalTimeout:Fd,childSpanTimeout:Ud,instrumentPageLoad:!0,instrumentNavigation:!0,endSpanOnRouteComplete:!0,traceContinuityMode:"link",consistentTraceSampling:!1},Nd);function Gd(t={}){const e=d(d({},Bd),t),{idleTimeout:n,finalTimeout:r,childSpanTimeout:s,instrumentPageLoad:i,instrumentNavigation:o,traceContinuityMode:a,consistentTraceSampling:c,beforeStartSpan:u,_metricOptions:f,ignoreResourceSpans:p,ignorePerformanceEntryNames:m}=e,l={ignoreResourceSpans:p,ignorePerformanceEntryNames:m};let _,y,g;return{name:jd,setupOnce(){_=new Ad(f==null?void 0:f._reportAllChanges)},setup(A){var I;(I=C.onAppHide)==null||I.call(C,()=>{const N=Ar(A);N&&!R(N).timestamp&&(j&&h.log("[MiniAppTracing] App hiding, finishing active span"),N.setAttribute(Ce,"appHide"),N.end())})},afterAllSetup(A){Zi({instrumentPageLoad:i,instrumentNavigation:o},N=>{to(A,N,{idleTimeout:n,finalTimeout:r,childSpanTimeout:s,traceContinuityMode:a,consistentTraceSampling:c,beforeStartSpan:u,metricsInstrumentation:_,performanceEntriesOptions:l,latestRoute:{get name(){return y},set name(w){y=w},get source(){return g},set source(w){g=w}}})})}}}function to(t,e,n){const{idleTimeout:r,finalTimeout:s,childSpanTimeout:i,traceContinuityMode:o,consistentTraceSampling:a,beforeStartSpan:c,metricsInstrumentation:u,performanceEntriesOptions:f,latestRoute:p}=n;Hd(t);const m=qd(o,a),l=c?c(e):e;m&&m.length>0&&(l.links=[...l.links||[],...m]);const _=l.attributes||{};p.name=l.name,p.source=_[nt];const y=Da(l,{idleTimeout:r,finalTimeout:s,childSpanTimeout:i,beforeSpanEnd:g=>{var w;u==null||u.addPerformanceEntries(g,f),vs(t,void 0);const A=O(),I=A.getPropagationContext();A.setPropagationContext(E(d({},I),{traceId:g.spanContext().traceId,sampled:Tt(g),dsc:lt(g)}));const N=R(g);Dd(g.spanContext().traceId,g.spanContext().spanId,Tt(g),N.start_timestamp,1,(w=I.sampleRand)!=null?w:Math.random()),j&&h.log(`[MiniAppTracing] Span ended: ${N.op} - ${N.description}, traceId=${g.spanContext().traceId}`)}});return y.setAttribute("miniapp.trace_continuity_mode",o),vs(t,y),j&&h.log(`[MiniAppTracing] Started ${e.op} span: ${e.name}, traceId=${y.spanContext().traceId}`),y}function Hd(t){const e=Ar(t);e&&!R(e).timestamp&&(j&&h.log(`[MiniAppTracing] Finishing current active span with op: ${R(e).op}`),e.setAttribute(Ce,"navigationStart"),e.end())}function qd(t,e){var s;if(t==="off"){O().setPropagationContext({traceId:ut(),sampleRand:Math.random()});return}const n=xd(),r=$d();if(t==="session"){const i=wd();O().setPropagationContext(d({traceId:i.traceId,sampleRand:i.sampleRand},e&&r&&n&&{sampled:n.spanContext.traceFlags===1})),j&&h.log(`[MiniAppTracing] Session mode: reusing traceId=${i.traceId}`);return}if(t==="link"){const i=Pd(!1);if(O().setPropagationContext(d({traceId:i.traceId,sampleRand:i.sampleRand},e&&r&&n&&{sampled:n.spanContext.traceFlags===1})),r&&n)return j&&h.log(`[MiniAppTracing] Link mode: new traceId=${i.traceId}, linked from ${n.spanContext.traceId}`),[{context:{traceId:n.spanContext.traceId,spanId:n.spanContext.spanId,traceFlags:(s=n.spanContext.traceFlags)!=null?s:0},attributes:{"sentry.link.type":"previous_trace"}}]}}function zd(){const t=v();return t?Ar(t):void 0}exports.Integrations=gd;exports.MiniappClient=Ji;exports.SDK_NAME=qi;exports.SDK_VERSION=Un;exports.Transports=ld;exports.addBreadcrumb=Ni;exports.addEventProcessor=le;exports.captureConsoleIntegration=hu;exports.captureEvent=nc;exports.captureException=x;exports.captureMessage=wn;exports.close=bd;exports.consoleLoggingIntegration=Sl;exports.createConsolaReporter=Nl;exports.defaultIntegrations=Vi;exports.extraErrorDataIntegration=bu;exports.featureFlagsIntegration=ol;exports.flush=Ed;exports.getActiveMiniAppRootSpan=vd;exports.getActiveMiniAppSpan=zd;exports.getActiveSpan=At;exports.getCurrentScope=O;exports.getRootSpan=q;exports.getSpanDescendants=Xt;exports.getSpanStatusFromHttpCode=zs;exports.init=hd;exports.instrumentAnthropicAiClient=wf;exports.instrumentGoogleGenAIClient=zf;exports.instrumentMiniAppRouter=Zi;exports.instrumentOpenAiClient=mf;exports.instrumentSupabaseClient=wi;exports.lastEventId=Sd;exports.logger=pl;exports.makeMultiplexedTransport=Jc;exports.metrics=Il;exports.miniappTracingIntegration=Gd;exports.moduleMetadataIntegration=pu;exports.registerSpanErrorInstrumentation=sa;exports.rewriteFramesIntegration=vu;exports.setContext=rc;exports.setExtra=Pn;exports.setExtras=sc;exports.setHttpStatus=Rn;exports.setMeasurement=oi;exports.setTag=xn;exports.setTags=ic;exports.setUser=oc;exports.showReportDialog=yd;exports.startInactiveSpan=tr;exports.startMiniAppTracingNavigationSpan=to;exports.startNewTrace=va;exports.startSpan=Gt;exports.startSpanManual=ie;exports.supabaseIntegration=Gu;exports.thirdPartyErrorFilterIntegration=Zu;exports.withActiveSpan=ue;exports.withScope=rt;exports.wrap=Td;exports.zodErrorsIntegration=Xu;
//# sourceMappingURL=index.cjs.map
